this.mfModules=this.mfModules||{},this.mfModules["tests.mobilefrontend"]=(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"./node_modules/hogan.js/lib/compiler.js":function(e,t,n){!function(e){var t=/\S/,n=/\"/g,i=/\n/g,s=/\r/g,a=/\\/g,o={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};function r(e){"}"===e.n.substr(e.n.length-1)&&(e.n=e.n.substring(0,e.n.length-1))}function l(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function c(e,t,n){if(t.charAt(n)!=e.charAt(0))return!1;for(var i=1,s=e.length;i<s;i++)if(t.charAt(n+i)!=e.charAt(i))return!1;return!0}function u(e,t){for(var n=0,i=t.length;n<i;n++)if(t[n].o==e.n)return e.tag="#",!0}function d(e,t,n){for(var i=0,s=n.length;i<s;i++)if(n[i].c==e&&n[i].o==t)return!0}function h(e){return e.replace(a,"\\\\").replace(n,'\\"').replace(i,"\\n").replace(s,"\\r")}function p(e){return~e.indexOf(".")?"d":"f"}function g(e){for(var t="",n=0,i=e.length;n<i;n++){var s=e[n].tag;"#"==s?t+=m(e[n].nodes,e[n].n,p(e[n].n),e[n].i,e[n].end,e[n].otag+" "+e[n].ctag):"^"==s?t+=f(e[n].nodes,e[n].n,p(e[n].n)):"<"==s||">"==s?t+=w(e[n]):"{"==s||"&"==s?t+=b(e[n].n,p(e[n].n)):"\n"==s?t+=y('"\\n"'+(e.length-1==n?"":" + i")):"_v"==s?t+=v(e[n].n,p(e[n].n)):void 0===s&&(t+=y('"'+h(e[n])+'"'))}return t}function m(e,t,n,i,s,a){return"if(_.s(_."+n+'("'+h(t)+'",c,p,1),c,p,0,'+i+","+s+',"'+a+'")){_.rs(c,p,function(c,p,_){'+g(e)+"});c.pop();}"}function f(e,t,n){return"if(!_.s(_."+n+'("'+h(t)+'",c,p,1),c,p,1,0,0,"")){'+g(e)+"};"}function w(e){return'_.b(_.rp("'+h(e.n)+'",c,p,"'+(e.indent||"")+'"));'}function b(e,t){return"_.b(_.t(_."+t+'("'+h(e)+'",c,p,0)));'}function v(e,t){return"_.b(_.v(_."+t+'("'+h(e)+'",c,p,0)));'}function y(e){return"_.b("+e+");"}e.scan=function(e,n){var i=e.length,s=0,a=null,u=null,d="",h=[],p=!1,g=0,m=0,f="{{",w="}}";function b(){d.length>0&&(h.push(new String(d)),d="")}function v(e,n){if(b(),e&&function(){for(var e=!0,n=m;n<h.length;n++)if(!(e=h[n].tag&&o[h[n].tag]<o._v||!h[n].tag&&null===h[n].match(t)))return!1;return e}())for(var i,s=m;s<h.length;s++)h[s].tag||((i=h[s+1])&&">"==i.tag&&(i.indent=h[s].toString()),h.splice(s,1));else n||h.push({tag:"\n"});p=!1,m=h.length}function y(e,t){var n="="+w,i=e.indexOf(n,t),s=l(e.substring(e.indexOf("=",t)+1,i)).split(" ");return f=s[0],w=s[1],i+n.length-1}for(n&&(n=n.split(" "),f=n[0],w=n[1]),g=0;g<i;g++)0==s?c(f,e,g)?(--g,b(),s=1):"\n"==e.charAt(g)?v(p):d+=e.charAt(g):1==s?(g+=f.length-1,"="==(a=(u=o[e.charAt(g+1)])?e.charAt(g+1):"_v")?(g=y(e,g),s=0):(u&&g++,s=2),p=g):c(w,e,g)?(h.push({tag:a,n:l(d),otag:f,ctag:w,i:"/"==a?p-w.length:g+f.length}),d="",g+=w.length-1,s=0,"{"==a&&("}}"==w?g++:r(h[h.length-1]))):d+=e.charAt(g);return v(p,!0),h},e.generate=function(t,n,i){var s='var _=this;_.b(i=i||"");'+g(t)+"return _.fl();";return i.asString?"function(c,p,i){"+s+";}":new e.Template(new Function("c","p","i",s),n,e,i)},e.parse=function(e,t,n){return function e(t,n,i,s){for(var a=[],o=null,r=null;t.length>0;)if("#"==(r=t.shift()).tag||"^"==r.tag||u(r,s))i.push(r),r.nodes=e(t,r.tag,i,s),a.push(r);else{if("/"==r.tag){if(0===i.length)throw new Error("Closing tag without opener: /"+r.n);if(o=i.pop(),r.n!=o.n&&!d(r.n,o.n,s))throw new Error("Nesting error: "+o.n+" vs. "+r.n);return o.end=r.i,a}a.push(r)}if(i.length>0)throw new Error("missing closing tag: "+i.pop().n);return a}(e,0,[],(n=n||{}).sectionTags||[])},e.cache={},e.compile=function(e,t){var n=e+"||"+!!(t=t||{}).asString,i=this.cache[n];return i||(i=this.generate(this.parse(this.scan(e,t.delimiters),e,t),e,t),this.cache[n]=i)}}(t)},"./node_modules/hogan.js/lib/hogan.js":function(e,t,n){var i=n("./node_modules/hogan.js/lib/compiler.js");i.Template=n("./node_modules/hogan.js/lib/template.js").Template,e.exports=i},"./node_modules/hogan.js/lib/template.js":function(e,t,n){!function(e,t){e.Template=function(e,t,n,i){this.r=e||this.r,this.c=n,this.options=i,this.text=t||"",this.buf=""},e.Template.prototype={r:function(e,t,n){return""},v:function(e){return e=l(e),r.test(e)?e.replace(n,"&amp;").replace(i,"&lt;").replace(s,"&gt;").replace(a,"&#39;").replace(o,"&quot;"):e},t:l,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n){return this.r(e,t,n)},rp:function(e,t,n,i){var s=n[e];return s?(this.c&&"string"==typeof s&&(s=this.c.compile(s,this.options)),s.ri(t,n,i)):""},rs:function(e,t,n){var i=e[e.length-1];if(c(i))for(var s=0;s<i.length;s++)e.push(i[s]),n(e,t,this),e.pop();else n(e,t,this)},s:function(e,t,n,i,s,a,o){var r;return(!c(e)||0!==e.length)&&("function"==typeof e&&(e=this.ls(e,t,n,i,s,a,o)),r=""===e||!!e,!i&&r&&t&&t.push("object"==typeof e?e:t[t.length-1]),r)},d:function(e,t,n,i){var s=e.split("."),a=this.f(s[0],t,n,i),o=null;if("."===e&&c(t[t.length-2]))return t[t.length-1];for(var r=1;r<s.length;r++)a&&"object"==typeof a&&s[r]in a?(o=a,a=a[s[r]]):a="";return!(i&&!a)&&(i||"function"!=typeof a||(t.push(o),a=this.lv(a,t,n),t.pop()),a)},f:function(e,t,n,i){for(var s=!1,a=null,o=!1,r=t.length-1;r>=0;r--)if((a=t[r])&&"object"==typeof a&&e in a){s=a[e],o=!0;break}return o?(i||"function"!=typeof s||(s=this.lv(s,t,n)),s):!i&&""},ho:function(e,t,n,i,s){var a=this.c,o=this.options;return o.delimiters=s,i=null==(i=e.call(t,i))?String(i):i.toString(),this.b(a.compile(i,o).render(t,n)),!1},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ls:function(e,t,n,i,s,a,o){var r,l=t[t.length-1];if(!i&&this.c&&e.length>0)return this.ho(e,l,n,this.text.substring(s,a),o);if("function"==typeof(r=e.call(l))){if(i)return!0;if(this.c)return this.ho(r,l,n,this.text.substring(s,a),o)}return r},lv:function(e,t,n){var i=t[t.length-1],s=e.call(i);return"function"==typeof s&&(s=l(s.call(i)),this.c&&~s.indexOf("{{"))?this.c.compile(s,this.options).render(i,n):l(s)}};var n=/&/g,i=/</g,s=/>/g,a=/\'/g,o=/\"/g,r=/[&<>\"\']/;function l(e){return String(null===e||void 0===e?"":e)}var c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}(t)},"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./src/mobile.categories.overlays/CategoryGateway.js":function(e,t,n){var i,s=n("./src/mobile.startup/actionParams.js"),a=n("./src/mobile.startup/util.js"),o=n("./src/mobile.startup/search/SearchGateway.js");function r(){r.parent.apply(this,arguments)}i={continueParams:{},canContinue:!0,searchNamespace:14,save:function(e,t){return this.api.postWithToken("csrf",{action:"edit",title:e,appendtext:t,summary:mw.msg("mobile-frontend-categories-summary")})},getCategories:function(e){var t,n=this;return!1!==this.canContinue&&(t=a.extend({},{prop:"categories",titles:e,clprop:"hidden",cllimit:50},this.continueParams),this.api.get(s(t)).then(function(e){return void 0!==e.continue?n.continueParams=e.continue:n.canContinue=!1,e}))}},OO.inheritClass(r,o),a.extend(r.prototype,i),e.exports=r},"./src/mobile.editor.overlay/AbuseFilterOverlay.js":function(e,t,n){var i=n("./src/mobile.startup/Button.js"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.startup/mfExtend.js"),o=n("./src/mobile.startup/Overlay.js");function r(e){o.call(this,s.extend({className:"overlay abusefilter-overlay"},e))}a(r,o,{defaults:s.extend({},o.prototype.defaults,{confirmButton:new i({additionalClassNames:"cancel",progressive:!0}).options}),templatePartials:s.extend({},o.prototype.templatePartials,{button:i.prototype.template,content:mw.template.get("mobile.editor.overlay","AbuseFilterOverlay.hogan")}),postRender:function(){o.prototype.postRender.apply(this),this.$el.find("a").attr("target","_blank")}}),e.exports=r},"./src/mobile.editor.overlay/AbuseFilterPanel.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s=n("./src/mobile.startup/View.js"),a=n("./src/mobile.startup/mfExtend.js"),o=n("./src/mobile.editor.overlay/AbuseFilterOverlay.js");function r(e){this.isDisallowed=!1,this.overlayManager=e.overlayManager,s.call(this,i.extend({className:"panel hidden"},e))}a(r,s,{defaults:{readMoreMsg:mw.msg("mobile-frontend-editor-abusefilter-read-more")},template:mw.template.get("mobile.editor.overlay","AbuseFilterPanel.hogan"),show:function(e,t){var n;this.overlayManager.add(/^\/abusefilter$/,function(){return new o({message:t})}),"warning"===e?n=mw.msg("mobile-frontend-editor-abusefilter-warning"):"disallow"===e&&(n=mw.msg("mobile-frontend-editor-abusefilter-disallow"),this.isDisallowed=!0),this.$el.find(".message p").text(n),this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden")}}),e.exports=r},"./src/mobile.editor.overlay/BlockMessage.js":function(e,t,n){"use strict";var i=n("./src/mobile.startup/Drawer.js"),s=n("./src/mobile.startup/Button.js"),a=n("./src/mobile.startup/mfExtend.js"),o=n("./src/mobile.startup/Icon.js"),r=n("./src/mobile.startup/util.js");function l(){i.apply(this,arguments)}a(l,i,{defaults:r.extend({},i.prototype.defaults,{stopHandIcon:new o({name:"stop-hand"}).options,userIcon:new o({tagName:"span",name:"profile"}).options,okButton:new s({label:mw.msg("ok"),tagName:"button",progressive:!0,additionalClassNames:"cancel"}).options,createDetailsAnchorHref:function(){return mw.util.getUrl("Special:BlockList",{wpTarget:"#"+this.blockId})},createDetailsAnchorLabel:function(){return mw.msg("mobile-frontend-editor-blocked-drawer-help")},createTitle:function(){return this.partial?mw.msg("mobile-frontend-editor-blocked-drawer-title-partial"):mw.msg("mobile-frontend-editor-blocked-drawer-title")},reasonHeader:mw.msg("mobile-frontend-editor-blocked-drawer-reason-header"),creatorHeader:function(){return mw.msg("mobile-frontend-editor-blocked-drawer-creator-header",this.user.options.gender||"unknown")},expiryHeader:mw.msg("mobile-frontend-editor-blocked-drawer-expiry-header")}),templatePartials:r.extend({},i.prototype.templatePartials,{button:s.prototype.template,icon:o.prototype.template}),onShowDrawer:function(){var e=mw.config.get("wgDBname");i.prototype.onShowDrawer.apply(this),mw.config.get("wgEnableBlockNoticeStats")&&mw.track("counter.MediaWiki.BlockNotices."+e+".MobileFrontend.shown",1)},template:mw.template.get("mobile.editor.overlay","BlockMessage.hogan")}),e.exports=l},"./src/mobile.editor.overlay/EditorGateway.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s=n("./src/mobile.editor.overlay/parseSaveError.js"),a=n("./src/mobile.startup/actionParams.js");function o(e){this.api=e.api,this.title=e.title,this.sectionId=e.sectionId,this.oldId=e.oldId,this.content=e.isNewPage?"":void 0,this.hasChanged=!1}o.prototype={getBlockInfo:function(e){var t;return e.actions&&e.actions.edit&&Array.isArray(e.actions.edit)&&(e.actions.edit.some(function(e){return-1!==["blocked","autoblocked"].indexOf(e.code)&&(t=e,!0)}),t&&t.data&&t.data.blockinfo)?(mw.loader.load("moment"),t.data.blockinfo):null},getContent:function(){var e,t=this;function n(){return i.Deferred().resolve({text:t.content||"",blockinfo:t.blockinfo,userinfo:t.userinfo})}return void 0!==this.content?n():(e=a({prop:["revisions","info"],meta:"userinfo",rvprop:["content","timestamp"],titles:t.title,intestactions:"edit",intestactionsdetail:"full",uiprop:"options"}),this.oldId&&(e.rvstartid=this.oldId),i.isNumeric(this.sectionId)&&(e.rvsection=this.sectionId),this.api.get(e).then(function(e){var s,a;return e.error?i.Deferred().reject(e.error.code):(void 0!==(a=e.query.pages[0]).missing?t.content="":(s=a.revisions[0],t.content=s.content,t.timestamp=s.timestamp),t.userinfo=e.query.userinfo,t.originalContent=t.content,t.blockinfo=t.getBlockInfo(a),n())}))},setContent:function(e){this.originalContent!==e?this.hasChanged=!0:this.hasChanged=!1,this.content=e},setPrependText:function(e){this.prependtext=e,this.hasChanged=!0},save:function(e){var t=this,n=i.Deferred();return e=e||{},function(){var a={action:"edit",title:t.title,summary:e.summary,captchaid:e.captchaId,captchaword:e.captchaWord,basetimestamp:t.timestamp,starttimestamp:t.timestamp};return void 0!==t.content?a.text=t.content:t.prependtext&&(a.prependtext=t.prependtext),i.isNumeric(t.sectionId)&&(a.section=t.sectionId),t.api.postWithToken("csrf",a).then(function(e){e&&e.edit&&"Success"===e.edit.result?(t.hasChanged=!1,n.resolve()):n.reject(s(e))},function(e,t){n.reject(s(t,e||"unknown"))}),n}()},abortPreview:function(){this._pending&&this._pending.abort()},getPreview:function(e){var t,n=i.Deferred(),s="",a=this;return i.extend(e,{action:"parse",sectionpreview:!0,pst:!0,mobileformat:!0,title:this.title,prop:["text","sections"]}),this.abortPreview(),t=this.api.post(e),this._pending=t.then(function(e){e&&e.parse&&e.parse.text?(0!==a.sectionId&&void 0!==e.parse.sections&&void 0!==e.parse.sections[0]&&void 0!==e.parse.sections[0].line&&(s=e.parse.sections[0].line),n.resolve({text:e.parse.text["*"],line:s})):n.reject()},function(){n.reject()}).promise({abort:function(){t.abort()}}),n}},e.exports=o},"./src/mobile.editor.overlay/EditorOverlay.js":function(e,t,n){var i=n("./src/mobile.editor.overlay/EditorOverlayBase.js"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.startup/Section.js"),o=n("./src/mobile.editor.overlay/saveFailureMessage.js"),r=n("./src/mobile.editor.overlay/EditorGateway.js"),l=n("./src/mobile.editor.overlay/AbuseFilterPanel.js"),c=n("./src/mobile.startup/Button.js"),u=n("./src/mobile.startup/mfExtend.js"),d=n("./src/mobile.editor.overlay/BlockMessage.js"),h=n("./src/mobile.editor.overlay/VisualEditorOverlay.js"),p=n("./src/mobile.startup/MessageBox.js");function g(e){this.isFirefox=/firefox/i.test(window.navigator.userAgent),this.gateway=new r({api:e.api,title:e.title,sectionId:e.sectionId,oldId:e.oldId,isNewPage:e.isNewPage}),this.readOnly=!!e.oldId,this.isVisualEditorEnabled()&&(e.editSwitcher=!0),this.readOnly?(e.readOnly=!0,e.editingMsg=mw.msg("mobile-frontend-editor-viewing-source-page",e.title)):e.editingMsg=mw.msg("mobile-frontend-editor-editing-page",e.title),e.isAnon&&(e=this._prepareAnonWarning(e)),e.isVisualEditor=!1,e.previewingMsg=mw.msg("mobile-frontend-editor-previewing-page",e.title),i.call(this,s.extend({events:{"input .wikitext-editor":"onInputWikitextEditor"}},e))}u(g,i,{templatePartials:s.extend({},i.prototype.templatePartials,{content:mw.template.get("mobile.editor.overlay","content.hogan"),messageBox:p.prototype.template,anonWarning:mw.template.get("mobile.editor.overlay","EditorOverlayAnonWarning.hogan")}),defaults:s.extend({},i.prototype.defaults,{loginButton:new c({block:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-login")}).options,signupButton:new c({block:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-signup")}).options,anonButton:new c({label:mw.msg("mobile-frontend-editor-anon"),block:!0,additionalClassNames:"continue anonymous",progressive:!0}).options,warningOptions:{className:"warningbox anon-msg",msg:mw.msg("mobile-frontend-editor-anonwarning")}}),editor:"wikitext",sectionLine:"",isVisualEditorEnabled:function(){var e=mw.config.get("wgVisualEditorConfig")&&mw.config.get("wgVisualEditorConfig").namespaces;return e&&e.indexOf(mw.config.get("wgNamespaceNumber"))>-1&&"translation"!==mw.config.get("wgTranslatePageTranslation")&&"wikitext"===mw.config.get("wgPageContentModel")},onInputWikitextEditor:function(){this.gateway.setContent(this.$el.find(".wikitext-editor").val()),this.$el.find(".continue, .submit").prop("disabled",!1)},onClickContinue:function(e){if(this.options.isAnon&&this.$el.find(e.target).hasClass("anonymous"))return this._showEditorAfterWarning(),!1;i.prototype.onClickContinue.apply(this,arguments)},onClickBack:function(){i.prototype.onClickBack.apply(this,arguments),this._hidePreview()},postRender:function(){var e=this;this.isVisualEditorEnabled()&&mw.loader.using("ext.visualEditor.switching").then(function(){var t,n=new OO.ui.ToolFactory,i=new OO.ui.ToolGroupFactory;n.register(mw.libs.ve.MWEditModeVisualTool),n.register(mw.libs.ve.MWEditModeSourceTool),(t=new OO.ui.Toolbar(n,i,{classes:["editor-switcher"]})).on("switchEditor",function(t){"visual"===t&&(e.gateway.hasChanged?window.confirm(mw.msg("mobile-frontend-editor-switch-confirm"))&&e.onStageChanges():e._switchToVisualEditor(e.options))}),t.setup([{name:"editMode",type:"list",icon:"edit",title:mw.msg("visualeditor-mweditmode-tooltip"),include:["editModeVisual","editModeSource"]}]),e.$el.find(".switcher-container").html(t.$element),t.emit("updateState")}),i.prototype.postRender.apply(this),this.$preview=this.$el.find(".preview"),this.$content=this.$el.find(".wikitext-editor"),this.$content.addClass("mw-editfont-"+mw.user.options.get("editfont")),e.options.isAnon&&(this.$anonWarning=this.$el.find(".anonwarning"),this.$content.hide(),this.$anonHiddenButtons=this.$el.find(".overlay-header .continue, .editor-switcher").hide(),this.hideSpinner()),this.$el.find(".license a").attr("target","_blank"),this.abuseFilterPanel=new l({overlayManager:this.overlayManager}).appendTo(this.$el.find(".panels")),this.readOnly&&this.$content.prop("readonly",!0),this.$content.on("input",this._resizeEditor.bind(this)),e.options.isAnon||this._loadContent()},_prepareAnonWarning:function(e){var t=s.extend({returnto:e.returnTo||mw.config.get("wgPageName"),returntoquery:"action=edit&section="+e.sectionId,warning:"mobile-frontend-edit-login-action"},e.queryParams),n=s.extend({type:"signup",warning:"mobile-frontend-edit-signup-action"},e.signupQueryParams);return e.loginButton=s.extend({href:mw.util.getUrl("Special:UserLogin",t)},this.defaults.loginButton),e.signupButton=s.extend({href:mw.util.getUrl("Special:UserLogin",s.extend(t,n))},this.defaults.signupButton),e},_showEditorAfterWarning:function(){this.showSpinner(),this.$anonWarning.hide(),this.$anonHiddenButtons.show(),this._loadContent()},onStageChanges:function(){var e=this,t={text:this.getContent()};function n(){e.hideSpinner(),e.$preview.show()}this.scrollTop=s.getDocument().find("body").scrollTop(),this.$content.hide(),this.showSpinner(),mw.config.get("wgIsMainPage")&&(t.mainpage=1),this.gateway.getPreview(t).then(function(t){var i=t.text,s=t.line;e.sectionLine=e.parseHTML("<div>").html(s).text(),new a({el:e.$preview,text:i}).$el.find("a").on("click",!1),n()},function(){e.$preview.addClass("error").text(mw.msg("mobile-frontend-editor-error-preview")),n()}),i.prototype.onStageChanges.apply(this,arguments)},_hidePreview:function(){this.gateway.abortPreview(),this.hideSpinner(),this.$preview.removeClass("error").hide(),this.$content.show(),window.scrollTo(0,this.scrollTop),this.showHidden(".initial-header"),this.abuseFilterPanel.hide()},_resizeEditor:function(){var e,t,n;this.isFirefox||(this.$scrollContainer?n=this.$scrollContainer:(t=OO.ui.Element.static.getClosestScrollableContainer(this.$content[0]),n=this.$el.find(t).length?this.$el.find(t):s.getDocument(),this.$scrollContainer=n,this.$content.css("padding-bottom",.6*this.$scrollContainer.height())),this.$content.prop("scrollHeight")&&n.length&&(e=n.scrollTop(),this.$content.css("height","auto").css("height",this.$content.prop("scrollHeight")+2+"px"),n.scrollTop(e)))},setContent:function(e){this.$content.show().val(e),this._resizeEditor()},getContent:function(){return this.$content.val()},_parseBlockInfo:function(e){var t,n,i,s=window.moment;return t={partial:e.blockinfo.blockpartial||!1,user:e.userinfo,creator:{name:e.blockinfo.blockedby,url:mw.util.getUrl(mw.config.get("wgFormattedNamespaces")[2]+":"+e.blockinfo.blockedby)},expiry:null,duration:null,reason:"",blockId:e.blockinfo.blockid},n=e.blockinfo.blockexpiry,-1===["infinite","indefinite","infinity","never"].indexOf(n)&&(t.expiry=s(n).format("LLL"),t.duration=s().to(n,!0)),i=e.blockinfo.blockreason,t.reason=i?function(e){var t,n;t=new mw.jqueryMsg.parser;try{return n=t.wikiTextToAst(e),t.emitter.emit(n).html()}catch(e){return!1}}(i)||mw.html.escape(i):mw.message("mobile-frontend-editor-generic-block-reason").escaped(),t},_loadContent:function(){var e=this,t=this.$el;this.$content.hide(),this.showSpinner(),t.addClass("overlay-loading"),this.gateway.getContent().then(function(n){var i,s=n.text;e.setContent(s),n.blockinfo?mw.loader.using("moment").then(function(){i=e._parseBlockInfo(n),new d(i).toggle(),e.hide(),e.hideSpinner(),t.removeClass("overlay-loading")}):(e.hideSpinner(),t.removeClass("overlay-loading"))},function(){e.reportError(mw.msg("mobile-frontend-editor-error-loading")),t.removeClass("overlay-loading")})},_switchToVisualEditor:function(e){var t=this;this.log({action:"abort",type:"switchnochange",mechanism:"navigate"}),mw.storage.set("preferredEditor","VisualEditor"),this.showSpinner(),this.$content.hide(),mw.loader.using("ext.visualEditor.targetLoader").then(function(){return mw.libs.ve.targetLoader.addPlugin("mobile.editor.ve"),mw.libs.ve.targetLoader.loadModules("visual")}).then(function(){e.EditorOverlay=g,t.hideSpinner(),delete e.className,t.switching=!0,t.overlayManager.replaceCurrent(new h(e)),t.switching=!1},function(){t.hideSpinner(),t.$content.show()})},_showAbuseFilter:function(e,t){this.abuseFilterPanel.show(e,t),this.showHidden(".save-header"),this.$el.find(".continue, .submit").prop("disabled",this.abuseFilterPanel.isDisallowed)},onSaveBegin:function(){var e=this,t={summary:this.$el.find(".summary").val()};""!==e.sectionLine&&(t.summary="/* "+e.sectionLine+" */"+t.summary),i.prototype.onSaveBegin.apply(this,arguments),this.confirmAborted||(this.captchaId&&(t.captchaId=this.captchaId,t.captchaWord=this.$el.find(".captcha-word").val()),this.showHidden(".saving-header"),this.gateway.save(t).then(function(){var t=e.options.title;mw.config.get("wgIsMainPage")?window.location=mw.util.getUrl(t):e.onSaveComplete()},function(t){e.onSaveFailure(t)}))},onSaveFailure:function(e){var t,n;"captcha"===e.type?(this.captchaId=e.details.id,this.handleCaptcha(e.details)):"abusefilter"===e.type?this._showAbuseFilter(e.details.type,e.details.message):(n=o(e),"readonly"===e.type&&(t=mw.msg("apierror-readonly")),(n||t)&&(this.reportError(n,t),this.showHidden(".save-header, .save-panel"))),i.prototype.onSaveFailure.apply(this,arguments)},hasChanged:function(){return this.gateway.hasChanged}}),e.exports=g},"./src/mobile.editor.overlay/EditorOverlayBase.js":function(e,t,n){var i=n("./src/mobile.startup/Overlay.js"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.startup/PageGateway.js"),o=n("./src/mobile.startup/Icon.js"),r=n("./src/mobile.startup/toast.js"),l=n("./src/mobile.editor.overlay/saveFailureMessage.js"),c=n("./src/mobile.startup/mfExtend.js"),u=n("./src/mobile.startup/MessageBox.js"),d=mw.user;function h(e,t){(t=t||{}).classes=["visual-editor"],h.super.call(this,e,t)}function p(e){var t=this,n=s.extend({className:"overlay editor-overlay",isBorderBox:!1},e,{events:s.extend({"click .back":"onClickBack","click .continue":"onClickContinue","click .submit":"onClickSubmit"},e.events)});n.isNewPage&&(n.placeholder=mw.msg("mobile-frontend-editor-placeholder-new-page",d)),0!==mw.config.get("wgNamespaceNumber")&&(n.summaryRequestMsg=mw.msg("mobile-frontend-editor-summary")),this.pageGateway=new a(n.api),this.editCount=n.editCount,this.isNewPage=n.isNewPage,this.isNewEditor=0===n.editCount,this.sectionId=n.sectionId,this.config=mw.config.get("wgMFEditorOptions"),this.sessionId=n.sessionId,this.overlayManager=n.overlayManager,this.allowCloseWindow=mw.confirmCloseWindow({test:function(){return t.hasChanged()},message:mw.msg("mobile-frontend-editor-cancel-confirm"),namespace:"editwarning"}),i.call(this,n)}OO.inheritClass(h,OO.ui.Tool),h.static.name="editVe",h.static.icon="edit",h.static.group="editorSwitcher",h.static.title=mw.msg("mobile-frontend-editor-switch-visual-editor"),h.prototype.onSelect=function(){},h.prototype.onUpdateState=function(){},c(p,i,{defaults:s.extend({},i.prototype.defaults,{hasToolbar:!1,continueMsg:mw.msg("mobile-frontend-editor-continue"),cancelMsg:mw.msg("mobile-frontend-editor-cancel"),closeMsg:mw.msg("mobile-frontend-editor-keep-editing"),summaryRequestMsg:mw.msg("mobile-frontend-editor-summary-request"),summaryMsg:mw.msg("mobile-frontend-editor-summary-placeholder"),placeholder:mw.msg("mobile-frontend-editor-placeholder"),waitMsg:mw.msg("mobile-frontend-editor-wait"),waitIcon:new o({name:"spinner",additionalClassNames:"savespinner loading"}).toHtmlString(),captchaMsg:mw.msg("mobile-frontend-account-create-captcha-placeholder"),captchaTryAgainMsg:mw.msg("mobile-frontend-editor-captcha-try-again"),switchMsg:mw.msg("mobile-frontend-editor-switch-editor"),confirmMsg:mw.msg("mobile-frontend-editor-cancel-confirm"),licenseMsg:void 0}),templatePartials:s.extend({},i.prototype.templatePartials,{editHeader:mw.template.get("mobile.editor.overlay","editHeader.hogan"),previewHeader:mw.template.get("mobile.editor.overlay","previewHeader.hogan"),saveHeader:mw.template.get("mobile.editor.overlay","saveHeader.hogan")}),template:mw.template.get("mobile.editor.overlay","EditorOverlayBase.hogan"),log:function(e){mw.track("mf.schemaEditAttemptStep",s.extend(e,{editor_interface:this.editor,editing_session_id:this.sessionId}))},confirmSave:function(){return!(this.isNewPage&&!window.confirm(mw.msg("mobile-frontend-editor-new-page-confirm",d)))},onSaveComplete:function(){var e,t=s.getWindow(),n=this.options.title;this.saved=!0,this.pageGateway.invalidatePage(n),e=this.isNewPage?mw.msg("mobile-frontend-editor-success-new-page"):this.isNewEditor?mw.msg("mobile-frontend-editor-success-landmark-1"):mw.msg("mobile-frontend-editor-success"),r.showOnPageReload(e,{type:"success"}),this.log({action:"saveSuccess"}),this.sectionLine?window.location.hash=this.sectionLine:window.location.hash="#",t.off("beforeunload.mfeditorwarning"),window.location.reload()},onSaveFailure:function(e){var t=e&&e.details&&e.details.code;"captcha"===e.type&&(t="captcha"),this.log({action:"saveFailure",message:l(e),type:{editconflict:"editConflict",wasdeleted:"editPageDeleted","abusefilter-disallowed":"extensionAbuseFilter",captcha:"extensionCaptcha",spamprotectiontext:"extensionSpamBlacklist","titleblacklist-forbidden-edit":"extensionTitleBlacklist"}[t]||"responseUnknown"})},reportError:function(e,t){var n=new u({className:"errorbox",msg:e,heading:t});this.$errorNoticeContainer.html(n.$el)},hideErrorNotice:function(){this.$errorNoticeContainer.empty()},onStageChanges:function(){this.showHidden(".save-header, .save-panel"),this.log({action:"saveIntent"}),window.scrollTo(0,1)},onSaveBegin:function(){this.confirmAborted=!1,this.hideErrorNotice(),this.confirmSave()?this.log({action:"saveAttempt"}):this.confirmAborted=!0},postRender:function(){this.log({action:"ready"}),this.log({action:"loaded"}),this.config.skipPreview?(this.nextStep="onSaveBegin",this.$el.find(".continue").text(this.defaults.saveMsg)):this.nextStep="onStageChanges",this.$errorNoticeContainer=this.$el.find("#error-notice-container"),i.prototype.postRender.apply(this),this.showHidden(".initial-header")},show:function(){this.saved=!1,i.prototype.show.call(this),mw.hook("mobileFrontend.editorOpened").fire(this.editor)},onClickBack:function(){},onClickSubmit:function(){this.onSaveBegin()},onClickContinue:function(){this[this.nextStep]()},hide:function(){var e,t=this;return this.hasChanged()?((e=OO.ui.getWindowManager()).addWindows([new mw.widgets.AbandonEditDialog]),e.openWindow("abandonedit").closed.then(function(e){e&&"discard"===e.action&&(t.log({action:"abort",mechanism:"cancel",type:"abandon"}),t.allowCloseWindow.release(),mw.hook("mobileFrontend.editorClosed").fire(),i.prototype.hide.call(t))})):(this.switching||this.saved||this.log({action:"abort",mechanism:"cancel",type:this.target&&this.target.edited?"abandon":"nochange"}),this.allowCloseWindow.release(),mw.hook("mobileFrontend.editorClosed").fire(),i.prototype.hide.call(t))},shouldConfirmLeave:function(e){return!(e||!this.hasChanged())},hasChanged:function(){},handleCaptcha:function(e){var t=this,n=this.$el.find(".captcha-word");this.captchaShown&&(n.val(""),n.attr("placeholder",this.options.captchaTryAgainMsg),setTimeout(function(){n.attr("placeholder",t.options.captchaMsg)},2e3)),0===e.mime.indexOf("image/")?(this.$el.find(".captcha-panel#question").detach(),this.$el.find(".captcha-panel img").attr("src",e.url)):(this.$el.find(".captcha-panel #image").detach(),0===e.mime.indexOf("text/html")?this.$el.find(".captcha-panel #question").html(e.question):this.$el.find(".captcha-panel #question").text(e.question)),this.showHidden(".save-header, .captcha-panel"),this.captchaShown=!0}}),e.exports=p},"./src/mobile.editor.overlay/VisualEditorOverlay.js":function(e,t,n){var i=n("./src/mobile.editor.overlay/EditorOverlayBase.js"),s=n("./src/mobile.editor.overlay/EditorGateway.js"),a=n("./src/mobile.startup/mfExtend.js"),o=n("./src/mobile.startup/util.js");function r(e){this.applyHeaderOptions(e,!0),i.call(this,o.extend({isBorderBox:!1,className:"overlay editor-overlay editor-overlay-ve"},e)),this.EditorOverlay=e.EditorOverlay,this.isNewPage=e.isNewPage,this.gateway=new s({api:e.api,title:e.title,sectionId:e.sectionId,oldId:e.oldId,isNewPage:e.isNewPage})}a(r,i,{templatePartials:o.extend({},i.prototype.templatePartials,{editHeader:mw.template.get("mobile.editor.overlay","toolbarVE.hogan"),content:mw.template.get("mobile.editor.overlay","contentVE.hogan")}),editor:"visualeditor",applyHeaderOptions:function(e,t){e.hasToolbar=t,e.isVisualEditor=t},destroyTarget:function(){this.target&&(this.target.destroy(),this.target=null)},show:function(){i.prototype.show.apply(this,arguments),this.target=ve.init.mw.targetFactory.create("article",this,{$element:this.$el,section:this.options.sectionId||null}),this.target.load(this.options.dataPromise)},hide:function(){var e=this,t=i.prototype.hide.apply(this,arguments);return!0===t?this.destroyTarget():t&&t.then&&t.then(function(t){t&&e.destroyTarget()}),t},onClickBack:function(){i.prototype.onClickBack.apply(this,arguments),this.switchToEditor()},switchToEditor:function(){this.showHidden(".initial-header")},switchToSourceEditor:function(){var e=this.EditorOverlay;this.log({action:"abort",type:"switchnochange",mechanism:"navigate"}),mw.storage.set("preferredEditor","SourceEditor"),this.showSpinner(),this.$el.find(".surface").hide(),this.hideSpinner(),this.applyHeaderOptions(this.options,!1),delete this.options.className,this.switching=!0,this.overlayManager.replaceCurrent(new e(this.options)),this.switching=!1},onSaveComplete:function(){i.prototype.onSaveComplete.apply(this,arguments),this.destroyTarget()},hasChanged:function(){return this.target&&this.target.getSurface()&&this.target.getSurface().getModel().hasBeenModified()&&!this.saved}}),e.exports=r},"./src/mobile.editor.overlay/parseSaveError.js":function(e,t){e.exports=function(e,t){var n;if(t)switch(t){case"readonly":return{type:"readonly",details:e.error};case"editconflict":return{type:"editconflict",details:e.error};default:return{type:"error",details:"http"}}if(e){if(e.error)return{type:"error",details:e.error.code};if(e.edit&&e.edit.captcha)return{type:"captcha",details:e.edit.captcha};if(e.edit&&e.edit.code)return t=e.edit.code,n=e.edit.warning,/^abusefilter-warning/.test(t)?{type:"abusefilter",details:{type:"warning",message:n}}:/^abusefilter-disallow/.test(t)?{type:"abusefilter",details:{type:"disallow",message:n}}:/^abusefilter/.test(t)?{type:"abusefilter",details:{type:"other",message:n}}:{type:"error",details:t}}return{type:"error",details:"unknown"}}},"./src/mobile.editor.overlay/saveFailureMessage.js":function(e,t){e.exports=function(e){var t=e&&e.details&&e.details.code;return"readonly"===e.type?e.details.readonlyreason:"editconflict"===t?mw.msg("mobile-frontend-editor-error-conflict"):["blocked","autoblocked"].indexOf(t)>-1?e.error.info:mw.msg("mobile-frontend-editor-error")}},"./src/mobile.languages.structured/LanguageSearcher.js":function(e,t,n){var i=n("./src/mobile.startup/View.js"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.languages.structured/util.js");function o(e){var t=a.getStructuredLanguages(e.languages,e.variants,a.getFrequentlyUsedLanguages(),e.deviceLanguage);i.call(this,s.extend({className:"language-searcher",events:{"click a":"onLinkClick","input .search":"onSearchInput"},inputPlaceholder:mw.msg("mobile-frontend-languages-structured-overlay-search-input-placeholder"),allLanguagesHeader:mw.msg("mobile-frontend-languages-structured-overlay-all-languages-header").toLocaleUpperCase(),suggestedLanguagesHeader:mw.msg("mobile-frontend-languages-structured-overlay-suggested-languages-header").toLocaleUpperCase(),allLanguages:t.all,allLanguagesCount:t.all.length,suggestedLanguages:t.suggested,suggestedLanguagesCount:t.suggested.length},e))}n("./src/mobile.startup/mfExtend.js")(o,i,{template:mw.template.get("mobile.languages.structured","LanguageSearcher.hogan"),postRender:function(){this.$siteLinksList=this.$el.find(".site-link-list"),this.$languageItems=this.$siteLinksList.find("a"),this.$subheaders=this.$el.find("h3")},onLinkClick:function(e){var t=this.$el.find(e.currentTarget).attr("lang");a.saveLanguageUsageCount(t,a.getFrequentlyUsedLanguages())},onSearchInput:function(e){this.filterLanguages(this.$el.find(e.target).val().toLowerCase())},filterLanguages:function(e){var t=[];e?(this.options.languages.forEach(function(n){var i=n.langname;(n.autonym.toLowerCase().indexOf(e)>-1||i&&i.toLowerCase().indexOf(e)>-1||n.lang.toLowerCase().indexOf(e)>-1)&&t.push(n.lang)}),this.options.variants&&this.options.variants.forEach(function(n){(n.autonym.toLowerCase().indexOf(e)>-1||n.lang.toLowerCase().indexOf(e)>-1)&&t.push(n.lang)}),this.$languageItems.addClass("hidden"),t.length&&this.$siteLinksList.find("."+t.join(",.")).removeClass("hidden"),this.$siteLinksList.addClass("filtered"),this.$subheaders.addClass("hidden")):(this.$languageItems.removeClass("hidden"),this.$siteLinksList.removeClass("filtered"),this.$subheaders.removeClass("hidden"))}}),e.exports=o},"./src/mobile.languages.structured/rtlLanguages.js":function(e,t){e.exports=["aeb","aeb-arab","ar","arc","arq","arz","azb","bcc","bgn","bqi","ckb","dv","fa","glk","he","khw","kk-arab","kk-cn","ks","ks-arab","ku-arab","lki","lrc","luz","mzn","pnb","ps","sd","sdh","skr","skr-arab","ug","ug-arab","ur","yi"]},"./src/mobile.languages.structured/util.js":function(e,t,n){var i=mw.log,s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.languages.structured/rtlLanguages.js");e.exports={getDir:function(e){var t=a.indexOf(e.lang)>-1?"rtl":"ltr";return s.extend({},e,{dir:t})},getStructuredLanguages:function(e,t,n,s){var a=Object.prototype.hasOwnProperty,o=0,r=0,l=0,c=[],u=[],d=this;function h(e){return e.dir?e:(l++,d.getDir(e))}return(s=function(e,t){var n,i,s=Object.prototype.hasOwnProperty,a={};if(t)return-1!==(i=t.indexOf("-"))&&(n=t.slice(0,i)),e.forEach(function(e){e.lang!==n&&e.lang!==t||(a[e.lang]=!0)}),s.call(a,t)?t:s.call(a,n)?n:void 0}(e,s))&&(Object.keys(n).forEach(function(e){var t=n[e];o=o<t?t:o,r=r>t?t:r}),n[s]=o+1),e.map(h).forEach(function(e){a.call(n,e.lang)?(e.frequency=n[e.lang],c.push(e)):u.push(e)}),t&&t.map(h).forEach(function(e){a.call(n,e.lang)?e.frequency=n[e.lang]:e.frequency=r-1,c.push(e)}),c=c.sort(function(e,t){return t.frequency-e.frequency}),u=u.sort(function(e,t){return e.autonym.toLocaleLowerCase()<t.autonym.toLocaleLowerCase()?-1:1}),i.warn(0===l?"Direction is provided. Please remove handling in getStructuredLanguages":"`dir` attribute was missing from languages. Is T74153 resolved?"),{suggested:c,all:u}},getFrequentlyUsedLanguages:function(){var e=mw.storage.get("langMap");return e?JSON.parse(e):{}},saveFrequentlyUsedLanguages:function(e){mw.storage.set("langMap",JSON.stringify(e))},saveLanguageUsageCount:function(e,t){var n=t[e]||0;n+=1,t[e]=n>100?100:n,this.saveFrequentlyUsedLanguages(t)}}},"./src/mobile.mediaViewer/ImageGateway.js":function(e,t,n){var i=[320,640,800,1024,1280,1920,2560,2880],s=n("./src/mobile.startup/actionParams.js"),a=n("./src/mobile.startup/util.js");function o(e){for(var t=0;e>i[t]&&t<i.length-1;)++t;return i[t]}function r(e){this._cache={},this.api=e.api}r.prototype.getThumb=function(e){var t=this._cache[e],n=a.getWindow(),i=window.devicePixelRatio&&window.devicePixelRatio>1?window.devicePixelRatio:1;return t||(this._cache[e]=this.api.get(s({prop:"imageinfo",titles:e,iiprop:["url","extmetadata"],iiurlwidth:o(n.width()*i),iiurlheight:o(n.height()*i)})).then(function(e){if(e.query&&e.query.pages&&e.query.pages[0]&&e.query.pages[0].imageinfo)return e.query.pages[0].imageinfo[0];throw new Error("The API failed to return any pages matching the titles.")})),this._cache[e]},r._findSizeBucket=o,e.exports=r},"./src/mobile.mediaViewer/ImageOverlay.js":function(e,t,n){var i=n("./src/mobile.startup/Overlay.js"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.startup/mfExtend.js"),o=n("./src/mobile.startup/Icon.js"),r=n("./src/mobile.startup/icons.js"),l=n("./src/mobile.startup/Button.js"),c=r.cancel("gray"),u=new l({label:mw.msg("mobile-frontend-media-details"),additionalClassNames:"button",progressive:!0}),d=new o({rotation:90,name:"arrow-invert"}),h=new o({rotation:-90,name:"arrow-invert"}),p=n("./src/mobile.mediaViewer/LoadErrorMessage.js"),g=n("./src/mobile.mediaViewer/ImageGateway.js"),m=mw.loader.require("mediawiki.router");function f(e){this.gateway=e.gateway||new g({api:e.api}),this.router=e.router||m,this.eventBus=e.eventBus,i.call(this,s.extend({className:"overlay media-viewer",events:{"click .image-wrapper":"onToggleDetails","click .slider-button":"onSlide"}},e))}a(f,i,{hasFixedHeader:!1,hideOnExitClick:!1,template:mw.template.get("mobile.mediaViewer","Overlay.hogan"),defaults:s.extend({},i.prototype.defaults,{licenseLinkMsg:mw.msg("mobile-frontend-media-license-link"),thumbnails:[]}),onSlide:function(e){var t=this.$el.find(e.target).closest(".slider-button").data("thumbnail");this.emit(f.EVENT_SLIDE,t)},preRender:function(){var e=this;this.options.thumbnails.forEach(function(t,n){t.getFileName()===e.options.title&&(e.options.caption=t.getDescription(),e.galleryOffset=n)})},_enableArrowImages:function(e){var t,n,i=this.galleryOffset;void 0===this.galleryOffset?(t=e[e.length-1],n=e[0]):(t=e[0===i?e.length-1:i-1],n=e[i===e.length-1?0:i+1]),this.$el.find(".prev").data("thumbnail",t),this.$el.find(".next").data("thumbnail",n)},_disableArrowImages:function(){this.$el.find(".prev, .next").remove()},_handleRetry:function(){this.router.emit("hashchange")},postRender:function(){var e,t=r.spinner().$el,n=this.options.thumbnails||[],s=this;function a(){s.hasLoadError=!0,t.hide(),s.$el.find(".image img").hide(),0===s.$el.find(".load-fail-msg").length&&new p({retryPath:s.router.getPath()}).on("retry",s._handleRetry.bind(s)).prependTo(s.$el.find(".image"))}function o(){e.addClass("image-loaded")}n.length<2?this._disableArrowImages():this._enableArrowImages(n),this.$details=this.$el.find(".details"),this.$el.find(".image").append(t),i.prototype.postRender.apply(this),this.$details.prepend(u.$el),this.gateway.getThumb(s.options.title).then(function(n){var i,r=n.descriptionurl+"#mw-jump-to-license";t.hide(),s.thumbWidth=n.thumbwidth,s.thumbHeight=n.thumbheight,s.imgRatio=n.thumbwidth/n.thumbheight,(e=s.parseHTML("<img>",document)).on("load",o).on("error",a),e.attr("src",n.thumburl).attr("alt",s.options.caption),s.$el.find(".image").append(e),s.$details.addClass("is-visible"),s._positionImage(),s.$el.find(".details a").attr("href",r),n.extmetadata&&(n.extmetadata.LicenseShortName&&s.$el.find(".license a").text(n.extmetadata.LicenseShortName.value).attr("href",r),n.extmetadata.Artist&&(i=n.extmetadata.Artist.value.replace(/<.*?>/g,""),s.$el.find(".license").prepend(i+" &bull; "))),s.adjustDetails()},function(){a()}),this.eventBus.on("resize:throttled",this._positionImage.bind(this))},onToggleDetails:function(){this.hasLoadError||(this.$el.find(".cancel, .slider-button").toggle(),this.$details.toggle(),this._positionImage())},onExitClick:function(e){i.prototype.onExitClick.apply(this,arguments),this.emit(f.EVENT_EXIT,e)},show:function(){i.prototype.show.apply(this,arguments),this._positionImage()},_positionImage:function(){var e,t,n,i,a,o=s.getWindow();this.adjustDetails(),e=this.$details.is(":visible")?this.$details.outerHeight():0,i=(t=o.width())/(n=o.height()-e),a=this.$el.find("img"),this.imgRatio>i?t<this.thumbWidth&&a.css({width:t,height:"auto"}):n<this.thumbHeight&&a.css({width:"auto",height:n}),this.$el.find(".image-wrapper").css("bottom",e),this.$el.find(".slider-button.prev").append(d.$el),this.$el.find(".slider-button.next").append(h.$el),c.$el.insertBefore(this.$details)},adjustDetails:function(){var e=s.getWindow().height();this.$el.find(".details").height()>.5*e&&this.$el.find(".details").css("max-height",.5*e)}}),f.EVENT_EXIT="ImageOverlay-exit",f.EVENT_SLIDE="ImageOverlay-slide",e.exports=f},"./src/mobile.mediaViewer/LoadErrorMessage.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s=n("./src/mobile.startup/mfExtend.js"),a=n("./src/mobile.startup/Icon.js"),o=n("./src/mobile.startup/View.js");function r(e){if(!e.retryPath)throw new Error("'retryPath' must be set in options param. Received: "+e.retryPath);o.call(this,{events:{"click .load-fail-msg-link a":"onRetry"}},e)}s(r,o,{template:mw.template.get("mobile.mediaViewer","LoadErrorMessage.hogan"),isTemplateMode:!0,defaults:i.extend({},r.prototype.defaults,{icon:new a({name:"alert-invert",additionalClassNames:"load-fail-msg-icon"}).toHtmlString(),msgToUser:mw.msg("mobile-frontend-media-load-fail-message"),retryTxt:mw.msg("mobile-frontend-media-load-fail-retry")}),postRender:function(){this.$el.find(".load-fail-msg-link a").attr("href","#"+this.options.retryPath)},onRetry:function(){return this.emit("retry"),!1}}),e.exports=r},"./src/mobile.special.nearby.scripts/Nearby.js":function(e,t,n){var i=n("./src/mobile.startup/MessageBox.js"),s=n("./src/mobile.special.nearby.scripts/NearbyGateway.js"),a=n("./src/mobile.startup/util.js"),o=n("./src/mobile.startup/watchstar/WatchstarPageList.js");function r(e){var t=o;this.range=e.range||mw.config.get("wgMFNearbyRange")||1e3,this.source=e.source||"nearby",this.nearbyApi=new s({api:e.api}),this.eventBus=e.eventBus,e.errorType&&(e.errorOptions=this._errorOptions(e.errorType)),this.onItemClick=e.onItemClick,t.apply(this,arguments)}n("./src/mobile.startup/mfExtend.js")(r,o,{errorMessages:{empty:{heading:mw.msg("mobile-frontend-nearby-noresults"),hasHeading:!0,msg:mw.msg("mobile-frontend-nearby-noresults-guidance")},http:{heading:mw.msg("mobile-frontend-nearby-error"),hasHeading:!0,msg:mw.msg("mobile-frontend-nearby-error-guidance")},incompatible:{heading:mw.msg("mobile-frontend-nearby-requirements"),hasHeading:!0,msg:mw.msg("mobile-frontend-nearby-requirements-guidance")}},templatePartials:a.extend({},o.prototype.templatePartials,{pageList:o.prototype.template,messageBox:i.prototype.template}),template:mw.template.get("mobile.special.nearby.scripts","Nearby.hogan"),defaults:a.extend({},o.prototype.defaults,{errorOptions:void 0}),_find:function(e){var t=a.Deferred(),n=this;function i(i){e.pages=i,i&&0===i.length&&(e.errorOptions=n._errorOptions("empty")),n._isLoading=!1,t.resolve(e)}function s(i){n._isLoading=!1,e.errorOptions=n._errorOptions(i),t.resolve(e)}return e.latitude&&e.longitude?this.nearbyApi.getPages({latitude:e.latitude,longitude:e.longitude},this.range,e.exclude).then(i,s):e.pageTitle?this.nearbyApi.getPagesAroundPage(e.pageTitle,this.range).then(i,s):(e.errorType&&(e.errorOptions=this._errorOptions(e.errorType)),t.resolve(e)),t},_errorOptions:function(e){var t=this.errorMessages[e]||this.errorMessages.http;return a.extend({className:"errorbox"},t)},postRender:function(){var e=this;this._isLoading||this.$el.find(".page-list").removeClass("hidden"),o.prototype.postRender.apply(this),this._postRenderLinks(),this.$el.find(function(){e.eventBus.emit("Nearby-postRender")})},_postRenderLinks:function(){var e=this;this.$el.find("a").each(function(t){e.$el.find(this).attr("id","nearby-page-list-item-"+t)}).on("click",this.onItemClick)},refresh:function(e){var t=this,n=o;if(this.$el.find(".page-list").addClass("hidden"),this._isLoading=!0,e.latitude&&e.longitude||e.pageTitle)return e.pages=[],this._find(e).then(function(e){n.call(t,e)},function(i){e.errorOptions=t._errorOptions(i),t._isLoading=!1,n.call(t,e)});throw new Error("No title or longitude, latitude options have been passed")}}),e.exports=r},"./src/mobile.special.nearby.scripts/NearbyGateway.js":function(e,t,n){var i=n("./src/mobile.startup/Page.js"),s=mw.config.get("wgContentNamespaces"),a=n("./src/mobile.startup/util.js"),o=n("./src/mobile.startup/extendSearchParams.js");function r(e){this.api=e.api}r.prototype={_distanceMessage:function(e){if(e<1){if(e*=100,1e3!==(e=10*Math.ceil(e)))return mw.msg("mobile-frontend-nearby-distance-meters",mw.language.convertNumber(e));e=1}else e>2?(e*=10,e=(e=Math.ceil(e)/10).toFixed(1)):(e*=100,e=(e=Math.ceil(e)/100).toFixed(2));return mw.msg("mobile-frontend-nearby-distance",mw.language.convertNumber(e))},getPages:function(e,t,n){return this._search({ggscoord:[e.latitude,e.longitude]},t,n)},getPagesAroundPage:function(e,t){return this._search({ggspage:e},t,e)},_search:function(e,t,n){var r,l=a.Deferred(),c=this;return r=o("nearby",{colimit:"max",prop:["coordinates"],generator:"geosearch",ggsradius:t,ggsnamespace:s,ggslimit:50},e),e.ggscoord?r.codistancefrompoint=e.ggscoord:e.ggspage&&(r.codistancefrompage=e.ggspage),this.api.ajax(r).then(function(e){var t;(t=(t=e.query&&e.query.pages||[]).map(function(e,t){var s,a;return(a=i.newFromJSON(e)).anchor="item_"+t,e.coordinates?(s=e.coordinates[0],a.dist=s.dist/1e3,a.latitude=s.lat,a.longitude=s.lon,a.proximity=c._distanceMessage(a.dist)):a.dist=0,n!==e.title?a:null}).filter(function(e){return!!e})).sort(function(e,t){return e.dist>t.dist?1:-1}),l.resolve(t)},function(e){l.reject(e)}),l}},e.exports=r},"./src/mobile.special.uploads.scripts/PhotoListGateway.js":function(e,t,n){var i=n("./src/mobile.startup/util.js");function s(e){this.api=e.api,this.url=e.url,this.username=e.username,this.category=e.category,this.limit=10,this.continueParams={continue:""},this.canContinue=!0}function a(e){return(e=e.replace(/\.[^. ]+$/,"")).replace(/^[^:]*:/,"").replace(/ \d{4}-\d{1,2}-\d{1,2} \d{1,2}-\d{1,2}$/,"")}s.prototype={getWidth:function(){return mw.config.get("wgMFThumbnailSizes").small},_getImageDataFromPage:function(e){var t=e.imageinfo[0];return{url:t.thumburl,title:e.title,timestamp:t.timestamp,description:a(e.title),descriptionUrl:t.descriptionurl}},getQuery:function(){var e=i.extend({action:"query",prop:"imageinfo",iiprop:"url|timestamp",iiurlwidth:this.getWidth()},this.continueParams);return this.username?i.extend(e,{generator:"allimages",gaiuser:this.username,gaisort:"timestamp",gaidir:"descending",gailimit:this.limit}):this.category&&i.extend(e,{generator:"categorymembers",gcmtitle:"Category:"+this.category,gcmtype:"file",gcmdir:"descending",gcmlimit:this.limit}),this.url&&(e.origin="*"),e},getPhotos:function(){var e=this;return this.api.ajax(this.getQuery(),{url:this.url}).then(function(t){var n=[];return t.query&&t.query.pages&&(n=Object.keys(t.query.pages).map(function(n){return e._getImageDataFromPage(t.query.pages[n])}).sort(function(e,t){return e.timestamp<t.timestamp?1:-1})),void 0!==t.continue?e.continueParams=t.continue:e.canContinue=!1,{canContinue:e.canContinue,photos:n}})}},s.test={getDescription:a},e.exports=s},"./src/mobile.special.watchlist.scripts/WatchList.js":function(e,t,n){var i=n("./src/mobile.startup/mfExtend.js"),s=n("./src/mobile.startup/PageList.js"),a=n("./src/mobile.startup/watchstar/WatchstarPageList.js"),o=n("./src/mobile.startup/ScrollEndEventEmitter.js"),r=n("./src/mobile.startup/util.js"),l=n("./src/mobile.special.watchlist.scripts/WatchListGateway.js");function c(e){var t,n=r.extend({},{isBorderBox:!1},e);this.scrollEndEventEmitter=new o(n.eventBus),this.scrollEndEventEmitter.on(o.EVENT_SCROLL_END,this._loadPages.bind(this)),n.el&&(t=this.getLastTitle(n.el)),this.gateway=new l(n.api,t),a.call(this,n)}i(c,a,{preRender:function(){this.scrollEndEventEmitter.disable(),this.scrollEndEventEmitter.setElement(this.$el)},postRender:function(){var e,t;s.prototype.postRender.apply(this),e=this.queryUnitializedItems(),t=Object.keys(this.parsePagesFromItems(e)).reduce(function(e,t){return e[t]=!0,e},{}),this.renderItems(e,t),this.scrollEndEventEmitter.enable()},_loadPages:function(){this.gateway.loadWatchlist().then(function(e){e.forEach(function(e){this.appendPage(e)}.bind(this)),this.render()}.bind(this))},appendPage:function(e){var t=r.extend({},e.options,{wikidataDescription:void 0});this.$el.append(this.templatePartials.item.render(t))},getLastTitle:function(e){return e.find("li:last").attr("title")}}),e.exports=c},"./src/mobile.special.watchlist.scripts/WatchListGateway.js":function(e,t,n){var i=n("./src/mobile.startup/Page.js"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.startup/extendSearchParams.js");function o(e,t){this.api=e,this.limit=50,t?(this.continueParams={continue:"gwrcontinue||",gwrcontinue:"0|"+t.replace(/ /g,"_")},this.shouldSkipFirstTitle=!0):(this.continueParams={continue:""},this.shouldSkipFirstTitle=!1),this.canContinue=!0}o.prototype={loadWatchlist:function(){var e=this,t=a("watchlist",{prop:["info","revisions"],rvprop:"timestamp|user",generator:"watchlistraw",gwrnamespace:"0",gwrlimit:this.limit},this.continueParams);return!1===this.canContinue?s.Deferred().resolve([]):this.api.get(t,{url:this.apiUrl}).then(function(t){return void 0!==t.continue?e.continueParams=t.continue:e.canContinue=!1,e.parseData(t)})},parseData:function(e){var t;return e.query&&e.query.pages?((t=e.query.pages).sort(function(e,t){return e.title===t.title?0:e.title<t.title?-1:1}),this.shouldSkipFirstTitle&&(t=t.slice(1),this.shouldSkipFirstTitle=!1),t.map(i.newFromJSON)):[]}},e.exports=o},"./src/mobile.startup/Anchor.js":function(e,t,n){var i=n("./src/mobile.startup/View.js");function s(){i.apply(this,arguments)}n("./src/mobile.startup/mfExtend.js")(s,i,{isTemplateMode:!0,defaults:{progressive:void 0,destructive:void 0,additionalClassNames:"",href:void 0,label:void 0},template:mw.template.get("mobile.startup","anchor.hogan")}),e.exports=s},"./src/mobile.startup/Browser.js":function(e,t,n){var i,s=n("./src/mobile.startup/util.js");function a(e){var t=function t(){var n=this["__cache"+t.cacheId]||(this["__cache"+t.cacheId]={}),i=[].join.call(arguments,"|");return Object.prototype.hasOwnProperty.call(n,i)?n[i]:n[i]=e.apply(this,arguments)};return t.cacheId=Date.now().toString()+Math.random().toString(),t}function o(e,t){this.userAgent=e,this.$el=t,this._fixIosLandscapeBug()}o.prototype={_fixIosLandscapeBug:function(){var e=this;this.$el.find('meta[name="viewport"]')[0]&&(this.isIos(4)||this.isIos(5))&&(this.lockViewport(),document.addEventListener("gesturestart",function(){e.lockViewport()},!1))},isIos:a(function(e){var t=this.userAgent,n=/ipad|iphone|ipod/i.test(t);if(!n||!e)return n;switch(e){case 8:return/OS 8_/.test(t)||/Version\/8/.test(t);case 4:return/OS 4_/.test(t);case 5:return/OS 5_/.test(t);default:return!1}}),lockViewport:function(){this.$el&&this.$el.find('meta[name="viewport"]').attr("content","initial-scale=1.0, maximum-scale=1.0, user-scalable=no")},isWideScreen:a(function(){var e=parseInt(mw.config.get("wgMFDeviceWidthTablet"),10);return window.innerWidth>=e||window.innerHeight>=e}),supportsAnimations:a(function(){var e=document.createElement("foo").style;function t(t){return t in e||"webkit"+t[0].toUpperCase()+t.slice(1)in e}return t("animationName")&&t("transform")&&t("transition")}),supportsTouchEvents:a(function(){return"ontouchstart"in window}),supportsGeoLocation:a(function(){return"geolocation"in window.navigator})},o.getSingleton=function(){var e;return i||(e=s.getDocument(),i=new o(window.navigator.userAgent,e)),i},e.exports=o},"./src/mobile.startup/Button.js":function(e,t,n){var i=n("./src/mobile.startup/mfExtend.js"),s=n("./src/mobile.startup/View.js");function a(e){e.href&&(e.tagName="a"),s.call(this,e)}i(a,s,{isTemplateMode:!0,defaults:{tagName:"a",block:void 0,progressive:void 0,destructive:void 0,quiet:void 0,additionalClassNames:"",href:void 0,label:void 0},template:mw.template.get("mobile.startup","button.hogan")}),e.exports=a},"./src/mobile.startup/CtaDrawer.js":function(e,t,n){var i=n("./src/mobile.startup/mfExtend.js"),s=n("./src/mobile.startup/Drawer.js"),a=n("./src/mobile.startup/util.js"),o=n("./src/mobile.startup/Button.js"),r=n("./src/mobile.startup/Anchor.js");function l(e){s.call(this,a.extend({},s.prototype.defaults,{progressiveButton:new o({progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-login")}).options,actionAnchor:new r({progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-signup")}).options},e))}function c(e,t){return a.extend({returnto:t||mw.config.get("wgPageName")},e)}function u(){return[].push.call(arguments,{type:"signup"}),a.extend.apply(a,arguments)}i(l,s,{templatePartials:a.extend({},s.prototype.templatePartials,{button:o.prototype.template,anchor:r.prototype.template}),template:mw.template.get("mobile.startup","CtaDrawer.hogan"),preRender:function(){var e=c(this.options.queryParams,this.options.returnTo);this.options.progressiveButton.href||(this.options.progressiveButton.href=mw.util.getUrl("Special:UserLogin",e)),this.options.actionAnchor.href||(this.options.actionAnchor.href=mw.util.getUrl("Special:UserLogin",u(e,this.options.signupQueryParams)))}}),l.prototype.test={redirectParams:c,signUpParams:u},e.exports=l},"./src/mobile.startup/Drawer.js":function(e,t,n){var i=n("./src/mobile.startup/mfExtend.js"),s=n("./src/mobile.startup/Panel.js"),a=n("./src/mobile.startup/util.js"),o=n("./src/mobile.startup/Icon.js");function r(e){s.call(this,a.extend({className:"drawer position-fixed"},e,{events:a.extend({click:"stopPropagation"},(e||{}).events)}))}i(r,s,{defaults:a.extend({},s.prototype.defaults,{collapseIcon:new o({name:"arrow",additionalClassNames:"cancel"}).options}),templatePartials:a.extend({},s.prototype.templatePartials,{icon:o.prototype.template}),appendToElement:"body",closeOnScroll:!0,postRender:function(){var e=this;a.docReady(function(){e.appendTo(e.appendToElement),e.$el.parent().addClass("has-drawer")}),this.on("show",this.onShowDrawer.bind(this)),this.on("hide",this.onHideDrawer.bind(this))},stopPropagation:function(e){e.stopPropagation()},onShowDrawer:function(){var e=this;this.$el.parent().addClass("drawer-visible"),setTimeout(function(){var t=a.getWindow();t.one("click.drawer",e.hide.bind(e)),e.closeOnScroll&&t.one("scroll.drawer",e.hide.bind(e))},e.minHideDelay)},onHideDrawer:function(){this.$el.parent().removeClass("drawer-visible"),a.getWindow().off(".drawer")}}),e.exports=r},"./src/mobile.startup/Icon.js":function(e,t,n){var i=n("./src/mobile.startup/mfExtend.js"),s=n("./src/mobile.startup/View.js");function a(e){e.hasText&&(e.modifier="mw-ui-icon-before"),e.href&&(e.tagName="a"),s.call(this,e)}i(a,s,{preRender:function(){this.setRotationClass()},setRotationClass:function(){var e=this.options;if(e.rotation)switch(e.rotation){case-180:case 180:e._rotationClass="mf-mw-ui-icon-rotate-flip";break;case-90:e._rotationClass="mf-mw-ui-icon-rotate-anti-clockwise";break;case 90:e._rotationClass="mf-mw-ui-icon-rotate-clockwise";break;case 0:break;default:throw new Error("Bad value for rotation given. Must be ±90, 0 or ±180.")}},isTemplateMode:!0,defaults:{rotation:0,hasText:!1,href:void 0,glyphPrefix:"mf",tagName:"div",isSmall:!1,base:"mw-ui-icon",name:"",modifier:"mw-ui-icon-element",title:""},getClassName:function(){return this.$el.attr("class")},getGlyphClassName:function(){return this.options.base+"-"+this.options.glyphPrefix+"-"+this.options.name},toHtmlString:function(){return this.parseHTML("<div>").append(this.$el).html()},template:mw.template.get("mobile.startup","icon.hogan")}),e.exports=a},"./src/mobile.startup/MessageBox.js":function(e,t,n){var i=n("./src/mobile.startup/View.js");function s(){i.apply(this,arguments)}n("./src/mobile.startup/mfExtend.js")(s,i,{isTemplateMode:!0,defaults:{},template:mw.template.get("mobile.startup","MessageBox.hogan")}),e.exports=s},"./src/mobile.startup/Overlay.js":function(e,t,n){var i,s,a,o=n("./src/mobile.startup/View.js"),r=n("./src/mobile.startup/Icon.js"),l=n("./src/mobile.startup/Button.js"),c=n("./src/mobile.startup/Anchor.js"),u=n("./src/mobile.startup/icons.js"),d=n("./src/mobile.startup/util.js"),h=n("./src/mobile.startup/Browser.js").getSingleton(),p=n("./src/mobile.startup/mfExtend.js");try{s=!1,i=Object.defineProperty({},"passive",{get:function(){return s=!0,!0}}),window.addEventListener("testPassive",null,i),window.removeEventListener("testPassive",null,i),a=!!s&&{passive:!1}}catch(e){}function g(e){this.isIos=h.isIos(),this.hasLoadError=!1,o.call(this,d.extend({className:"overlay"},e,{events:d.extend({"click .cancel, .confirm, .initial-header .back":"onExitClick",click:"stopPropagation"},e.events)}))}p(g,o,{hasFixedHeader:!0,fullScreen:!0,hideOnExitClick:!0,templatePartials:{header:mw.template.get("mobile.startup","header.hogan"),anchor:c.prototype.template,button:l.prototype.template},template:mw.template.get("mobile.startup","Overlay.hogan"),defaults:{saveMsg:mw.msg("mobile-frontend-editor-save"),cancelButton:u.cancel().toHtmlString(),backButton:new r({tagName:"button",name:"back",additionalClassNames:"back",label:mw.msg("mobile-frontend-overlay-close")}).toHtmlString(),headerButtonsListClassName:"",headerChrome:!1,spinner:u.spinner().toHtmlString()},closeOnContentTap:!1,showSpinner:function(){this.$spinner.removeClass("hidden")},hideSpinner:function(){this.$spinner.addClass("hidden")},postRender:function(){this.$overlayContent=this.$el.find(".overlay-content"),this.$spinner=this.$el.find(".spinner"),this.isIos&&this.$el.addClass("overlay-ios"),this.$el.find(".overlay-header h2 span").addClass("truncated-text"),this.setupEmulatedIosOverlayScrolling()},setupEmulatedIosOverlayScrolling:function(){var e=this,t=this.$el.find(".overlay-content");this.isIos&&this.hasFixedHeader&&(t[0].addEventListener("touchstart",this.onTouchStart.bind(this),a),t[0].addEventListener("touchmove",this.onTouchMove.bind(this),a),setTimeout(function(){var t=d.getWindow();e._resizeContent(t.height())},0))},onExitClick:function(e){e.preventDefault(),e.stopPropagation(),this.hideOnExitClick&&this.hide(),this.emit(g.EVENT_EXIT)},onTouchStart:function(e){this.startY=e.touches[0].pageY},onTouchMove:function(e){var t=e.touches[0].pageY,n=this.$overlayContent.outerHeight(),i=this.$overlayContent.prop("scrollHeight")-n;e.stopPropagation(),(0===this.$overlayContent.scrollTop()&&this.startY<t||this.$overlayContent.scrollTop()===i&&this.startY>t)&&e.preventDefault()},stopPropagation:function(e){e.stopPropagation()},show:function(){var e=this,t=d.getDocument(),n=d.getWindow();this.scrollTop=window.pageYOffset,this.fullScreen&&(t.addClass("overlay-enabled"),window.scrollTo(0,1)),this.closeOnContentTap&&t.find("#mw-mf-page-center").one("click",this.hide.bind(this)),this.isIos&&this.hasFixedHeader&&(this.iosTouchmoveHandler=function(e){e.preventDefault()},this.iosResizeHandler=function(){e._resizeContent(n.height())},n[0].addEventListener("touchmove",this.iosTouchmoveHandler,a),n.on("resize",this.iosResizeHandler)),this.$el.addClass("visible")},hide:function(){var e=d.getWindow(),t=d.getDocument();return this.fullScreen&&(t.removeClass("overlay-enabled"),window.scrollTo(window.pageXOffset,this.scrollTop)),this.$el.detach(),this.isIos&&(e[0].removeEventListener("touchmove",this.iosTouchmoveHandler,a),e.off("resize",this.iosResizeHandler)),this.emit("hide"),!0},_resizeContent:function(e){this.$overlayContent.height(e-this.$el.find(".overlay-header-container").outerHeight()-this.$el.find(".overlay-footer-container").outerHeight())},showHidden:function(e){this.$el.find(".hideable").addClass("hidden"),this.$el.find(e).removeClass("hidden")}}),g.EVENT_EXIT="Overlay-exit",g.make=function(e,t){var n=new g(e);return n.$el.find(".overlay-content").append(t.$el),n},e.exports=g},"./src/mobile.startup/OverlayManager.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s=null;function a(e,t){e.on("route",this._checkRoute.bind(this)),this.router=e,this.entries={},this.stack=[],this.hideCurrent=!0,t||mw.log.warn("appendToSelector will soon be a required parameter to OverlayManager"),this.appendToSelector=t||"body"}function o(e){e.on("hide",function(){e.emit("_om_hide")})}n("./src/mobile.startup/mfExtend.js")(a,{_onHideOverlay:function(){this.hideCurrent=!1,this.router.back()},_attachOverlay:function(e){e.$el.parents().length||$(this.appendToSelector).append(e.$el)},_show:function(e){e.once("_om_hide",this._onHideOverlay.bind(this)),this._attachOverlay(e),e.show()},_hideOverlay:function(e){var t;return e.off("_om_hide"),(t=e.hide(this.stack.length>1))||e.once("_om_hide",this._onHideOverlay.bind(this)),t},_processMatch:function(e){var t,n=this;e&&(e.overlay?n._show(e.overlay):"function"==typeof(t=e.factoryResult).promise?t.then(function(t){e.overlay=t,o(t),n._show(t)}):(e.overlay=t,o(e.overlay),n._show(t)))},_checkRoute:function(e){var t,n=this.stack[0];n||(this.scrollTop=window.pageYOffset),t=Object.keys(this.entries).reduce(function(t,n){return t||this._matchRoute(e.path,this.entries[n])}.bind(this),null),n&&void 0!==n.overlay&&this.hideCurrent&&!this._hideOverlay(n.overlay)?e.preventDefault():t||(this.stack=[],window.scrollTo(window.pageXOffset,this.scrollTop)),this.hideCurrent=!0,this._processMatch(t)},_matchRoute:function(e,t){var n,i=e.match(t.route),s=this.stack[1],a=this;function o(){return{path:e,factoryResult:t.factory.apply(a,i.slice(1))}}return i?s&&s.path===e?s.overlay&&s.overlay.hasLoadError?(a.stack.shift(),a.stack[0]=o(),a.stack[0]):(a.stack.shift(),s):(n=o(),this.stack[0]&&n.path===this.stack[0].path?a.stack[0]=n:a.stack.unshift(n),n):null},add:function(e,t){var n=this,s={route:e,factory:t};this.entries[e]=s,i.docReady(function(){n._processMatch(n._matchRoute(n.router.getPath(),s))})},replaceCurrent:function(e){if(0===this.stack.length)throw new Error("Trying to replace OverlayManager's current overlay, but stack is empty");this._hideOverlay(this.stack[0].overlay),this.stack[0].overlay=e,o(e),this._show(e)}}),a.getSingleton=function(){return s||(s=new a(mw.loader.require("mediawiki.router"),"body")),s},e.exports=a},"./src/mobile.startup/Page.js":function(e,t,n){var i=mw.html,s=n("./src/mobile.startup/mfExtend.js"),a=n("./src/mobile.startup/time.js"),o=n("./src/mobile.startup/util.js"),r=n("./src/mobile.startup/Section.js"),l=n("./src/mobile.startup/Thumbnail.js"),c=n("./src/mobile.startup/View.js"),u=mw.config.get("wgMFMobileFormatterHeadings",["h1","h2","h3","h4","h5"]).join(","),d=["noviewer","metadata"];function h(e){o.extend(this,{options:e,title:e.title,displayTitle:e.displayTitle,url:e.url||mw.util.getUrl(e.title),id:e.id,wikidataDescription:e.wikidataDescription,thumbnail:!!Object.prototype.hasOwnProperty.call(e,"thumbnail")&&e.thumbnail,isMissing:void 0!==e.isMissing?e.isMissing:0===e.id}),this.options.isBorderBox=!1,this.options.languageUrl=mw.util.getUrl("Special:MobileLanguages/"+this.title),c.call(this,this.options),this.displayTitle||(this.displayTitle=this.getDisplayTitle()),this.thumbnail&&this.thumbnail.width&&(this.thumbnail.isLandscape=this.thumbnail.width>this.thumbnail.height)}s(h,c,{defaults:{id:0,title:"",displayTitle:"",namespaceNumber:0,protection:{edit:["*"]},sections:[],isMissing:!1,isMainPage:!1,url:void 0,thumbnail:{isLandscape:void 0,source:void 0,width:void 0,height:void 0}},getDisplayTitle:function(){return this.options.displayTitle||i.escape(this.options.title)},inNamespace:function(e){return this.options.namespaceNumber===mw.config.get("wgNamespaceIds")[e]},findSectionHeadingByIndex:function(e){return e<1?this.$el.find():this.$el.find(u).filter('.mw-parser-output > *, [class^="mf-section-"] > *').eq(e-1)},findChildInSectionLead:function(e,t){var n,i,s,a,o=u;function r(e){return e.find(t).addBack()}return 0===e?(a=this.getLeadSectionElement())&&a.length?r(a.children(t)):(n=this.findSectionHeadingByIndex(1)).length?r(n.prevAll(t)):this.$el.find(t):(n=this.findSectionHeadingByIndex(e)).hasClass("section-heading")?(i=(s=n.next()).find(o).eq(0)).length?r(i.prevAll(t)):r(s.children(t)):(i=n.eq(0).nextAll(o).eq(0),n.nextUntil(i,t))},getLeadSectionElement:function(){return this.$el.find(".mf-section-0").length?this.$el.find(".mf-section-0"):null},isWikiText:function(){return"wikitext"===mw.config.get("wgPageContentModel")},isMainPage:function(){return this.options.isMainPage},isWatched:function(){return this.options.isWatched},getRevisionId:function(){return this.options.revId},getTitle:function(){return this.options.title},getId:function(){return this.options.id},getNamespaceId:function(){var e=this.options.title.split(":");return e[1]&&mw.config.get("wgNamespaceIds")[e[0].toLowerCase().replace(" ","_")]||0},isTalkPage:function(){var e=this.getNamespaceId();return e>0&&e%2==1},preRender:function(){this.sections=[],this._sectionLookup={},this.title=this.options.title,this.options.sections.forEach(function(e){var t=new r(e);this.sections.push(t),this._sectionLookup[t.id]=t}.bind(this))},getThumbnails:function(){var e=this.$el,t="."+d.join(",."),n=[];return this._thumbs||(e.find("a.image, a.thumbimage").not(t).each(function(){var i=e.find(this),s=i.find(".lazy-image-placeholder"),a=0===i.parents(t).length&&0===i.find(t).length,o=i.attr("href").match(/title=([^/&]+)/),r=i.attr("href").match(/[^/]+$/);s.length&&a&&(a=!new RegExp("\\b("+d.join("|")+")\\b").test(s.data("class"))),a&&(o||r)&&n.push(new l({el:i,filename:decodeURIComponent(o?o[1]:r[0])}))}),this._thumbs=n),this._thumbs},getSection:function(e){return this._sectionLookup[e]},getSections:function(){return this.sections},getRedLinks:function(){return this.$el.find(".new")}}),h.newFromJSON=function(e){var t,n,s=e.thumbnail,r=e.pageprops||{displaytitle:i.escape(e.title)},l=e.terms;return(r||l)&&(n=l&&l.label?i.escape(l.label[0]):r.displaytitle),e.wikidataDescription=e.description||void 0,s&&(e.thumbnail.isLandscape=s.width>s.height),e.revisions&&e.revisions[0]&&(t=e.revisions[0],e.lastModified=a.getLastModifiedMessage(new Date(t.timestamp).getTime()/1e3,t.user)),new h(o.extend(e,{id:e.pageid,isMissing:!!e.missing,url:mw.util.getUrl(e.title),displayTitle:n}))},h.HEADING_SELECTOR=u,e.exports=h},"./src/mobile.startup/PageGateway.js":function(e,t,n){var i=mw.template.get("mobile.startup","Section.hogan"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.startup/Page.js"),o=n("./src/mobile.startup/actionParams.js"),r={};function l(e){var t,n=e.map(function(e){return e.level}).filter(function(e){return!!e}),s=Math.min.apply(this,n).toString(),a=[];return e.forEach(function(e){void 0!==e.line&&(e.line=e.line.replace(/<\/?a\b[^>]*>/g,"")),e.subsections=[],!t||!e.level||e.level===s||t.subsections.length&&t.subsections[0].level>e.level||t.level&&t.level>=e.level?(a.push(e),t=e):(!function e(t,n){var i;0===t.length?t.push(n):(i=t[t.length-1],parseInt(i.level,10)===parseInt(n.level,10)?t.push(n):e(i.subsections,n))}(t.subsections,e),t.text+=i.render(e))}),a}function c(e){this.api=e}c.prototype={getSections:function(e){var t=s.Deferred();return this.getPage(e).then(function(e){var n=new a(e);t.resolve(n.getSections())},function(e){"missingtitle"===e?t.resolve([]):t.reject()}),t.promise()},getPage:function(e,t,n){var i,a=s.Deferred(),c=t?{url:t,dataType:"jsonp"}:{},u={edit:["*"]};return s.extend(c,o({action:"mobileview",page:e,variant:mw.config.get("wgPageContentLanguage"),redirect:"yes",prop:"id|sections|text|lastmodified|lastmodifiedby|languagecount|hasvariants|protection|displaytitle|revision",noheadings:"yes",sectionprop:"level|line|anchor",sections:n?0:"all"})),r[e]||(r[e]=this.api.get(c).then(function(t){var n,o,r,c;return t.error?a.reject(t.error):t.mobileview.sections?(n=l((c=t.mobileview).sections),i=new Date(c.lastmodified).getTime()/1e3,o=c.lastmodifiedby,u=Array.isArray(c.protection)?u:s.extend(u,c.protection),r={title:e,id:c.id,revId:c.revId,protection:u,lead:n[0].text,sections:n.slice(1),isMainPage:void 0!==c.mainpage,historyUrl:mw.util.getUrl(e,{action:"history"}),lastModifiedTimestamp:i,languageCount:c.languagecount,hasVariants:void 0!==c.hasvariants,displayTitle:c.displaytitle},o&&s.extend(r,{lastModifiedUserName:o.name,lastModifiedUserGender:o.gender}),r):a.reject("No sections")},function(e){return a.reject(e)})),r[e]},invalidatePage:function(e){delete r[e]},_getLanguageVariantsFromApiResponse:function(e,t){var n=t.query.general,i=n.variantarticlepath,s=[];return!!n.variants&&(Object.keys(n.variants).forEach(function(t){var a=n.variants[t],o={autonym:a.name,lang:a.code};o.url=i?i.replace("$1",e).replace("$2",a.code):mw.util.getUrl(e,{variant:a.code}),s.push(o)}),s)},getPageLanguages:function(e,t){var n=this,i=o({meta:"siteinfo",siprop:"general",prop:"langlinks",lllimit:"max",titles:e});return t?(i.llprop="url|autonym|langname",i.llinlanguagecode=t):i.llprop="url|autonym",this.api.get(i).then(function(t){return{languages:t.query.pages[0].langlinks||[],variants:n._getLanguageVariantsFromApiResponse(e,t)}},function(){return s.Deferred().reject()})},_getAPIResponseFromHTML:function(e){var t=[];return e.find("h1,h2,h3,h4,h5,h6").each(function(){var n=this.tagName.substr(1),i=e.find(this).find(".mw-headline");i.length&&t.push({level:n,line:i.html(),anchor:i.attr("id")||"",text:""})}),t},getSectionsFromHTML:function(e){return l(this._getAPIResponseFromHTML(e))}},e.exports=c},"./src/mobile.startup/PageList.js":function(e,t,n){var i=n("./src/mobile.startup/mfExtend.js"),s=n("./src/mobile.startup/View.js"),a=n("./src/mobile.startup/Browser.js").getSingleton();function o(){s.apply(this,arguments)}i(o,s,{defaults:{pages:[]},renderPageImages:function(){var e=this;setTimeout(function(){e.$el.find(".list-thumb").each(function(){var t=e.$el.find(this).data("style");e.$el.find(this).attr("style",t)})},a.isWideScreen()?0:1e3)},postRender:function(){this.renderPageImages()},template:mw.template.get("mobile.startup","PageList.hogan"),templatePartials:{item:mw.template.get("mobile.startup","PageListItem.hogan")}}),e.exports=o},"./src/mobile.startup/Panel.js":function(e,t,n){var i=n("./src/mobile.startup/mfExtend.js"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.startup/View.js");function o(e){a.call(this,s.extend({className:"panel"},e,{events:s.extend({"click .cancel":"onCancel"},(e||{}).events)}))}i(o,a,{minHideDelay:10,onCancel:function(e){e.preventDefault(),this.hide()},show:function(){var e=this;e.isVisible()||setTimeout(function(){e.$el.addClass("visible animated"),e.emit("show")},e.minHideDelay)},hide:function(){var e=this;setTimeout(function(){e.$el.removeClass("visible"),e.emit("hide")},e.minHideDelay)},isVisible:function(){return this.$el.hasClass("visible")},toggle:function(){this.isVisible()?this.hide():this.show()}}),e.exports=o},"./src/mobile.startup/ScrollEndEventEmitter.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s=n("./src/mobile.startup/mfExtend.js");function a(e,t){this.threshold=t||100,this.eventBus=e,this.enable(),OO.EventEmitter.call(this)}OO.mixinClass(a,OO.EventEmitter),a.EVENT_SCROLL_END="ScrollEndEventEmitter-scrollEnd",s(a,{_bindScroll:function(){this._scrollHandler||(this._scrollHandler=this._onScroll.bind(this),this.eventBus.on("scroll:throttled",this._scrollHandler))},_unbindScroll:function(){this._scrollHandler&&(this.eventBus.off("scroll:throttled",this._scrollHandler),this._scrollHandler=null)},_onScroll:function(){this.$el&&this.enabled&&this.scrollNearEnd()&&(this.disable(),this.emit(a.EVENT_SCROLL_END))},scrollNearEnd:function(){var e=i.getWindow(),t=e.scrollTop()+e.height(),n=this.$el.offset().top+this.$el.outerHeight();return t+this.threshold>n},enable:function(){this.enabled=!0,this._bindScroll()},disable:function(){this.enabled=!1,this._unbindScroll()},setElement:function(e){this.$el=e}}),e.exports=a},"./src/mobile.startup/Section.js":function(e,t,n){var i=n("./src/mobile.startup/mfExtend.js"),s=n("./src/mobile.startup/icons.js"),a=n("./src/mobile.startup/View.js");function o(e){var t=this;e.tag="h"+e.level,this.line=e.line,this.text=e.text,this.hasReferences=e.hasReferences||!1,this.id=e.id||null,this.anchor=e.anchor,this.subsections=[],(e.subsections||[]).forEach(function(e){t.subsections.push(new o(e))}),a.call(this,e)}i(o,a,{template:mw.template.get("mobile.startup","Section.hogan"),defaults:{line:void 0,text:"",spinner:s.spinner().toHtmlString()}}),e.exports=o},"./src/mobile.startup/Thumbnail.js":function(e,t,n){var i=n("./src/mobile.startup/mfExtend.js"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.startup/View.js");function o(e){a.call(this,s.extend({isBorderBox:!1},e))}i(o,a,{defaults:{filename:void 0},postRender:function(){this.options.description=this.$el.siblings(".thumbcaption").text()},getDescription:function(){return this.options.description},getFileName:function(){return this.options.filename}}),e.exports=o},"./src/mobile.startup/Toggler.js":function(e,t,n){var i=n("./src/mobile.startup/Browser.js").getSingleton(),s=n("./src/mobile.startup/util.js"),a=s.escapeHash,o={name:"arrow",additionalClassNames:"indicator"},r=n("./src/mobile.startup/Icon.js");function l(e){this.eventBus=e.eventBus,this._enable(e.$container,e.prefix,e.page,e.isClosed)}function c(e){var t=JSON.parse(mw.storage.get("expandedSections")||"{}");return t[e.title]=t[e.title]||{},t}function u(e){mw.storage.set("expandedSections",JSON.stringify(e))}function d(e,t,n){var i,s,a=c(n);t.find(".section-heading span").each(function(){s=t.find(this),i=s.parents(".section-heading"),a[n.title][s.attr("id")]&&!i.hasClass("open-block")&&e.toggle(i,n)})}function h(e){var t=(new Date).getTime(),n=c(e);Object.keys(n).forEach(function(e){var i=n[e];Object.keys(i).forEach(function(s){var a=i[s];Math.floor((t-a)/1e3/60/60/24)>=1&&delete n[e][s]})}),u(n)}l.prototype.toggle=function(e){var t,n=e.is(".open-block"),s=e.data("page"),a=e.next();e.toggleClass("open-block"),e.data("indicator").remove(),o.rotation=n?0:180,t=new r(o).prependTo(e),e.data("indicator",t),a.toggleClass("open-block").attr({"aria-pressed":!n,"aria-expanded":!n}),this.eventBus.emit("section-toggled",{expanded:n,page:s,isReferenceSection:Boolean(a.attr("data-is-reference-section")),$heading:e}),i.isWideScreen()||function(e,t){var n=e.find("span").attr("id"),i=e.hasClass("open-block"),s=c(t);n&&(i?s[t.title][n]=(new Date).getTime():delete s[t.title][n],u(s))}(e,s)},l.prototype.reveal=function(e,t){var n,i;try{(i=(n=t.find(a(e))).parents(".collapsible-heading")).length||(i=n.parents(".collapsible-block").prev(".collapsible-heading")),i.length&&!i.hasClass("open-block")&&this.toggle(i),i.length&&window.scrollTo(0,n.offset().top)}catch(e){}},l.prototype._enable=function(e,t,n,a){var l,c,u,p,g,m=this,f=mw.config.get("wgMFCollapseSectionsByDefault");function w(){var t=window.location.hash;0===t.indexOf("#")&&m.reveal(t,e)}l=e.find("> h1,> h2,> h3,> h4,> h5,> h6,.section-heading").eq(0).prop("tagName")||"H1",void 0===f&&(f=!0),c=!f||"true"===mw.storage.get("expandSections"),e.children(l).each(function(s){var l,d=e.find(this),h=d.find(".indicator"),g=t+"collapsible-block-"+s;d.next().is("div")&&(p=d.next("div"),l=Boolean(p.attr("data-is-reference-section")),d.addClass("collapsible-heading ").data("section-number",s).data("page",n).attr({tabindex:0,"aria-haspopup":"true","aria-controls":g}).on("click",function(e){e.target.href||(e.preventDefault(),m.toggle(d))}),o.rotation=c?180:0,u=new r(o),h.length?h.replaceWith(u.$el):u.prependTo(d),d.data("indicator",u.$el),p.addClass("collapsible-block").eq(0).attr({id:g,"aria-pressed":"false","aria-expanded":"false"}),function(e,t){t.on("keypress",function(n){13!==n.which&&32!==n.which||e.toggle(t)}).find("a").on("keypress mouseup",function(e){e.stopPropagation()})}(m,d),!l&&(!a&&i.isWideScreen()||c)&&m.toggle(d))}),function(){var t=mw.config.get("wgInternalRedirectTargetUrl"),n=!!t&&t.split("#")[1];n&&(window.location.hash=n,m.reveal(n,e))}(),w(),(g=e.find("a:not(.reference a)")).on("click",function(){void 0!==g.attr("href")&&g.attr("href").indexOf("#")>-1&&w()}),s.getWindow().on("hashchange",function(){w()}),!i.isWideScreen()&&n&&(d(this,e,n),h(n))},l._getExpandedSections=c,l._expandStoredSections=d,l._cleanObsoleteStoredSections=h,e.exports=l},"./src/mobile.startup/View.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s=n("./src/mobile.startup/mfExtend.js"),a=/^(\S+)\s*(.*)$/,o=0;function r(){this.initialize.apply(this,arguments)}OO.mixinClass(r,OO.EventEmitter),s(r,{tagName:"div",isTemplateMode:!1,template:void 0,templatePartials:{},defaults:{},initialize:function(e){var t=this;OO.EventEmitter.call(this),e=i.extend({},this.defaults,e),this.options=e,this.cid=function(e){var t=(++o).toString();return e?e+t:t}("view"),"string"==typeof this.template&&(this.template=mw.template.compile(this.template)),e.el?this.$el=$(e.el):this.$el=this.parseHTML("<"+this.tagName+">"),this.$el.length?this._postInitialize(e):i.docReady(function(){t.$el=$(e.el),t._postInitialize(e)})},_postInitialize:function(e){var t=e.className;this.$el.addClass(t),!1!==e.isBorderBox&&this.$el.addClass("view-border-box"),this.render({})},preRender:function(){},postRender:function(){},render:function(e){var t,n;return i.extend(this.options,e),this.preRender(),this.undelegateEvents(),this.template&&!this.options.skipTemplateRender&&(n=this.template.render(this.options,this.templatePartials),this.isTemplateMode?(t=$(n),this.$el.replaceWith(t),this.$el=t):this.$el.html(n)),this.postRender(),this.delegateEvents(),this},$:function(e){return mw.log.warn("Use of View.$ is deprecated. Use View.$el.find instead."),this.$el.find(e)},delegateEvents:function(e){var t,n,i;if(e=e||this.options.events)for(n in this.undelegateEvents(),e)"function"!=typeof(i=e[n])&&(i=this[e[n]]),i&&(t=n.match(a),this.delegate(t[1],t[2],i.bind(this)))},delegate:function(e,t,n){this.$el.on(e+".delegateEvents"+this.cid,t,n)},undelegateEvents:function(){this.$el&&this.$el.off(".delegateEvents"+this.cid)},undelegate:function(e,t,n){this.$el.off(e+".delegateEvents"+this.cid,t,n)},parseHTML:function(e){return i.parseHTML(e,document)}}),["append","prepend","appendTo","prependTo","after","before","insertAfter","insertBefore","remove","detach"].forEach(function(e){r.prototype[e]=function(){return this.$el[e].apply(this.$el,arguments),this}}),e.exports=r},"./src/mobile.startup/actionParams.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s={action:"query",formatversion:2};e.exports=function(e){var t=mw.config.get("wgMFContentProviderScriptPath");return i.extend({},s,{origin:t?"*":void 0},e)}},"./src/mobile.startup/cache.js":function(e,t){function n(){this._cache={}}function i(){}n.prototype.get=function(e){return this._cache[e]},n.prototype.set=function(e,t){this._cache[e]=t},i.prototype.get=function(){},i.prototype.set=function(){},e.exports={MemoryCache:n,NoCache:i}},"./src/mobile.startup/context.js":function(e,t){e.exports={getMode:function(){return mw.config.get("wgMFMode")}}},"./src/mobile.startup/extendSearchParams.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s=n("./src/mobile.startup/actionParams.js");e.exports=function(e){var t,n,a=mw.config.get("wgMFDisplayWikibaseDescriptions",{}),o=mw.config.get("wgMFContentProviderScriptPath");if(!Object.prototype.hasOwnProperty.call(a,e))throw new Error('"'+e+"\" isn't a feature that shows Wikibase descriptions.");return(t=Array.prototype.slice.call(arguments,1)).unshift({prop:[]}),t.push(mw.config.get("wgMFSearchAPIParams")),(n=i.extend.apply({},t)).prop=n.prop.concat(mw.config.get("wgMFQueryPropModules")),a[e]&&-1===n.prop.indexOf("description")&&n.prop.push("description"),o&&(n.origin="*"),s(n)}},"./src/mobile.startup/icons.js":function(e,t,n){var i=n("./src/mobile.startup/Icon.js"),s=n("./src/mobile.startup/util.js");e.exports={CANCEL_GLYPH:"overlay-close",Icon:i,cancel:function(e){var t=e?"overlay-close-"+e:"overlay-close";return new this.Icon({tagName:"button",name:t,additionalClassNames:"cancel",label:mw.msg("mobile-frontend-overlay-close")})},spinner:function(e){return e=e||{},new this.Icon(s.extend(e,{name:"spinner",label:mw.msg("mobile-frontend-loading-message"),additionalClassNames:"spinner loading"}))},watchIcon:function(){return new this.Icon({name:"watch",additionalClassNames:"watch-this-article"})},watchedIcon:function(){return new this.Icon({name:"watched",additionalClassNames:"watch-this-article watched"})}}},"./src/mobile.startup/languageOverlay/getDeviceLanguage.js":function(e,t){e.exports=function(e){var t=e.languages?e.languages[0]:e.language||e.userLanguage||e.browserLanguage||e.systemLanguage;return t?t.toLowerCase():void 0}},"./src/mobile.startup/languageOverlay/languageOverlay.js":function(e,t,n){var i=n("./src/mobile.startup/moduleLoaderSingleton.js"),s=n("./src/mobile.startup/languageOverlay/getDeviceLanguage.js"),a=n("./src/mobile.startup/Overlay.js"),o=n("./src/mobile.startup/promisedView.js");function r(e){return mw.loader.using("mobile.languages.structured").then(function(){return e.getPageLanguages(mw.config.get("wgPageName"),mw.config.get("wgUserLanguage"))}).then(function(e){return new(i.require("mobile.languages.structured/LanguageSearcher"))({languages:e.languages,variants:e.variants,deviceLanguage:s(navigator)})})}function l(e){return a.make({heading:mw.msg("mobile-frontend-language-heading"),className:"overlay language-overlay"},o(r(e)))}l.test={loadLanguageSearcher:r},e.exports=l},"./src/mobile.startup/lazyImages/lazyImageLoader.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s="lazy-image-placeholder";e.exports={queryPlaceholders:function(e){return Array.prototype.slice.call(e.getElementsByClassName(s))},loadImages:function(t){return i.Promise.all(t.map(function(t){return e.exports.loadImage(t).promise}))},loadImage:function(e){var t=i.Deferred(),n=e.dataset.width||"0",s=e.dataset.height||"0",a=new Image(parseInt(n,10),parseInt(s,10));return a.className=e.dataset.class||"",a.alt=e.dataset.alt||"",a.style.cssText=e.style.cssText||"",a.addEventListener("load",function(){a.classList.add("image-lazy-loaded"),e.parentNode&&e.parentNode.replaceChild(a,e),t.resolve("load")},{once:!0}),a.addEventListener("error",function(){t.resolve("error")},{once:!0}),a.src=e.dataset.src||"",a.srcset=e.dataset.srcset||"",{promise:t,image:a}},test:{placeholderClass:s}}},"./src/mobile.startup/lazyReferencesLoader.js":function(e,t,n){var i=n("./src/mobile.startup/lazyImages/lazyImageLoader.js"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.startup/Page.js"),o=s.Deferred,r=n("./src/mobile.startup/icons.js").spinner();function l(e){var t,n=a.HEADING_SELECTOR,i=e.parent(),s=e.prevAll(n).eq(0);return s.length&&(t=s.find(".mw-headline").attr("id"))?t:i.length?l(i):null}e.exports={loadReferences:function(e,t,n,s){var a,c;if(!t.expanded&&t.isReferenceSection)return(a=t.$heading.next()).data("are-references-loaded")?o().reject().promise():(a.children().addClass("hidden"),c=r.$el.prependTo(a),n.getReferencesLists(t.page).then(function(){var i;a.find(".mf-lazy-references-placeholder").each(function(){var e=0,s=a.find(this),o=l(s);i!==o?(e=0,i=o):e++,o&&n.getReferencesList(t.page,o).then(function(t){t&&t[e]&&s.replaceWith(t[e])})}),c.remove(),a.children().removeClass("hidden"),e.emit("references-loaded",s),u()},function(){c.remove(),a.children().removeClass("hidden"),u()}));function u(){i.loadImages(i.queryPlaceholders(a[0])),a.data("are-references-loaded",1)}},test:{getSectionId:l}}},"./src/mobile.startup/loadingOverlay.js":function(e,t,n){var i=n("./src/mobile.startup/icons.js"),s=n("./src/mobile.startup/Overlay.js");e.exports=function(){var e=new s({className:"overlay overlay-loading",noHeader:!0});return i.spinner().$el.appendTo(e.$el.find(".overlay-content")),e}},"./src/mobile.startup/mfExtend.js":function(e,t){e.exports=function(e,t,n){var i;for(i in n?OO.inheritClass(e,t):(OO.initClass(e),n=t),n)e.prototype[i]=n[i]}},"./src/mobile.startup/moduleLoader.js":function(e,t){function n(){this._register={}}n.prototype={require:function(e){var t,n,i=this._register;function s(){if(!Object.hasOwnProperty.call(i,e))throw new Error("MobileFrontend Module not found: "+e);return i[e]}n=e.split("/");try{return(t=mw.loader.require(n[0]))[n[1]]?t[n[1]]:s()}catch(e){return s()}},define:function(e,t){var n=this;if(Object.hasOwnProperty.call(this._register,e))throw new Error("Module already exists: "+e);return this._register[e]=t,{deprecate:function(i){n.deprecate(i,t,e)}}},deprecate:function(e,t,n){var i;n&&(i="Use "+n+" instead."),mw.log.deprecate(this._register,e,t,i)}},e.exports=n},"./src/mobile.startup/moduleLoaderSingleton.js":function(e,t,n){var i=n("./src/mobile.startup/moduleLoader.js");e.exports=new i},"./src/mobile.startup/promisedView.js":function(e,t,n){var i=n("./src/mobile.startup/icons.js"),s=n("./src/mobile.startup/View.js");e.exports=function(e){var t=new s({className:"promised-view"});return t.$el.append(i.spinner().$el),e.then(function(e){t.$el.replaceWith(e.$el),t.$el=e.$el}),t}},"./src/mobile.startup/references/ReferencesDrawer.js":function(e,t,n){var i=n("./src/mobile.startup/Drawer.js"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.startup/icons.js"),o=n("./src/mobile.startup/mfExtend.js"),r=n("./src/mobile.startup/references/ReferencesGateway.js"),l=n("./src/mobile.startup/Icon.js");function c(e){i.call(this,s.extend({className:"drawer position-fixed text references",events:{"click sup a":"showNestedReference"}},e))}o(c,i,{defaults:s.extend({},i.prototype.defaults,{spinner:a.spinner().toHtmlString(),cancelButton:a.cancel("gray").toHtmlString(),citation:new l({isSmall:!0,name:"citation",additionalClassNames:"text",hasText:!0,label:mw.msg("mobile-frontend-references-citation")}).toHtmlString(),errorClassName:new l({name:"error",hasText:!0,isSmall:!0}).getClassName()}),show:function(){return i.prototype.show.apply(this,arguments)},template:mw.template.get("mobile.startup","ReferencesDrawer.hogan"),closeOnScroll:!1,postRender:function(){var e=s.getWindow().height();i.prototype.postRender.apply(this),e/2<400&&this.$el.css("max-height",e/2),this.on("show",this.onShow.bind(this)),this.on("hide",this.onHide.bind(this))},onShow:function(){s.getDocument().find("body").addClass("drawer-enabled")},onHide:function(){s.getDocument().find("body").removeClass("drawer-enabled")},showReference:function(e,t,n){var i=this,s=this.options.gateway;return this.options.page=t,i.show(),s.getReference(e,t).then(function(e){i.render({title:n,text:e.text})},function(e){e===r.ERROR_NOT_EXIST?i.hide():i.render({error:!0,title:n,text:mw.msg("mobile-frontend-references-citation-error")})})},showNestedReference:function(e){var t=this.$el.find(e.target);return this.showReference(t.attr("href"),this.options.page,t.text()),!1}}),e.exports=c},"./src/mobile.startup/references/ReferencesGateway.js":function(e,t){function n(e){this.api=e}n.prototype.getReference=null,n.ERROR_NOT_EXIST="NOT_EXIST_ERROR",n.ERROR_OTHER="OTHER_ERROR",e.exports=n},"./src/mobile.startup/references/ReferencesHtmlScraperGateway.js":function(e,t,n){var i=n("./src/mobile.startup/references/ReferencesGateway.js"),s=n("./src/mobile.startup/mfExtend.js"),a=n("./src/mobile.startup/util.js");function o(){i.apply(this,arguments)}s(o,i,{getReferenceFromContainer:function(e,t){var n,s=a.Deferred();return(n=t.find("#"+a.escapeSelector(e.substr(1)))).length?s.resolve({text:n.html()}):s.reject(i.ERROR_NOT_EXIST),s.promise()},getReference:function(e,t){return this.getReferenceFromContainer(decodeURIComponent(e),t.$el.find("ol.references"))}}),e.exports=o},"./src/mobile.startup/references/ReferencesMobileViewGateway.js":function(e,t,n){var i=n("./src/mobile.startup/references/ReferencesHtmlScraperGateway.js"),s=n("./src/mobile.startup/cache.js"),a=n("./src/mobile.startup/references/ReferencesGateway.js"),o=s.MemoryCache,r=n("./src/mobile.startup/util.js"),l=n("./src/mobile.startup/mfExtend.js"),c=s.NoCache,u=null;function d(e,t){i.call(this,e),this.cache=t||new c}l(d,i,{getReferencesLists:function(e){var t=this,n=r.Deferred(),i=this.cache.get(e.id);return i?n.resolve(i).promise():(this.api.get({action:"mobileview",page:e.getTitle(),sections:"references",prop:"text",revision:e.getRevisionId()}).then(function(i){var s={};i.mobileview.sections.forEach(function(e){var t=r.parseHTML("<div>").html(e.text);s[t.find(".mw-headline").attr("id")]=t.find(".references")}),t.cache.set(e.id,s),n.resolve(s)},function(){n.reject(a.ERROR_OTHER)}),n.promise())},getReferencesList:function(e,t){return this.getReferencesLists(e).then(function(e){return!!Object.prototype.hasOwnProperty.call(e,t)&&e[t]})},getReference:function(e,t){var n=this;return this.getReferencesLists(t).then(function(t){var i=r.parseHTML("<div>");return Object.keys(t).forEach(function(e){i.append(t[e])}),n.getReferenceFromContainer(e,i)})}}),d.getSingleton=function(){return u||(u=new d(new mw.Api,new o)),u},e.exports=d},"./src/mobile.startup/rlModuleLoader.js":function(e,t,n){var i=n("./src/mobile.startup/loadingOverlay.js"),s=n("./src/mobile.startup/util.js");e.exports={newLoadingOverlay:function(){return i()},loadModule:function(e,t,n){var i=this.newLoadingOverlay();function a(){!t&&n&&i.hide()}return(n=void 0===n||n)&&(i.appendTo(document.body),i.show()),mw.loader.using(e).then(function(){return a(),i},function(){return a(),s.Deferred().reject().promise()})}}},"./src/mobile.startup/search/MobileWebSearchLogger.js":function(e,t){function n(){this.userSessionToken=null,this.searchSessionToken=null}n.prototype={_newUserSession:function(){this.userSessionToken=mw.user.generateRandomSessionId()},_newSearchSession:function(){this.searchSessionToken=mw.user.generateRandomSessionId(),this.searchSessionCreatedAt=(new Date).getTime()},onSearchShow:function(){this._newUserSession()},onSearchStart:function(){this._newSearchSession(),mw.track("mf.schemaMobileWebSearch",{action:"session-start",userSessionToken:this.userSessionToken,searchSessionToken:this.searchSessionToken,timeOffsetSinceStart:0})},onSearchResults:function(e){var t=(new Date).getTime()-this.searchSessionCreatedAt;mw.track("mf.schemaMobileWebSearch",{action:"impression-results",resultSetType:"prefix",numberOfResults:e.results.length,userSessionToken:this.userSessionToken,searchSessionToken:this.searchSessionToken,timeToDisplayResults:t,timeOffsetSinceStart:t})},onSearchResultClick:function(e){var t=(new Date).getTime()-this.searchSessionCreatedAt;mw.track("mf.schemaMobileWebSearch",{action:"click-result",clickIndex:e.resultIndex+1,userSessionToken:this.userSessionToken,searchSessionToken:this.searchSessionToken,timeOffsetSinceStart:t})}},n.register=function(e){var t=new n;e.on("search-show",t.onSearchShow.bind(t)),e.on("search-start",t.onSearchStart.bind(t)),e.on("search-results",t.onSearchResults.bind(t)),e.on("search-result-click",t.onSearchResultClick.bind(t))},e.exports=n},"./src/mobile.startup/search/SearchGateway.js":function(e,t,n){var i=n("./src/mobile.startup/Page.js"),s=n("./src/mobile.startup/util.js"),a=n("./src/mobile.startup/extendSearchParams.js");function o(e){this.api=e,this.searchCache={},this.generator=mw.config.get("wgMFSearchGenerator")}o.prototype={searchNamespace:0,getApiData:function(e){var t=this.generator.prefix,n=a("search",{generator:this.generator.name});return n.redirects="",n["g"+t+"search"]=e,n["g"+t+"namespace"]=this.searchNamespace,n["g"+t+"limit"]=15,n.pilimit&&(n.pilimit=15,n.pithumbsize=mw.config.get("wgMFThumbnailSizes").tiny),n},_createSearchRegEx:function(e){return e=e.replace(/[-\[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),new RegExp("^("+e+")","ig")},_highlightSearchTerm:function(e,t){return e=s.parseHTML("<span>").text(e).html(),t=s.parseHTML("<span>").text(t).html(),e.replace(this._createSearchRegEx(t),"<strong>$1</strong>")},_getPage:function(e,t){var n=i.newFromJSON(t);return n.displayTitle=this._highlightSearchTerm(t.displaytext?t.displaytext:n.title,e),n.index=t.index,n},_processData:function(e,t){var n=this,i=[];return t.query&&(i=t.query.pages||{},(i=Object.keys(i).map(function(t){return n._getPage(e,i[t])})).sort(function(e,t){return e.index<t.index?-1:1})),i},search:function(e){var t,n,i=this;return this.isCached(e)||(n=(t=this.api.get(this.getApiData(e))).then(function(t){return{query:e,results:i._processData(e,t)}},function(){i.searchCache[e]=void 0}),this.searchCache[e]=n.promise({abort:function(){t.abort()}})),this.searchCache[e]},isCached:function(e){return Boolean(this.searchCache[e])}},e.exports=o},"./src/mobile.startup/talk/overlay.js":function(e,t,n){var i=n("./src/mobile.startup/moduleLoaderSingleton.js"),s=n("./src/mobile.startup/promisedView.js"),a=n("./src/mobile.startup/Anchor.js"),o=n("./src/mobile.startup/util.js"),r=n("./src/mobile.startup/Overlay.js");e.exports=function(e,t){var n=mw.user;return r.make({heading:"<strong>"+mw.msg("mobile-frontend-talk-overlay-header")+"</strong>",headerButtonsListClassName:"header-action",headerButtons:[n.isAnon()?{}:{href:"#/talk/new",className:"continue",msg:mw.msg("mobile-frontend-talk-add-overlay-submit")}],footerAnchor:new a({progressive:!0,href:mw.util.getUrl(e),additionalClassNames:"footer-link talk-fullpage",label:mw.msg("mobile-frontend-talk-fullpage")}).options,className:"talk-overlay overlay"},s(o.Promise.all([t.getSections(e),mw.loader.using("mobile.talk.overlays")]).then(function(e){return i.require("mobile.talk.overlays/talkBoard")(e)})))}},"./src/mobile.startup/time.js":function(e,t,n){var i=["seconds","minutes","hours","days","months","years"],s=n("./src/mobile.startup/util.js"),a=[1,60,3600,86400,2592e3,31536e3];function o(e){for(var t=0;t<a.length&&e>a[t+1];)++t;return{value:Math.round(e/a[t]),unit:i[t]}}function r(e){return o(Math.round((new Date).getTime()/1e3)-e)}function l(e){return"seconds"===e.unit&&e.value<10}e.exports={getLastModifiedMessage:function(e,t,n,i){var a,o,c=[];return n=n||"unknown",l(a=r(e))?c.push("mobile-frontend-last-modified-with-user-just-now",n,t):c.push({seconds:"mobile-frontend-last-modified-with-user-seconds",minutes:"mobile-frontend-last-modified-with-user-minutes",hours:"mobile-frontend-last-modified-with-user-hours",days:"mobile-frontend-last-modified-with-user-days",months:"mobile-frontend-last-modified-with-user-months",years:"mobile-frontend-last-modified-with-user-years"}[a.unit],n,t,mw.language.convertNumber(a.value)),c.push(i||"#",mw.language.convertNumber(t?1:0),t?mw.util.getUrl("User:"+t):""),o=mw.message.apply(this,c).parse(),i?o:s.parseHTML("<div>").html(o).text()},getRegistrationMessage:function(e,t){var n,i=[];return t=t||"unknown",l(n=r(parseInt(e,10)))?i.push("mobile-frontend-joined-just-now",t):i.push({seconds:"mobile-frontend-joined-seconds",minutes:"mobile-frontend-joined-minutes",hours:"mobile-frontend-joined-hours",days:"mobile-frontend-joined-days",months:"mobile-frontend-joined-months",years:"mobile-frontend-joined-years"}[n.unit],t,mw.language.convertNumber(n.value)),mw.message.apply(this,i).parse()},timeAgo:o,getTimeAgoDelta:r,isNow:l,isRecent:function(e){return["seconds","minutes","hours"].indexOf(e.unit)>-1}}},"./src/mobile.startup/toast.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s="mobileFrontend/toast";function a(){mw.requestIdleCallback(this._showPending.bind(this))}a.prototype.show=function(e,t){"string"==typeof t&&(mw.log.warn("The use of the cssClass parameter of Toast.show is deprecated, please convert it to an options object."),t={type:t}),t=i.extend({tag:"toast"},t),this.notification=mw.notify(e,t)},a.prototype.hide=function(){void 0!==this.notification&&this.notification.then(function(e){e.close()})},a.prototype.showOnPageReload=function(e,t){mw.storage.get(s)?mw.log.warn("A pending toast message already exits. The page should have been reloaded by now."):mw.storage.set(s,JSON.stringify({content:e,options:t}))},a.prototype._showPending=function(){var e=mw.storage.get(s);e&&(e=JSON.parse(e),this.show(e.content,e.options),mw.storage.remove(s))},e.exports=new a},"./src/mobile.startup/util.js":function(e,t){e.exports={Promise:{all:function(e){return $.when.apply($,e)}},escapeSelector:function(e){return $.escapeSelector(e)},grep:function(){return $.grep.apply($,arguments)},docReady:function(e){return $(e)},Deferred:function(){return $.Deferred()},getDocument:function(){return $(document.documentElement)},getWindow:function(){return $(window)},parseHTML:function(e,t){return t=t||document,$($.parseHTML(e,t))},isNumeric:function(){return $.isNumeric.apply($,arguments)},extend:function(){return $.extend.apply($,arguments)},escapeHash:function(e){return e.replace(/(:|\.)/g,"\\$1")},isModifiedEvent:function(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey},repeatEvent:function(e,t,n,i){return e.on(n,function(e){return t.emit(n,e)},i)}}},"./src/mobile.startup/watchstar/Watchstar.js":function(e,t,n){var i=n("./src/mobile.startup/View.js"),s=n("./src/mobile.startup/watchstar/WatchstarGateway.js"),a=n("./src/mobile.startup/icons.js"),o=n("./src/mobile.startup/util.js"),r=n("./src/mobile.startup/mfExtend.js"),l=n("./src/mobile.startup/toast.js"),c=n("./src/mobile.startup/CtaDrawer.js");function u(e){i.call(this,o.extend({className:a.watchIcon().getClassName(),events:{click:"onStatusToggle"}},e))}r(u,i,{defaults:{page:void 0,funnel:"unknown"},ctaDrawerOptions:{content:mw.msg("mobile-frontend-watchlist-cta"),queryParams:{warning:"mobile-frontend-watchlist-purpose",campaign:"mobile_watchPageActionCta",returntoquery:"article_action=watch"},signupQueryParams:{warning:"mobile-frontend-watchlist-signup-action"}},initialize:function(e){var t=i.prototype.initialize;this._watched=e.isWatched,this.gateway=new s(e.api),t.call(this,e)},preRender:function(){this.options.tooltip=this._watched?mw.msg("unwatchthispage"):mw.msg("watchthispage")},postRender:function(){var e=a.watchIcon().getGlyphClassName(),t=a.watchedIcon().getGlyphClassName()+" watched";this.$el.text(this.options.tooltip),!mw.user.isAnon()&&this._watched?this.$el.addClass(t).removeClass(e):this.$el.addClass(e).removeClass(t),this.$el.removeClass("hidden")},onStatusToggleAnon:function(){this.drawer||(this.drawer=new c(this.ctaDrawerOptions)),this.drawer.show()},onStatusToggleUser:function(){var e,t=this,n=this.gateway,i=this.options.page,s=!this._watched;function a(){clearInterval(e)}e=setInterval(function(){l.show(mw.msg("mobile-frontend-watchlist-please-wait"))},1e3),n.postStatusesByTitle([i.getTitle()],s).then(function(){a(),t._watched=s,s?(t.render(),t.emit("watch"),l.show(mw.msg("mobile-frontend-watchlist-add",i.title))):(t.emit("unwatch"),t.render(),l.show(mw.msg("mobile-frontend-watchlist-removed",i.title)))},function(){a(),l.show(mw.msg("mobile-frontend-watchlist-error"),{type:"error"})})},onStatusToggle:function(e){e.preventDefault(),mw.user.isAnon()?this.onStatusToggleAnon.apply(this,arguments):this.onStatusToggleUser.apply(this,arguments)}}),e.exports=u},"./src/mobile.startup/watchstar/WatchstarGateway.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s=n("./src/mobile.startup/actionParams.js");function a(e){this.api=e}a.prototype={getStatuses:function(e,t){return i.Promise.all([this.getStatusesByID(e),this.getStatusesByTitle(t)]).then(function(){return i.extend.apply(i,arguments)})},getStatusesByID:function(e){var t=this;return e.length?this.api.get({formatversion:2,action:"query",prop:"info",inprop:"watched",pageids:e}).then(function(e){return t._unmarshalGetResponse(e)}):i.Deferred().resolve({})},getStatusesByTitle:function(e){var t=this;return e.length?this.api.get(s({prop:"info",inprop:"watched",titles:e})).then(function(e){return t._unmarshalGetResponse(e)}):i.Deferred().resolve({})},postStatusesByTitle:function(e,t){var n={action:"watch",titles:e};return t||(n.unwatch=!t),this.api.postWithToken("watch",n)},_unmarshalGetResponse:function(e){return(e&&e.query&&e.query.pages||[]).reduce(function(e,t){return e[t.title]=t.watched,e},{})}},e.exports=a},"./src/mobile.startup/watchstar/WatchstarPageList.js":function(e,t,n){var i=n("./src/mobile.startup/PageList.js"),s=n("./src/mobile.startup/watchstar/Watchstar.js"),a=mw.user,o=n("./src/mobile.startup/util.js"),r=n("./src/mobile.startup/Page.js"),l=n("./src/mobile.startup/mfExtend.js"),c=n("./src/mobile.startup/watchstar/WatchstarGateway.js");function u(e){this.wsGateway=new c(e.api),i.apply(this,arguments)}l(u,i,{postRender:function(){var e,t,n=this,s=[],a=[];return i.prototype.postRender.apply(this),e=this.queryUnitializedItems(),t=this.parsePagesFromItems(e),Object.keys(t).forEach(function(e){var n=t[e];n&&"0"!==n?s.push(n):a.push(e)}),this.getPages(s,a).then(function(t){n.renderItems(e,t)})},queryUnitializedItems:function(){return this.$el.find("li:not(.with-watchstar)")},getPages:function(e,t){return a.isAnon()?o.Deferred().resolve({}):this.wsGateway.getStatuses(e,t)},parsePagesFromItems:function(e){var t=this,n={};return e.each(function(e,i){var s=t.$el.find(i);n[s.attr("title")]=s.data("id")}),n},renderItems:function(e,t){var n=this;a.isAnon()||e.each(function(e,i){var s=n.$el.find(i),a=new r({sections:[],title:s.attr("title"),id:s.data("id")}),o=n.parseHTML("<div>").appendTo(s),l=t[a.getTitle()];n._appendWatchstar(o,a,l),s.addClass("with-watchstar")})},_appendWatchstar:function(e,t,n){var i=new s({api:this.options.api,funnel:this.options.funnel,isAnon:a.isAnon(),isWatched:n,page:t,el:e});return o.repeatEvent(i,this,"watch"),o.repeatEvent(i,this,"unwatch"),i}}),e.exports=u},"./src/mobile.talk.overlays/TalkSectionAddOverlay.js":function(e,t,n){var i=n("./src/mobile.startup/mfExtend.js"),s=n("./src/mobile.startup/Overlay.js"),a=n("./src/mobile.startup/PageGateway.js"),o=n("./src/mobile.startup/util.js"),r=n("./src/mobile.talk.overlays/autosign.js"),l=n("./src/mobile.startup/toast.js"),c=n("./src/mobile.startup/Icon.js");function u(e){this.editorApi=e.api,this.pageGateway=new a(e.api),s.call(this,o.extend(e,{className:"talk-overlay overlay",events:{"input .wikitext-editor, .summary":"onTextInput","change .wikitext-editor, .summary":"onTextInput","click .confirm-save":"onSaveClick"}})),this.title=e.title,this.currentPageTitle=e.currentPageTitle,this.eventBus=e.eventBus,this._saveHit=!1}i(u,s,{defaults:o.extend({},s.prototype.defaults,{cancelMsg:mw.msg("mobile-frontend-editor-cancel"),topicTitlePlaceHolder:mw.msg("mobile-frontend-talk-add-overlay-subject-placeholder"),topicContentPlaceHolder:mw.msg("mobile-frontend-talk-add-overlay-content-placeholder"),editingMsg:mw.msg("mobile-frontend-talk-add-overlay-submit"),waitMsg:mw.msg("mobile-frontend-talk-topic-wait"),waitIcon:new c({name:"spinner",additionalClassNames:"savespinner loading"}).toHtmlString()}),template:mw.template.get("mobile.talk.overlays","SectionAddOverlay.hogan"),templatePartials:o.extend({},s.prototype.templatePartials,{contentHeader:mw.template.get("mobile.talk.overlays","SectionAddOverlay/contentHeader.hogan"),saveHeader:mw.template.get("mobile.editor.overlay","saveHeader.hogan")}),postRender:function(){s.prototype.postRender.call(this),this.showHidden(".initial-header"),this.$confirm=this.$el.find("button.confirm-save"),this.$subject=this.$el.find(".summary"),this.$ta=this.$el.find(".wikitext-editor")},hide:function(){var e,t=mw.msg("mobile-frontend-editor-cancel-confirm");return e=!this.$subject.val()&&!this.$ta.val(),!!(this._saveHit||e||window.confirm(t))&&s.prototype.hide.apply(this,arguments)},onTextInput:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout(function(){e.$ta.val().trim()&&e.$subject.val().trim()?e.$confirm.prop("disabled",!1):e.$confirm.prop("disabled",!0)},250)},onSaveClick:function(){var e=this,t=e.title===e.currentPageTitle;this.showHidden(".saving-header"),this.save().then(function(n){"ok"===n&&(t?e.eventBus.emit("talk-added-wo-overlay"):(e.pageGateway.invalidatePage(e.title),l.show(mw.msg("mobile-frontend-talk-topic-feedback")),e.eventBus.emit("talk-discussion-added"),e.hide()))},function(t){var n=mw.msg("mobile-frontend-talk-topic-error");switch(e.$confirm.prop("disabled",!1),t.details){case"protectedpage":n=mw.msg("mobile-frontend-talk-topic-error-protected");break;case"noedit":case"blocked":n=mw.msg("mobile-frontend-talk-topic-error-permission");break;case"spamdetected":n=mw.msg("mobile-frontend-talk-topic-error-spam");break;case"badtoken":n=mw.msg("mobile-frontend-talk-topic-error-badtoken");break;default:n=mw.msg("mobile-frontend-talk-topic-error")}l.show(n,{type:"error"}),e.showHidden(".save-header, .save-panel")})},save:function(){var e=this.$subject.val(),t=o.Deferred(),n=this.$ta.val();return this.$ta.removeClass("error"),this.$subject.removeClass("error"),this._saveHit=!0,this.$el.find(".content").empty().addClass("loading"),this.editorApi.postWithToken("csrf",{action:"edit",section:"new",sectiontitle:e,title:this.title,summary:mw.msg("newsectionsummary",e),text:r(n)}).then(function(){return"ok"},function(e){return t.reject({type:"error",details:e})})}}),e.exports=u},"./src/mobile.talk.overlays/TalkSectionOverlay.js":function(e,t,n){var i=mw.user,s=n("./src/mobile.startup/mfExtend.js"),a=n("./src/mobile.startup/PageGateway.js"),o=n("./src/mobile.startup/Overlay.js"),r=n("./src/mobile.startup/util.js"),l=n("./src/mobile.startup/toast.js"),c=n("./src/mobile.talk.overlays/autosign.js"),u=n("./src/mobile.startup/Page.js"),d=n("./src/mobile.startup/Button.js");function h(e){this.editorApi=e.api,this.pageGateway=new a(e.api),o.call(this,r.extend(e,{className:"talk-overlay overlay",events:{"focus textarea":"onFocusTextarea","click .save-button":"onSaveClick"}}))}s(h,o,{templatePartials:r.extend({},o.prototype.templatePartials,{header:mw.template.get("mobile.talk.overlays","Section/header.hogan"),content:mw.template.get("mobile.talk.overlays","Section/content.hogan")}),defaults:r.extend({},o.prototype.defaults,{saveButton:new d({block:!0,additionalClassNames:"save-button",progressive:!0,label:mw.msg("mobile-frontend-editor-save")}).options,title:void 0,section:void 0,reply:mw.msg("mobile-frontend-talk-reply"),info:mw.msg("mobile-frontend-talk-reply-info")}),postRender:function(){o.prototype.postRender.apply(this),this.$saveButton=this.$el.find(".save-button"),this.options.section?(this.hideSpinner(),this._enableComments()):this.renderFromApi(this.options)},_enableComments:function(){this.$commentBox=this.$el.find(".comment"),i.isAnon()?this.$commentBox.remove():this.$textarea=this.$commentBox.find("textarea")},renderFromApi:function(e){var t=this;this.pageGateway.getPage(e.title).then(function(n){var i=new u(n);e.section=i.getSection(e.id),t.render(e),t.hideSpinner()})},onFocusTextarea:function(){this.$textarea.removeClass("error")},onSaveClick:function(){var e=this.$textarea.val(),t=this;function n(){t.$saveButton.prop("disabled",!1)}e?(this.showSpinner(),this.$saveButton.prop("disabled",!0),e="\n\n"+c(e),this.editorApi.postWithToken("csrf",{action:"edit",title:this.options.title,section:this.options.id,appendtext:e,redirect:!0}).then(function(){l.show(mw.msg("mobile-frontend-talk-reply-success")),t.pageGateway.invalidatePage(t.options.title),t.renderFromApi(t.options),n()},function(e,i){var s;s=i.error&&["readonly","blocked","autoblocked"].indexOf(i.error.code)>-1?i.error.info:mw.msg("mobile-frontend-editor-error"),t.hideSpinner(),l.show(s,"toast error"),n()})):this.$textarea.addClass("error")}}),e.exports=h},"./src/mobile.talk.overlays/autosign.js":function(e,t){e.exports=function(e){return/~{3,5}/.test(e)?e:e+" ~~~~"}},"./src/mobile.talk.overlays/talkBoard.js":function(e,t,n){var i=n("./src/mobile.startup/util.js"),s=n("./src/mobile.startup/View.js");e.exports=function(e){var t,n=e.length>0?mw.msg("mobile-frontend-talk-explained"):mw.msg("mobile-frontend-talk-explained-empty");return(t=new s({className:"talk-board"})).append([i.parseHTML('<p class="content-header">').text(n),i.parseHTML('<ul class="topic-title-list">').append(e.map(function(e){return i.parseHTML("<li>").append(i.parseHTML("<a>").attr("href","#/talk/"+e.id).text(e.line))}))]),t}},"./tests/node-qunit/mobile.categories.overlays/CategoryGateway.test.js":function(e,t,n){(function(e){var t,i,s,a=n("./tests/node-qunit/utils/jQuery.js"),o=n("./tests/node-qunit/utils/dom.js"),r=n("./tests/node-qunit/utils/mw.js"),l=n("./tests/node-qunit/utils/oo.js"),c=n("sinon");QUnit.module("MobileFrontend CategoryGateway.js",{beforeEach:function(){s=c.sandbox.create(),o.setUp(s,e),a.setUp(s,e),l.setUp(s,e),r.setUp(s,e),t=n("./src/mobile.startup/util.js"),i=n("./src/mobile.categories.overlays/CategoryGateway.js"),this.getSpy={get:s.stub().returns(t.Deferred().resolve({batchcomplete:!0,query:{pages:[{pageid:5,ns:0,title:"HelloWorld",categories:[{ns:14,title:"Category:Hello"}]}]}}))},this.postSpy={postWithToken:s.stub().returns(t.Deferred().resolve())}},afterEach:function(){a.tearDown(),s.restore()}}),QUnit.test("getCategories()",function(e){var t,n=this,s=new i(this.getSpy);return t=s.getCategories("HelloWorld"),e.notStrictEqual(t,!1,"result should not return false"),t.then(function(){e.strictEqual(s.canContinue,!1,"gateway should not continue"),e.ok(n.getSpy.get.calledWith({action:"query",prop:"categories",titles:"HelloWorld",clprop:"hidden",cllimit:50,formatversion:2}),"invalid data passed to get api request")})}),QUnit.test("save()",function(e){var t=this;return new i(this.postSpy).save("HelloWorld","[[Category:World]]").then(function(){e.ok(t.postSpy.postWithToken.calledWith("csrf",{action:"edit",title:"HelloWorld",appendtext:"[[Category:World]]",summary:mw.msg("mobile-frontend-categories-summary")}),"invalid data passed to post api request")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.editor.overlay/EditorGateway.test.js":function(e,t,n){(function(e){var t,i,s,a,o,r,l,c,u,d,h,p,g,m,f,w,b,v,y,k,E=n("./src/mobile.startup/util.js"),j={type:"image",mime:"image/png",id:"1852528679",url:"/w/index.php?title=Especial:Captcha/image&wpCaptchaId=1852528679"},q={error:{code:"readonly",info:"The wiki is currently in read-only mode.",readonlyreason:"This wiki is currently being upgraded to a newer software version."}},x=n("./tests/node-qunit/utils/jQuery.js"),S=n("./tests/node-qunit/utils/dom.js"),C=n("sinon"),T=n("./tests/node-qunit/utils/oo.js"),U=n("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend mobile.editor.overlay/EditorGateway",{beforeEach:function(){t=C.sandbox.create(),S.setUp(t,e),x.setUp(t,e),T.setUp(t,e),U.setUp(t,e),i=n("./src/mobile.editor.overlay/EditorGateway.js"),k=E.Deferred().resolve({query:{pages:[{revisions:[{timestamp:"2013-05-15T00:30:26Z",content:"section"}]}],userinfo:{id:0}}}),r=new mw.Api,o=new mw.Api,l=new mw.Api,c=new mw.Api,u=new mw.Api,d=new mw.Api,h=new mw.Api,p=new mw.Api,g=new mw.Api,m=new mw.Api,f=new mw.Api,w=new mw.Api,y=new mw.Api,b=new mw.Api,v=new mw.Api,t.stub(c,"postWithToken").returns(E.Deferred().resolve({edit:{result:"Failure",captcha:j}})),s=t.stub(r,"get").returns(k),t.stub(o,"get").returns(k),t.stub(y,"get").returns(k),t.stub(w,"get").returns(k),t.stub(b,"get").returns(k),t.stub(u,"get").returns(k),t.stub(h,"get").returns(k),t.stub(p,"get").returns(k),t.stub(m,"get").returns(k),t.stub(f,"get").returns(k),t.stub(g,"get").returns(k),t.stub(d,"get").returns(k),t.stub(c,"get").returns(k),t.stub(l,"get").returns(E.Deferred().resolve({error:{code:"rvnosuchsection"}})),t.stub(o,"postWithToken").returns(E.Deferred().resolve({error:{code:"error code"}})),t.stub(y,"postWithToken").returns(E.Deferred().reject()),a=t.stub(r,"postWithToken").returns(E.Deferred().resolve({edit:{result:"Success"}})),t.stub(b,"postWithToken").returns(E.Deferred().resolve({})),t.stub(w,"post").returns(E.Deferred().resolve({parse:{title:"test",text:{"*":"<h1>Heading 1</h1><h2>Heading 2</h2><p>test content</p>"},sections:{}}})),t.stub(v,"post").returns(E.Deferred().resolve({parse:{title:"test",text:{"*":"test content"},sections:{}}})),t.stub(f,"post").returns(E.Deferred().resolve({parse:{title:"test",text:{"*":"test content"},sections:{0:{line:"Testsection"},1:{line:"Testsection2"}}}})),t.stub(m,"postWithToken").onFirstCall().returns(E.Deferred().resolve({edit:{result:"Success"}})),t.stub(d,"postWithToken").returns(E.Deferred().resolve({edit:{code:"abusefilter-warning-usuwanie-tekstu",info:"Hit AbuseFilter: Usuwanie dużej ilości tekstu",warning:"horrible desktop-formatted message",result:"Failure"}})),t.stub(u,"postWithToken").returns(E.Deferred().resolve({edit:{code:"abusefilter-disallow",info:"Scary filter",warning:"horrible desktop-formatted message",result:"Failure"}})),t.stub(h,"postWithToken").returns(E.Deferred().resolve({edit:{code:"abusefilter-something",info:"Scary filter",warning:"horrible desktop-formatted message",result:"Failure"}})),t.stub(p,"postWithToken").returns(E.Deferred().resolve({edit:{code:"testerror",result:"Failure"}})),t.stub(g,"postWithToken").returns(E.Deferred().reject("readonly",q))},afterEach:function(){x.tearDown(),t.restore()}}),QUnit.test("#getContent (no section)",function(e){return new i({api:r,title:"MediaWiki:Test.css"}).getContent().then(function(){e.ok(s.calledWith({action:"query",prop:["revisions","info"],meta:"userinfo",rvprop:["content","timestamp"],titles:"MediaWiki:Test.css",intestactions:"edit",intestactionsdetail:"full",uiprop:"options",formatversion:2}),"rvsection not passed to api request")})}),QUnit.test("#getContent",function(e){var t;return(t=new i({api:r,title:"test",sectionId:1})).getContent().then(function(n){return e.strictEqual(n.text,"section","return section content"),e.strictEqual(n.blockinfo,null),t.getContent()}).then(function(){e.strictEqual(s.callCount,1,"cache content")})}),QUnit.test("#getContent, new page",function(e){return new i({api:r,title:"test",isNewPage:!0}).getContent().then(function(t){e.strictEqual(t.text,"","return empty section"),e.strictEqual(t.blockinfo,void 0),e.notOk(s.called,"don't try to retrieve content using API")})}),QUnit.test("#getContent, missing section",function(e){var t=new i({api:l,title:"test",sectionId:1});e.rejects(t.getContent(),/^rvnosuchsection$/,"return error code")}),QUnit.test("#getBlockInfo",function(e){var t=new i({api:r,title:"test"}),n={blockedby:"Test"},s={revisions:[{}],actions:{edit:[{code:"blocked",data:{blockinfo:n}}]}};e.strictEqual(n,t.getBlockInfo(s))}),QUnit.test("#save, success",function(e){var t=new i({api:r,title:"test",sectionId:1});return t.getContent().then(function(){return t.setContent("section 1"),e.strictEqual(t.hasChanged,!0,"hasChanged is true"),t.save({summary:"summary"})}).then(function(){e.strictEqual(t.hasChanged,!1,"reset hasChanged"),e.ok(a.calledWith("csrf",{action:"edit",title:"test",section:1,text:"section 1",summary:"summary",captchaid:void 0,captchaword:void 0,basetimestamp:"2013-05-15T00:30:26Z",starttimestamp:"2013-05-15T00:30:26Z"}),"save first section")})}),QUnit.test("#save, new page",function(e){var t=new i({api:r,title:"Talk:test",isNewPage:!0});return t.getContent(),t.setContent("section 0"),t.save({summary:"summary"}).then(function(){e.strictEqual(t.hasChanged,!1,"reset hasChanged"),e.ok(a.calledWith("csrf",{action:"edit",title:"Talk:test",text:"section 0",summary:"summary",captchaid:void 0,captchaword:void 0,basetimestamp:void 0,starttimestamp:void 0}),"save lead section")})}),QUnit.test("#save, after #setPrependText",function(e){var t=new i({api:r,title:"test"});return t.setPrependText("abc"),t.save({summary:"summary"}).then(function(){e.strictEqual(t.hasChanged,!1,"reset hasChanged"),e.ok(a.calledWith("csrf",{action:"edit",title:"test",prependtext:"abc",summary:"summary",captchaid:void 0,captchaword:void 0,basetimestamp:void 0,starttimestamp:void 0}),"prepend text")})}),QUnit.test("#save, submit CAPTCHA",function(e){var t=new i({api:r,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1")}).then(function(){return t.save({summary:"summary",captchaId:123,captchaWord:"abc"})}).then(function(){e.strictEqual(t.hasChanged,!1,"reset hasChanged"),e.ok(a.calledWith("csrf",{action:"edit",title:"test",section:1,text:"section 1",summary:"summary",captchaid:123,captchaword:"abc",basetimestamp:"2013-05-15T00:30:26Z",starttimestamp:"2013-05-15T00:30:26Z"}),"save first section")})}),QUnit.test("#save, request failure",function(e){var t=new i({api:y,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"error",details:"http"},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, API failure",function(e){var t=new i({api:o,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"error",details:"error code"},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, CAPTCHA response with image URL",function(e){var t=new i({api:c,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"captcha",details:j},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, AbuseFilter warning",function(e){var t=new i({api:d,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"abusefilter",details:{type:"warning",message:"horrible desktop-formatted message"}},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, AbuseFilter disallow",function(e){var t=new i({api:u,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"abusefilter",details:{type:"disallow",message:"horrible desktop-formatted message"}},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, AbuseFilter other",function(e){var t=new i({api:h,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"abusefilter",details:{type:"other",message:"horrible desktop-formatted message"}},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, extension errors",function(e){var t=new i({api:p,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"error",details:"testerror"},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, read-only error",function(e){var n=new i({api:g,title:"test",sectionId:1}),s=t.spy(),a=t.spy(),o=e.async(),r={type:"readonly",details:{code:"readonly",info:"The wiki is currently in read-only mode.",readonlyreason:"This wiki is currently being upgraded to a newer software version."}};n.getContent().then(function(){return n.setContent("section 1"),n.save()}).then(s,a).then(function(){e.strictEqual(a.calledWith(r),!0),e.strictEqual(s.called,!1,"don't call resolve"),o()})}),QUnit.test("#save, unknown errors",function(e){var t=new i({api:b,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"error",details:"unknown"},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, without changes",function(e){var t=new i({api:r,title:"test",sectionId:1});return t.getContent().then(function(){return t.setContent("section")}).then(function(){return e.strictEqual(t.hasChanged,!1,"hasChanged is false"),t.save({summary:"summary"})}).then(function(){e.ok(r.postWithToken.calledWith("csrf",{action:"edit",title:"test",section:1,text:"section",summary:"summary",captchaid:void 0,captchaword:void 0,basetimestamp:"2013-05-15T00:30:26Z",starttimestamp:"2013-05-15T00:30:26Z"}),"save first section")})}),QUnit.test("#EditorGateway",function(e){var n=new i({api:w,title:"Test",sectionId:1}),s=t.spy();return n.getPreview({text:"test content"}).then(s).then(function(){e.ok(w.post.calledWithMatch({text:"test content"})),e.ok(s.calledWith({line:"",text:"<h1>Heading 1</h1><h2>Heading 2</h2><p>test content</p>"}))})}),QUnit.test("#EditorGateway, check without sectionLine",function(e){return new i({api:v,title:"Test",sectionId:1}).getPreview({text:"test content"}).then(function(t){e.strictEqual(t.line,"","Ok, no section line returned")})}),QUnit.test("#EditorGateway, check with sectionLine",function(e){return new i({api:f,title:"Test",sectionId:1}).getPreview({text:"test content"}).then(function(t){e.strictEqual(t.line,"Testsection","Ok, section line returned")})}),QUnit.test("#save, when token has expired",function(e){var t=new i({api:m,title:"MediaWiki:Test.css"});return t.getContent().then(function(){return t.setContent("section 1"),t.save().then(function(){e.strictEqual(m.postWithToken.callCount,1,"check the spy was called twice")})})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.editor.overlay/EditorOverlay.test.js":function(e,t,n){(function(e){var t,i,s,a,o,r,l,c=n("./tests/node-qunit/utils/jQuery.js"),u=n("sinon"),d=n("./src/mobile.startup/util.js"),h=n("./tests/node-qunit/utils/oo.js"),p=n("./tests/node-qunit/utils/dom.js"),g=n("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend mobile.editor.overlay/EditorOverlay",{beforeEach:function(){t=u.sandbox.create(),p.setUp(t,e),c.setUp(t,e),g.setUp(t,e),h.setUp(t,e),t.stub(mw,"msg").withArgs("mobile-frontend-editor-continue").returns("Continue").withArgs("mobile-frontend-editor-save").returns("Save"),o=n("./src/mobile.editor.overlay/EditorGateway.js"),r=n("./src/mobile.editor.overlay/EditorOverlay.js"),l=n("./src/mobile.editor.overlay/BlockMessage.js"),t.stub(r.prototype,"log").returns(d.Deferred().resolve()),i=t.stub(l.prototype,"initialize"),t.stub(l.prototype,"toggle"),s=t.stub(o.prototype,"getContent"),t.stub(mw.loader,"using").returns({then:function(e){e()}}),t.stub(mw,"confirmCloseWindow").returns({release:function(){}}),t.stub(window,"scrollTo"),t.stub(mw.util,"getUrl").returns("/w/index.php?title=User:Test"),t.stub(mw.config,"get").withArgs("wgMFEditorOptions").returns({skipPreview:!0}).withArgs("wgFormattedNamespaces").returns({2:"User"}),s.returns(d.Deferred().resolve({text:"section 0",user:{id:1,name:"Foo"},block:null,blockedByUser:null})),a=d.Deferred().resolve({text:"previewtest"}),t.stub(o.prototype,"getPreview").returns(a)},afterEach:function(){c.tearDown(),t.restore()}}),QUnit.test("#initialize, blocked user",function(e){var t=d.Deferred().resolve({text:"section 0",userinfo:{options:{gender:"female"}},blockinfo:{blockedby:"Test",blockexpiry:"infinity",blockreason:"Testreason"}});return s.returns(t),new r({title:"test.css"}),t.then(function(){e.ok(i.calledWith({className:"drawer position-fixed",events:{"click .cancel":"onCancel",click:"stopPropagation"},partial:!1,user:{options:{gender:"female"}},creator:{name:"Test",url:"/w/index.php?title=User:Test"},expiry:null,duration:null,reason:"Testreason"}),"There is a drawer notice, that i am blocked from editing")})}),QUnit.test("#initialize, with given page and section",function(e){var t=new r({title:"test",sectionId:0});return e.strictEqual(t.gateway.title,"test"),e.strictEqual(t.gateway.isNewPage,void 0),e.strictEqual(t.gateway.oldId,void 0),e.strictEqual(t.gateway.sectionId,0),s().then(function(){e.strictEqual(t.$content.val(),"section 0","load correct section")})}),QUnit.test("#initialize, without a section",function(e){var t=new r({title:"test.css"});return s().then(function(){e.strictEqual(t.gateway.title,"test.css"),e.strictEqual(t.gateway.isNewPage,void 0),e.strictEqual(t.gateway.oldId,void 0),e.strictEqual(t.gateway.sectionId,void 0)})}),QUnit.test("#preview",function(e){var t=new r({title:"test",sectionId:0});return t.onStageChanges(),a.then(function(){e.strictEqual(t.$preview.text(),"\npreviewtest\n","preview loaded correctly")})}),QUnit.test("#without-preview",function(e){var t=new r({title:"test",sectionId:0});return s().then(function(){e.strictEqual(t.$el.find(".continue").text(),"Save","no preview loaded")})}),QUnit.test("#initialize, as anonymous",function(e){var t=new r({title:"Main_page",isAnon:!0});return s().then(function(){e.ok(t.$anonWarning.length>0,"Editorwarning (IP will be saved) visible."),e.ok(t.$el.find(".anonymous").length>0,"Continue login has a second class.")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.languages.structured/LanguageSearcher.test.js":function(e,t,n){(function(e){var t,i,s=n("./tests/node-qunit/utils/jQuery.js"),a=n("./tests/node-qunit/utils/dom.js"),o=n("./tests/node-qunit/utils/mw.js"),r=n("./tests/node-qunit/utils/oo.js"),l=n("sinon"),c=[{lang:"ar",url:"https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7",title:"باراك أوباما",autonym:"العربية"},{lang:"be",url:"https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:"Барак Абама",autonym:"беларуская"},{lang:"be-x-old",url:"https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:"Барак Абама",autonym:"беларуская (тарашкевіца)"},{lang:"ko",url:"https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88",title:"버락 오바마",autonym:"한국어"},{lang:"ru",url:"https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA",title:"Обама, Барак",autonym:"русский"},{lang:"uz",url:"https://uz.wikipedia.org/wiki/Barak_Obama",title:"Barak Obama",autonym:"oʻzbekcha/ўзбекча"},{lang:"zh",url:"https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC",title:"贝拉克·奥巴马",autonym:"中文"},{lang:"zh-min-nan",url:"https://zh-min-nan.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",langname:"Chinese",autonym:"Bân-lâm-gú"},{lang:"zh-yue",url:"https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC",title:"奧巴馬",autonym:"粵語"},{lang:"zu",url:"https://zu.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",autonym:"isiZulu"}],u=[{lang:"foo",url:"/w/index.php?title=Barack_Obama&variant=foo",autonym:"Foo"},{lang:"foo-x-piglatin",url:"/w/index.php?title=Barack_Obama&variant=foo-x-piglatin",autonym:"Igpay Atinlay"}],d={"zh-min-nan":1,zh:2,en:10,ko:1};function h(e,t){e.$el.find("input[type=search]").val(t).trigger("input")}QUnit.module("MobileFrontend LanguageSearcher.js",{beforeEach:function(){i=l.sandbox.create(),a.setUp(i,e),s.setUp(i,e),r.setUp(i,e),o.setUp(i,e),t=n("./src/mobile.languages.structured/LanguageSearcher.js"),i.stub(mw.storage,"get").withArgs("langMap").returns(JSON.stringify(d)),this.languageSearcher=new t({languages:c,variants:u,deviceLanguage:"en-us"})},afterEach:function(){s.tearDown(),i.restore()}}),QUnit.test("renders output",function(e){e.strictEqual(this.languageSearcher.$el.find(".site-link-list.suggested-languages a").length,5,"There are 5 suggested languages including variants."),e.strictEqual(this.languageSearcher.$el.find(".site-link-list.all-languages a").length,7,"Seven languages are non-suggested.")}),QUnit.test("saves the language count when link is clicked",function(e){var t=i.stub(mw.storage,"set");this.languageSearcher.$el.find("[lang=foo-x-piglatin]").trigger("click"),e.strictEqual(t.callCount,1,"mw.storage.set is called once"),e.deepEqual(t.getCall(0).args,["langMap",'{"zh-min-nan":1,"zh":2,"en":10,"ko":1,"foo-x-piglatin":1}'],"mw.storage.set is called with correct args")}),QUnit.test("without variants, input event filters languages",function(e){var n=new t({languages:c,variants:!1,deviceLanguage:"en-us"});h(n,""),e.strictEqual(n.$el.find(".site-link-list a:not(.hidden)").length,10,"The search filter has been cleared. All 10 languages (including variants) are visible."),h(n,"abcdefghij"),e.strictEqual(n.$el.find(".site-link-list a:not(.hidden)").length,0,'No languages match "abcdefghij"'),h(n,"chin"),e.ok(1===n.$el.find(".site-link-list a:not(.hidden)").length&&n.$el.find(".site-link-list a:not(.hidden)").hasClass("zh-min-nan"),'One language (zh-min-nan) matches "Chin" (langname) and only that language is visible.')}),QUnit.test("with variants, input event filters languages",function(e){h(this.languageSearcher,""),e.strictEqual(this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length,12,"The search filter has been cleared. All 12 languages (including variants) are visible."),h(this.languageSearcher,"abcdefghij"),e.strictEqual(this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length,0,'No languages match "abcdefghij"'),h(this.languageSearcher,"zh"),e.strictEqual(this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length,3,'Three languages match "zh" and only those languages are visible.'),h(this.languageSearcher,"ol"),e.ok(1===this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length&&this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").hasClass("be-x-old"),'One language (be-x-old) matches "ol" and only that language is visible.'),h(this.languageSearcher,"chin"),e.ok(1===this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length&&this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").hasClass("zh-min-nan"),'One language (zh-min-nan) matches "Chin" (langname) and only that language is visible.'),h(this.languageSearcher,"ўз"),e.strictEqual(this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length,1,'One language matches "ўз" and only that language is visible.'),h(this.languageSearcher,"foo"),e.strictEqual(this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length,2,'Two languages match "foo" and only those languages are visible.'),h(this.languageSearcher,"igpay"),e.strictEqual(this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length,1,'One language matches "igpay" and only that language is visible.')})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.languages.structured/util.test.js":function(e,t,n){(function(e){var t,i,s=n("./tests/node-qunit/utils/jQuery.js"),a=n("./tests/node-qunit/utils/dom.js"),o=n("./tests/node-qunit/utils/mw.js"),r=n("sinon");QUnit.module("MobileFrontend mobile.languages.structured/util.test.js",{beforeEach:function(){this.apiLanguages=[{lang:"ar",url:"https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7",title:"باراك أوباما",dir:"rtl",autonym:"العربية"},{lang:"be",url:"https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:"Барак Абама",dir:"ltr",autonym:"беларуская"},{lang:"be-x-old",url:"https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:"Барак Абама",autonym:"беларуская (тарашкевіца)"},{lang:"es",url:"https://en.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",dir:"ltr",autonym:"Spanish"},{lang:"ko",url:"https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88",title:"버락 오바마",dir:"ltr",autonym:"한국어"},{lang:"ru",url:"https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA",title:"Обама, Барак",dir:"ltr",autonym:"русский"},{lang:"uz",url:"https://uz.wikipedia.org/wiki/Barak_Obama",title:"Barak Obama",dir:"ltr",autonym:"oʻzbekcha/ўзбекча"},{lang:"zh",url:"https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC",title:"贝拉克·奥巴马",dir:"ltr",autonym:"中文"},{lang:"zh-min-nan",url:"https://zh-min-nan.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",dir:"ltr",autonym:"Bân-lâm-gú"},{lang:"zh-yue",url:"https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC",title:"奧巴馬",dir:"ltr",autonym:"粵語"},{lang:"zu",url:"https://zu.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",dir:"ltr",autonym:"isiZulu"}],this.apiVariants=[{autonym:"不转换",lang:"zh",url:"/~bmansurov/mediawiki/index.php/3?variant=zh"},{autonym:"简体",lang:"zh-hans",url:"/~bmansurov/mediawiki/index.php/3?variant=zh-hans"}],this.deviceLanguage="en-us",this.frequentlyUsedLanguages={zh:2,ko:1},this.structuredLanguages={all:[{lang:"zh-min-nan",autonym:"Bân-lâm-gú",title:"Barack Obama",dir:"ltr",url:"https://zh-min-nan.wikipedia.org/wiki/Barack_Obama"},{lang:"zu",autonym:"isiZulu",title:"Barack Obama",dir:"ltr",url:"https://zu.wikipedia.org/wiki/Barack_Obama"},{lang:"uz",autonym:"oʻzbekcha/ўзбекча",title:"Barak Obama",dir:"ltr",url:"https://uz.wikipedia.org/wiki/Barak_Obama"},{lang:"es",autonym:"Spanish",title:"Barack Obama",dir:"ltr",url:"https://en.wikipedia.org/wiki/Barack_Obama"},{lang:"be",autonym:"беларуская",title:"Барак Абама",dir:"ltr",url:"https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0"},{lang:"be-x-old",autonym:"беларуская (тарашкевіца)",title:"Барак Абама",dir:"ltr",url:"https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0"},{lang:"ru",autonym:"русский",title:"Обама, Барак",dir:"ltr",url:"https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA"},{lang:"ar",autonym:"العربية",title:"باراك أوباما",dir:"rtl",url:"https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7"},{lang:"zh-yue",autonym:"粵語",title:"奧巴馬",dir:"ltr",url:"https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC"}],suggested:[{frequency:2,lang:"zh",autonym:"中文",title:"贝拉克·奥巴马",dir:"ltr",url:"https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC"},{frequency:1,lang:"ko",autonym:"한국어",title:"버락 오바마",dir:"ltr",url:"https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88"}]},i=r.sandbox.create(),a.setUp(i,e),s.setUp(i,e),o.setUp(i,e),i.stub(mw.storage,"get").withArgs("langMap").returns(JSON.stringify(this.frequentlyUsedLanguages)),t=n("./src/mobile.languages.structured/util.js"),this.saveSpy=i.stub(t,"saveFrequentlyUsedLanguages")},afterEach:function(){s.tearDown(),i.restore()}}),QUnit.test("#getFrequentlyUsedLanguages",function(e){e.propEqual(t.getFrequentlyUsedLanguages(),this.frequentlyUsedLanguages,"Frequently used languages is correct.")}),QUnit.test("#saveLanguageUsageCount",function(e){t.saveLanguageUsageCount("ko",t.getFrequentlyUsedLanguages()),e.ok(this.saveSpy.calledWith({zh:2,ko:2}),"Frequently used language is correctly saved.")}),QUnit.test("#getStructuredLanguages",function(e){var n=t.getStructuredLanguages(this.apiLanguages,!1,this.frequentlyUsedLanguages,this.deviceLanguage);e.propEqual(n,this.structuredLanguages,"Structured languages are correct, including sort order.")}),QUnit.test("#getStructuredLanguages device language",function(e){var n=t.getStructuredLanguages(this.apiLanguages,!1,{},"es-lx").suggested[0].lang;e.strictEqual(n,"es",'"es" is correctly selected as a suggested language even though the device language is "es-lx".')}),QUnit.test("#getStructuredLanguages variants",function(e){var n,i={};n=t.getStructuredLanguages(this.apiLanguages,this.apiVariants,{},this.deviceLanguage).suggested,this.apiVariants.forEach(function(e){i[e.lang]=e}),n.forEach(function(t){e.ok(Object.prototype.hasOwnProperty.call(i,t.lang),'Variant "'+t.lang+'" is in the list of suggested languages.')})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.mediaViewer/ImageGateway.test.js":function(e,t,n){(function(e){var t,i,s,a=n("sinon"),o=n("./tests/node-qunit/utils/dom.js"),r=n("./tests/node-qunit/utils/mw.js"),l=n("./tests/node-qunit/utils/jQuery.js"),c=n("./src/mobile.startup/util.js");QUnit.module("MobileFrontend mobile.mediaViewer/ImageGateway",{beforeEach:function(){t=a.sandbox.create(),o.setUp(t,e),l.setUp(t,e),r.setUp(t,e),i=n("./src/mobile.mediaViewer/ImageGateway.js"),s=i._findSizeBucket},afterEach:function(){l.tearDown(),t.restore()}}),QUnit.test("#findSizeBucket",function(e){e.strictEqual(s(300),320,"value lower than bucket"),e.strictEqual(s(800),800,"exact value"),e.strictEqual(s(9999),2880,"value greater than last bucket")}),QUnit.test("ImageGateway#getThumb (missing page)",function(e){var t;t=new i({api:{get:function(){return c.Deferred().resolve({query:{pages:[{title:"Hello",missing:!0}]}})}}}),e.rejects(t.getThumb("Missing"),function(e){return-1!==e.message.indexOf("The API failed")},"A missing page throws an error which the client must handle")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.mediaViewer/ImageOverlay.test.js":function(e,t,n){(function(e){var t,i,s=n("./src/mobile.startup/util.js"),a=n("./tests/node-qunit/utils/jQuery.js"),o=n("./tests/node-qunit/utils/dom.js"),r=n("./tests/node-qunit/utils/mw.js"),l=n("./tests/node-qunit/utils/oo.js"),c=n("sinon");QUnit.module("MobileFrontend mobile.mediaViewer/ImageOverlay",{beforeEach:function(){t=c.sandbox.create(),o.setUp(t,e),a.setUp(t,e),l.setUp(t,e),r.setUp(t,e),i=n("./src/mobile.mediaViewer/ImageOverlay.js"),this.image={descriptionurl:"https://commons.wikimedia.org/wiki/File:The_Montgomery,_San_Francisco.jpg",thumbheight:1024,thumburl:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/The_Montgomery%2C_San_Francisco.jpg/676px-The_Montgomery%2C_San_Francisco.jpg",thumbwidth:676,url:"https://upload.wikimedia.org/wikipedia/commons/b/b1/The_Montgomery%2C_San_Francisco.jpg"},this.imageGateway={getThumb:function(){return s.Deferred().resolve({query:{pages:[{imageinfo:[this.image]}]}})}},this.router={getPath:function(){return"/media/File%3AA_cursiva.gif"}},this.thumbnails=[{filename:"foo",getFileName:function(){return""},getPath:function(){return""},getDescription:function(){return""}},{filename:"bar",getFileName:function(){return""},getPath:function(){return""},getDescription:function(){return""}}]},afterEach:function(){a.tearDown(),t.restore()}}),QUnit.test("Shows details bar and image with successful api response",function(e){var t=new i({gateway:this.imageGateway,title:decodeURIComponent(this.image.url),caption:"The Montgomery in 2012.",router:this.router,eventBus:{on:function(){}}});return this.imageGateway.getThumb().then(function(){e.strictEqual(t.$el.find("img").length,1,"Image is present."),e.strictEqual(t.$el.find(".load-fail-msg").length,0,"Load error msg is not visible"),e.strictEqual(t.$el.find(".details.is-visible").length,1,"Details bar present")})}),QUnit.test("Shows error message with failed api response",function(e){var t,n={getThumb:function(){return s.Deferred().reject("Load Error")}};return t=new i({gateway:n,title:decodeURIComponent(this.image.url),caption:"The Montgomery in 2012.",router:this.router,eventBus:{on:function(){}}}),n.getThumb().catch(function(){e.strictEqual(t.$el.find(".load-fail-msg").length,1,"Load error msg is visible"),e.strictEqual(t.$el.find(".details.is-visible").length,0,"Details bar is hidden")})}),QUnit.test("Toggling of details is disabled when overlay has load failure",function(e){var t,n={getThumb:function(){return s.Deferred().reject("Load Error")}};return t=new i({gateway:n,title:decodeURIComponent(this.image.url),caption:"The Montgomery in 2012.",thumbnails:this.thumbnails,router:this.router,eventBus:{on:function(){}}}),n.getThumb().catch(function(){e.strictEqual(t.$el.find(".details.is-visible").length,0,"Details bar is hidden"),e.notStrictEqual(t.$el.find(".details"),"none","Slider buttons are shown"),e.notStrictEqual(t.$el.find(".cancel"),"none","Cancel button is still shown"),e.notStrictEqual(t.$el.find(".prev"),"none","Slider buttons are still shown"),t.$el.find(".image-wrapper").trigger("click"),e.notStrictEqual(t.$el.find(".details"),"none","Slider buttons are shown"),e.notStrictEqual(t.$el.find(".cancel"),"none","Cancel button is still shown"),e.notStrictEqual(t.$el.find(".prev"),"none","Slider buttons are still shown")})}),QUnit.test("Toggling of details is enabled when overlay loads successfully",function(e){var t=new i({gateway:this.imageGateway,title:decodeURIComponent(this.image.url),caption:"The Montgomery in 2012.",thumbnails:this.thumbnails,router:this.router,eventBus:{on:function(){}}});return this.imageGateway.getThumb().then(function(){e.strictEqual(t.$el.find(".details.is-visible").length,1,"Details bar is shown"),e.notStrictEqual(t.$el.find(".details").css("display"),"none","Ensure display none rule is not set"),e.notStrictEqual(t.$el.find(".cancel").css("display"),"none","Cancel button is shown"),e.notStrictEqual(t.$el.find(".prev").css("display"),"none","Slider buttons are shown"),t.$el.find(".image-wrapper").trigger("click"),e.strictEqual(t.$el.find(".details").css("display"),"none","Details bar is hidden"),e.strictEqual(t.$el.find(".cancel").css("display"),"none","Cancel button is hidden"),e.strictEqual(t.$el.find(".slider-button").css("display"),"none","Slider buttons are hidden")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.special.nearby.scripts/Nearby.test.js":function(e,t,n){(function(e){var t,i,s,a,o=n("./tests/node-qunit/utils/jQuery.js"),r=n("./tests/node-qunit/utils/dom.js"),l=n("./tests/node-qunit/utils/mw.js"),c=n("./tests/node-qunit/utils/oo.js"),u=n("sinon"),d={get:function(){}};QUnit.module("MobileFrontend Nearby.js",{beforeEach:function(){t=u.sandbox.create(),r.setUp(t,e),o.setUp(t,e),c.setUp(t,e),l.setUp(t,e),a=n("./src/mobile.startup/util.js"),i=n("./src/mobile.special.nearby.scripts/NearbyGateway.js"),s=n("./src/mobile.special.nearby.scripts/Nearby.js")},afterEach:function(){o.tearDown(),t.restore()}}),QUnit.test("refresh() with no results, renders empty list",function(e){var n=a.parseHTML("<div>"),o=t.stub(i.prototype,"getPages").returns(a.Deferred().resolve([])),r={api:d,latitude:37.7,longitude:-122,range:1e3,el:n,eventBus:{emit:function(){}}};return new s(r).refresh(r).then(function(){e.ok(o.calledWithMatch({latitude:37.7,longitude:-122},1e3),"Check API got called"),e.strictEqual(n.find("li").length,0,"0 pages render."),e.strictEqual(n.find(".errorbox").length,1,"Error message shown."),e.strictEqual(n.find(".loading").is(":visible"),!1,"No loader shown.")})}),QUnit.test("refresh() with results, renders with a location",function(e){var n,o=a.parseHTML("<div>"),r={api:d,latitude:37.7,longitude:-122,range:1e3,el:o,eventBus:{emit:function(){}}};return t.stub(d,"get").returns(a.Deferred().resolve({query:{pages:[{pageid:2,watched:!0},{pageid:3,watched:!1},{pageid:4,watched:!1}]}})),n=t.stub(i.prototype,"getPages").returns(a.Deferred().resolve([{title:"Sutro Tower",id:2},{title:"Golden Gate bridge",id:3},{title:"Golden Gate Park",id:4}])),new s(r).refresh(r).then(function(){e.ok(n.calledWithMatch({latitude:37.7,longitude:-122},1e3),"Check API got called"),e.strictEqual(o.find("li").length,3,"3 pages render.")})}),QUnit.test("refresh() with server error, renders error",function(e){var n,o=a.parseHTML("<div>"),r=t.stub(i.prototype,"getPages").returns(a.Deferred().reject()),l={api:d,latitude:37.7,longitude:-122,range:1e3,el:o,eventBus:{emit:function(){}}};return(n=new s(l)).refresh(l).then(function(){e.ok(r.calledWithMatch({latitude:37.7,longitude:-122},1e3),"Check API got called"),e.strictEqual(o.find(".errorbox").length,1,"Check error got rendered"),e.strictEqual(o.find(".errorbox h2").text(),n.errorMessages.http.heading,"Check it is the correct heading")})}),QUnit.test("refresh() getting a title triggers different API method",function(e){var n,o=a.parseHTML("<div>"),r={api:d,pageTitle:"Hello Friends!",range:1e3,el:o,eventBus:{emit:function(){}}};n=t.stub(i.prototype,"getPagesAroundPage").returns(a.Deferred().reject()),new s(r).refresh(r),e.ok(n.calledWithMatch("Hello Friends!",1e3),"Check API got called")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.special.nearby.scripts/NearbyGateway.test.js":function(e,t,n){(function(e){var t,i,s,a=n("./tests/node-qunit/utils/jQuery.js"),o=n("./tests/node-qunit/utils/dom.js"),r=n("./tests/node-qunit/utils/mw.js"),l=n("./tests/node-qunit/utils/oo.js"),c=n("sinon");QUnit.module("MobileFrontend NearbyGateway.js",{beforeEach:function(){var u;t=c.sandbox.create(),o.setUp(t,e),a.setUp(t,e),l.setUp(t,e),r.setUp(t,e),t.stub(mw.config,"get").withArgs("wgArticlePath").returns("/w/").withArgs("wgMFDisplayWikibaseDescriptions",{}).returns({nearby:!0}).withArgs("wgMFMobileFormatterHeadings",["h1","h2","h3","h4","h5"]).returns(["h1","h2","h3","h4","h5"]),s=n("./src/mobile.startup/util.js"),i=n("./src/mobile.special.nearby.scripts/NearbyGateway.js"),u={ajax:function(){}},this.nearbyGateway=new i({api:u}),t.stub(mw.language,"convertNumber",function(e){return"1.20"===e?"1.2":String(e)}),t.stub(u,"ajax",function(){return s.Deferred().resolve({query:{pages:[{pageid:20004112,ns:0,title:"The Montgomery (San Francisco)",thumbnail:{source:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/The_Montgomery%2C_San_Francisco.jpg/119px-The_Montgomery%2C_San_Francisco.jpg",width:119,height:180},pageimage:"The_Montgomery,_San_Francisco.jpg",coordinates:[{lat:37.787,lon:-122.41,primary:"",globe:"earth",dist:120200}]},{pageid:18618509,ns:0,title:"Wikimedia Foundation",thumbnail:{source:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c4/Wikimedia_Foundation_RGB_logo_with_text.svg/180px-Wikimedia_Foundation_RGB_logo_with_text.svg.png",width:180,height:180},pageimage:"Wikimedia_Foundation_RGB_logo_with_text.svg",coordinates:[{lat:37.787,lon:-122.51,primary:"",globe:"earth",dist:0}]},{pageid:9297443,ns:0,title:"W San Francisco",coordinates:[{lat:37.7854,lon:-122.61,primary:"",globe:"earth",dist:177400}]}]}})})},afterEach:function(){a.tearDown(),t.restore()}}),QUnit.test("_distanceMessage()",function(e){var n=this,i="mobile-frontend-nearby-distance",s="mobile-frontend-nearby-distance-meters",a=[[.4834,s,"490"],[.5,s,"500"],[.723,s,"730"],[.999,i,"1"],[1.2,i,"1.2"],[1.588,i,"1.59"],[1.123,i,"1.13"],[2.561,i,"2.6"],[10.8334,i,"10.9"]];t.spy(mw,"msg"),a.forEach(function(t,i){n.nearbyGateway._distanceMessage(t[0]),e.propEqual(mw.msg.getCall(i).args,[t[1],t[2]])})}),QUnit.test("getPages()",function(e){return this.nearbyGateway.getPages({latitude:37.787,longitude:-122.51}).then(function(t){e.strictEqual(t.length,3),e.strictEqual(t[0].title,"Wikimedia Foundation"),e.strictEqual(t[0].thumbnail.isLandscape,!1),e.strictEqual(t[2].title,"W San Francisco"),e.strictEqual(t[2].thumbnail,!1),e.strictEqual(t[2].dist.toPrecision(6),"177.400")})}),QUnit.test("getPagesAroundPage()",function(e){return this.nearbyGateway.getPagesAroundPage("Wikimedia Foundation").then(function(t){e.strictEqual(t.length,2),e.strictEqual(t[1].title,"W San Francisco"),e.strictEqual(t[1].thumbnail,!1),e.strictEqual(t[1].dist.toPrecision(6),"177.400")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.special.uploads.scripts/PhotoListGateway.test.js":function(e,t,n){(function(e){var t,i,s,a=n("sinon"),o=n("./tests/node-qunit/utils/dom.js"),r=n("./tests/node-qunit/utils/jQuery.js");QUnit.module("PhotoListGateway",{beforeEach:function(){i=a.sandbox.create(),o.setUp(i,e),r.setUp(i,e),t=n("./src/mobile.special.uploads.scripts/PhotoListGateway.js"),s=t.test.getDescription},afterEach:function(){r.tearDown(),i.restore()}}),QUnit.test("#getDescription",function(e){[["File:Pirates in SF 2013-04-03 15-44.png","Pirates in SF"],["File:Unpadded 9 pirates in SF 2013-04-03 15-9.png","Unpadded 9 pirates in SF"],["File:Jon lies next to volcano 2013-03-18 13-37.jpeg","Jon lies next to volcano"],["hello world 37.jpg","hello world 37"],["hello world again.jpeg","hello world again"],["Fichier:French Photo Timestamp 2013-04-03 15-44.jpg","French Photo Timestamp"],["Fichier:Full stop. Photo.unknownfileextension","Full stop. Photo"],["File:No file extension but has a . in the title","No file extension but has a . in the title"],["Fichier:French Photo.jpg","French Photo"]].forEach(function(t,n){var i=s(t[0]);e.strictEqual(i,t[1],"test "+n)})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.special.watchlist.scripts/WatchList.test.js":function(e,t,n){(function(e){var t,i,s,a=n("./tests/node-qunit/utils/jQuery.js"),o=n("./tests/node-qunit/utils/dom.js"),r=n("./tests/node-qunit/utils/mw.js"),l=n("./tests/node-qunit/utils/oo.js"),c=n("sinon");QUnit.module("MobileFrontend WatchList.js",{beforeEach:function(){s=c.sandbox.create(),o.setUp(s,e),a.setUp(s,e),l.setUp(s,e),r.setUp(s,e),s.stub(mw.user,"isAnon").returns(!1),t=n("./src/mobile.special.watchlist.scripts/WatchList.js"),i=n("./src/mobile.startup/Icon.js")},afterEach:function(){a.tearDown(),s.restore()}}),QUnit.test("In watched mode",function(e){var n={get:s.stub()},a=new t({eventBus:{on:function(){},off:function(){}},api:n,pages:[{title:"Title 30"},{title:"Title 50"},{title:"Title 60",watched:!0}]}),o=new i({name:"watched"}).getGlyphClassName();a.scrollEndEventEmitter.disable(),e.ok(n.get.notCalled,"Callback avoided"),e.strictEqual(a.$el.find(".watch-this-article").length,3,"3 articles have watch stars..."),e.strictEqual(a.$el.find("."+o).length,3,"...and all are marked as watched.")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.special.watchlist.scripts/WatchListGateway.test.js":function(e,t,n){(function(e){var t,i,s=n("./tests/node-qunit/utils/jQuery.js"),a=n("./tests/node-qunit/utils/dom.js"),o=n("./tests/node-qunit/utils/mw.js"),r=n("./tests/node-qunit/utils/oo.js"),l=n("sinon"),c=n("./src/mobile.startup/util.js"),u={continue:{pageimages:{picontinue:9}},warnings:{query:{"*":"Formatting of continuation data will be changing soon. To continue using the current formatting, use the 'rawcontinue' parameter. To begin using the new format, pass an empty string for 'continue' in the initial query."}},query:{pages:[{pageid:2,ns:0,title:"Burrito",contentmodel:"wikitext",pagelanguage:"en",touched:"2014-12-17T10:06:49Z",lastrevid:552,length:33534},{pageid:3,ns:0,title:"Albert Einstein",contentmodel:"wikitext",pagelanguage:"en",touched:"2014-12-16T17:33:22Z",lastrevid:4,length:19},{pageid:9,ns:0,title:"Anne Dallas Dudley",contentmodel:"wikitext",pagelanguage:"en",touched:"2014-12-17T10:00:13Z",lastrevid:18,length:12663},{pageid:10,ns:0,title:"San Francisco",contentmodel:"wikitext",pagelanguage:"en",touched:"2014-12-17T10:04:55Z",lastrevid:546,length:373791},{pageid:708,ns:0,title:"Functional logic programming",contentmodel:"wikitext",pagelanguage:"en",touched:"2015-01-12T13:04:23Z",lastrevid:1307,length:1392,new:""},{pageid:720,ns:0,title:"Functional programming",contentmodel:"wikitext",pagelanguage:"en",touched:"2015-01-12T13:04:35Z",lastrevid:1319,length:54839,new:""},{ns:0,title:"zzzz",missing:!0,contentmodel:"wikitext",pagelanguage:"en"}]}};QUnit.module("MobileFrontend WatchListGateway.js",{beforeEach:function(){i=l.sandbox.create(),a.setUp(i,e),s.setUp(i,e),r.setUp(i,e),o.setUp(i,e),i.stub(mw.config,"get").withArgs("wgMFDisplayWikibaseDescriptions",{}).returns({watchlist:!0}).withArgs("wgMFMobileFormatterHeadings",["h1","h2","h3","h4","h5"]).returns(["h1","h2","h3","h4","h5"]),i.stub(mw.util,"getUrl",function(){}),t=n("./src/mobile.special.watchlist.scripts/WatchListGateway.js")},afterEach:function(){s.tearDown(),i.restore()}}),QUnit.test("loadWatchlist() loads results from the first page",function(e){var n=new t(new mw.Api);return i.stub(mw.Api.prototype,"get").returns(c.Deferred().resolve(u)),n.loadWatchlist().then(function(t){var n=mw.Api.prototype.get.firstCall.args[0];e.strictEqual(n.continue,"","It should set the continue parameter"),e.strictEqual(t.length,7,"Got all the results"),e.strictEqual(t[0].displayTitle,"Albert Einstein","Sorted alphabetically")})}),QUnit.test("loadWatchlist() loads results from the second page from last item of first",function(e){var n,s=new t(new mw.Api,"Albert Einstein"),a=c.extend({},u,{continue:{watchlistraw:{gwrcontinue:"0|Albert Einstein"}}});return n=i.stub(mw.Api.prototype,"get").returns(c.Deferred().resolve(a)),s.loadWatchlist().then(function(t){var i=mw.Api.prototype.get.firstCall.args[0];return e.strictEqual(i.continue,"gwrcontinue||","It should set the continue parameter"),e.strictEqual(i.gwrcontinue,"0|Albert_Einstein","It should set the watchlistraw-specific continue parameter"),e.strictEqual(t.length,6,"Should have Albert removed from the results"),e.strictEqual(t[0].displayTitle,"Anne Dallas Dudley","First item should be Anne"),n.returns(c.Deferred().resolve(u)),s.loadWatchlist().then(function(t){e.strictEqual(t.length,7,"Albert should be in the results"),e.strictEqual(t[0].displayTitle,"Albert Einstein","First item should be Albert")})})}),QUnit.test("loadWatchlist() doesn't throw an error when no pages are returned",function(e){var n=new t(new mw.Api);return i.stub(mw.Api.prototype,"get").returns(c.Deferred().resolve({batchcomplete:""})),n.loadWatchlist().then(function(t){e.propEqual(t,[])})}),QUnit.test("loadWatchlist() marks pages as new if necessary",function(e){var n=new t(new mw.Api);return i.stub(mw.Api.prototype,"get").returns(c.Deferred().resolve(u)),n.loadWatchlist().then(function(t){e.strictEqual(t[0].isMissing,!1,"Albert Einstein page isn't marked as new"),e.strictEqual(t[6].isMissing,!0,"zzzz page is marked as new")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Browser.test.js":function(e,t,n){(function(e){var t,i,s=n("./src/mobile.startup/Browser.js"),a=n("./tests/node-qunit/utils/dom.js"),o=n("./tests/node-qunit/utils/jQuery.js"),r=n("sinon"),l=n("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend Browser.js",{beforeEach:function(){var n;i=r.sandbox.create(),a.setUp(i,e),o.setUp(i,e),l.setUp(i,e),n=window.document.implementation.createHTMLDocument("Test"),t=$(n)},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("isIos()",function(e){var n=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),i=new s("Mozilla/5.0 (iPad; CPU OS 4_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),a=new s("Mozilla/5.0 (iPad; CPU OS 5_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),o=new s("Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/8.0 Mobile/11A465 Safari/9537.53",t);e.strictEqual(n.isIos(),!0),e.strictEqual(n.isIos(8),!1),e.strictEqual(n.isIos(4),!1),e.strictEqual(n.isIos(5),!1),e.strictEqual(o.isIos(),!0),e.strictEqual(o.isIos(8),!0),e.strictEqual(i.isIos(4),!0),e.strictEqual(a.isIos(5),!0)}),QUnit.test("Methods are cached",function(e){var n=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),i=new s("Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/8.0 Mobile/11A465 Safari/9537.53",t),a=new s("Android 2",t);function o(e,t){return e["__cache"+e[t].cacheId]}e.strictEqual(n.isIos(),!0),e.strictEqual(n.isIos(8),!1),e.strictEqual(a.isIos(8),!1),e.strictEqual(i.isIos(),!0),e.strictEqual(i.isIos(8),!0),e.strictEqual(Object.keys(o(n,"isIos")).length,2,"isIos on ipad cached as expected"),e.strictEqual(Object.keys(o(a,"isIos")).length,1,"isIos on android cached as expected"),e.strictEqual(Object.keys(o(i,"isIos")).length,2,"isIos on iphone cached as expected")}),QUnit.test("lockViewport()",function(e){var n,i=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);i.$el.find("head").append('<meta name="viewport"/>'),i.lockViewport(),n=i.$el.find('meta[name="viewport"]').attr("content"),e.strictEqual(n,"initial-scale=1.0, maximum-scale=1.0, user-scalable=no")}),QUnit.test("isWideScreen()",function(e){var n=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);i.stub(mw.config,"get",function(){return"720px"}),e.strictEqual(n.isWideScreen(),!0)}),QUnit.test("supportsAnimations() - true",function(e){var n,a=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),o=i.stub(document,"createElement",function(){return{style:{animationName:"",transform:"",transition:""}}});n=a.supportsAnimations(),o.restore(),e.strictEqual(n,!0)}),QUnit.test("supportsAnimations() - false",function(e){var n,a=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),o=i.stub(document,"createElement",function(){return{style:{}}});n=a.supportsAnimations(),o.restore(),e.strictEqual(n,!1)}),QUnit.test("supportsTouchEvents()",function(e){var n=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);window.ontouchstart=window.ontouchstart||void 0,e.strictEqual(n.supportsTouchEvents(),!0)}),QUnit.test("supportsGeoLocation()",function(e){var n=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);window.navigator.geolocation=window.navigator.geolocation||void 0,e.strictEqual(n.supportsGeoLocation(),!0)})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Button.test.js":function(e,t,n){(function(e){var t,i,s=n("sinon"),a=n("./tests/node-qunit/utils/dom.js"),o=n("./tests/node-qunit/utils/jQuery.js"),r=n("./tests/node-qunit/utils/oo.js"),l=n("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend Button.js",{beforeEach:function(){i=s.sandbox.create(),a.setUp(i,e),o.setUp(i,e),r.setUp(i,e),l.setUp(i,e),t=n("./src/mobile.startup/Button.js")},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("creates a link if passed href option",function(e){var n=new t({href:"https://www.foo.com"});e.strictEqual(n.$el[0].tagName,"A"),e.strictEqual(n.$el[0].getAttribute("href"),"https://www.foo.com")}),QUnit.test("does not add href attribute when not a link",function(e){var n=new t({tagName:"div"});e.strictEqual(n.$el[0].tagName,"DIV"),e.strictEqual(n.$el[0].href,void 0)})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/CtaDrawer.test.html.js":function(e,t){e.exports={defaultURLs:'\n\t\t<div class=" drawer position-fixed view-border-box ">\n\t\t\t<div\n\t\t\t\tclass=" mw-ui-icon mw-ui-icon-mf-arrow mw-ui-icon-element cancel "\n\t\t\t\ttitle=""\n\t\t\t> </div>\n\t\t\t<p> </p>\n\t\t\t<a href=" logIn " class=" mw-ui-button mw-ui-progressive ">\n\t\t\t\tLog in\n\t\t\t</a>\n\t\t\t<div>\n\t\t\t\t<a href=" signUp " class=" mw-ui-anchor mw-ui-progressive ">\n\t\t\t\t\tSign up\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t',overrideURLs:'\n\t\t<div class=" drawer position-fixed view-border-box ">\n\t\t\t<div\n\t\t\t\tclass=" mw-ui-icon mw-ui-icon-mf-arrow mw-ui-icon-element cancel "\n\t\t\t\ttitle=""\n\t\t\t> </div>\n\t\t\t<p> </p>\n\t\t\t<a href=" customLogIn " class=" mw-ui-button mw-ui-progressive ">\n\t\t\t\tcustom log in\n\t\t\t</a>\n\t\t\t<div>\n\t\t\t\t<a href=" customSignUp " class=" mw-ui-anchor mw-ui-progressive ">\n\t\t\t\t\tcustom sign up\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t'}},"./tests/node-qunit/mobile.startup/CtaDrawer.test.js":function(e,t,n){(function(e){var t,i,s,a,o,r,l=n("./tests/node-qunit/utils/dom.js"),c=n("./tests/node-qunit/utils/jQuery.js"),u=n("./tests/node-qunit/utils/mw.js"),d=n("./tests/node-qunit/utils/oo.js"),h=n("sinon");QUnit.module("MobileFrontend CtaDrawer.js",{beforeEach:function(){o=h.sandbox.create(),l.setUp(o,e),c.setUp(o,e),d.setUp(o,e),u.setUp(o,e),o.stub(e.mw,"msg",function(e){switch(e){case"mobile-frontend-watchlist-cta-button-login":return"Log in";case"mobile-frontend-watchlist-cta-button-signup":return"Sign up"}return e}),o.stub(e.mw.util,"getUrl",function(e,t){return t.type?"signUp":"logIn"}),i=n("./src/mobile.startup/Anchor.js"),s=n("./src/mobile.startup/Button.js"),a=n("./src/mobile.startup/Drawer.js"),t=n("./src/mobile.startup/CtaDrawer.js"),o.stub(a.prototype,"appendToElement","#ctaDrawerParent"),(r=document.createElement("div")).id="ctaDrawerParent",document.documentElement.appendChild(r)},afterEach:function(){document.documentElement.removeChild(r),r=void 0,t=void 0,a=void 0,s=void 0,i=void 0,c.tearDown(),o.restore()}},function(){QUnit.module("redirectParams()",function(){QUnit.test("empty props, default URL",function(n){var i=t.prototype.test.redirectParams;o.stub(e.mw.config,"get",function(){return"pageName"}),n.propEqual(i({}),{returnto:"pageName"})}),QUnit.test("empty props, nondefault URL",function(e){var n=t.prototype.test.redirectParams;e.propEqual(n({},"url"),{returnto:"url"})}),QUnit.test("nonempty props",function(e){var n=t.prototype.test.redirectParams;e.propEqual(n({key:"val"},"url"),{key:"val",returnto:"url"})})}),QUnit.module("signUpParams()",function(){QUnit.test("empty props",function(e){var n=t.prototype.test.signUpParams;e.propEqual(n({}),{type:"signup"})}),QUnit.test("nonempty props",function(e){var n=t.prototype.test.signUpParams;e.propEqual(n({key:"val"}),{key:"val",type:"signup"})})}),QUnit.module("HTML",function(){QUnit.test("defaults",function(e){var i=new t,s=new RegExp(n("./tests/node-qunit/mobile.startup/CtaDrawer.test.html.js").defaultURLs.replace(/\s+/g,"\\s*"));h.assert.match(i.$el.get(0).outerHTML,s),e.ok(!0)}),QUnit.test("overrides",function(e){var a=new t({progressiveButton:new s({progressive:!0,label:"custom log in",href:"customLogIn"}).options,actionAnchor:new i({progressive:!0,label:"custom sign up",href:"customSignUp"}).options}),o=new RegExp(n("./tests/node-qunit/mobile.startup/CtaDrawer.test.html.js").overrideURLs.replace(/\s+/g,"\\s*"));h.assert.match(a.$el.get(0).outerHTML,o),e.ok(!0)})})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Drawer.test.js":function(e,t,n){(function(e){var t,i,s,a=n("./tests/node-qunit/utils/dom.js"),o=n("./tests/node-qunit/utils/jQuery.js"),r=n("./tests/node-qunit/utils/mw.js"),l=n("./tests/node-qunit/utils/oo.js"),c=n("sinon"),u=n("./src/mobile.startup/util.js");function d(e,t){e.on("show",function(){setTimeout(t,e.minHideDelay)})}function h(){c.assert.match(s.className,/^((?!\bdrawer-visible\b).)*$/)}QUnit.module("MobileFrontend Drawer.js",{beforeEach:function(){i=c.sandbox.create(),a.setUp(i,e),o.setUp(i,e),l.setUp(i,e),r.setUp(i,e),t=n("./src/mobile.startup/Drawer.js"),i.stub(t.prototype,"appendToElement","#drawerParent"),(s=document.createElement("div")).id="drawerParent",document.documentElement.appendChild(s)},afterEach:function(){document.documentElement.removeChild(s),s=void 0,t=void 0,o.tearDown(),i.restore()}}),QUnit.test("appends self to parent when DOM is loaded",function(e){var n=e.async(),i=new t;u.docReady(function(){e.strictEqual(i.$el.parent().get(0),s),n()})}),QUnit.test("adds class to parent when DOM is loaded",function(e){var n=e.async();new t,u.docReady(function(){e.strictEqual(s.className,"has-drawer"),n()})}),QUnit.test("consumes clicks",function(e){var n=e.async(),i=new window.Event("click"),s=new t;i.stopPropagation=function(){e.ok(!0),n()},s.$el.get(0).dispatchEvent(i)}),QUnit.test("visible on show()",function(e){var n=e.async(),i=new t;i.on("show",function(){c.assert.match(s.className,/.*\bdrawer-visible\b.*/),e.ok(!0),n()}),i.show()}),QUnit.test("hidden on hide()",function(e){var n=e.async(),i=new t;i.on("hide",function(){h(),e.ok(!0),n()}),i.hide()}),QUnit.test("hidden on click once presented",function(e){var n=e.async(),i=new t;i.on("hide",function(){h(),e.ok(!0),n()}),d(i,function(){s.click()}),i.show()}),QUnit.test("hidden on scroll once presented",function(e){var n=e.async(),i=new t;i.on("hide",function(){h(),e.ok(!0),n()}),d(i,function(){var e=new window.Event("scroll",{bubbles:!0});s.dispatchEvent(e)}),i.show()}),QUnit.test("HTML is valid",function(e){var n=new t;e.strictEqual(n.$el.get(0).outerHTML,'<div class="drawer position-fixed view-border-box"></div>')})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Overlay.test.js":function(e,t,n){(function(e){var t,i,s=n("sinon"),a=n("./tests/node-qunit/utils/jQuery.js"),o=n("./src/mobile.startup/mfExtend.js"),r=n("./tests/node-qunit/utils/dom.js"),l=n("./tests/node-qunit/utils/mw.js"),c=n("./tests/node-qunit/utils/oo.js"),u=n("./src/mobile.startup/util.js"),d=n("./node_modules/hogan.js/lib/hogan.js");QUnit.module("MobileFrontend: Overlay.js",{beforeEach:function(){i=s.sandbox.create(),r.setUp(i,e),a.setUp(i,e),c.setUp(i,e),l.setUp(i,e),t=n("./src/mobile.startup/Overlay.js"),i.stub(e.window,"scrollTo"),u.getDocument().find("#mw-mf-viewport").length||(this.$viewport=u.parseHTML("<div>").attr("id","mw-mf-viewport").appendTo("body"))},afterEach:function(){this.$viewport&&this.$viewport.remove(),a.tearDown(),i.restore()}}),QUnit.test("Simple overlay",function(e){var n;n=new t({heading:"<h2>Overlay Title</h2>"}).$el.find('h2:contains("Overlay Title")'),e.strictEqual(n.length,1)}),QUnit.test("#make",function(e){var n=t.make({heading:"Fresh from factory"},new t({className:"overlay-child",heading:"overlay in overlay"}));e.strictEqual(n.$el.find(".overlay-child").length,1,"there is an overlay in the overlay!"),e.strictEqual(n.$el.find(".overlay-title").eq(0).text().trim(),"Fresh from factory","First heading found"),e.strictEqual(n.$el.find(".overlay-content .overlay-title").text().trim(),"overlay in overlay","Second heading found in overlay-content")}),QUnit.test("HTML overlay",function(e){var n;function i(){t.apply(this,arguments)}o(i,t,{templatePartials:u.extend({},t.prototype.templatePartials,{content:d.compile('<div class="content">YO</div>')})}),n=new i({heading:"Awesome"}),e.strictEqual(n.$el.find("h2").html(),"Awesome"),e.strictEqual(n.$el.find(".content").text(),"YO")}),QUnit.test("Close overlay",function(e){var n=new t({heading:"<h2>Title</h2>",content:"Text"});n.show(),n.hide(),e.strictEqual(n.$el[0].parentNode,null,"No longer in DOM")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/OverlayManager.test.js":function(e,t,n){(function(e){var t,i,s,a,o=n("sinon"),r=n("./tests/node-qunit/utils/dom.js"),l=n("./tests/node-qunit/utils/jQuery.js"),c=n("./tests/node-qunit/utils/oo.js"),u=n("./src/mobile.startup/util.js"),d=n("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend mobile.startup/OverlayManager",{beforeEach:function(){a=o.sandbox.create(),r.setUp(a,e),c.setUp(a,e),l.setUp(a,e),d.setUp(a,e),a.stub(e.window,"scrollTo"),t=n("./src/mobile.startup/OverlayManager.js"),this.createFakeOverlay=function(e){var t=new OO.EventEmitter;return t.hasLoadError=!1,t.show=a.spy(),t.hide=function(){return this.emit("hide"),!0},t.$el=$("div"),a.spy(t,"hide"),u.extend(t,e),t},(i=new OO.EventEmitter).getPath=a.stub().returns(""),i.back=a.spy(),a.stub(mw.loader,"require").withArgs("mediawiki.router").returns(i),s=new t(i,"body")},afterEach:function(){l.tearDown(),a.restore()}}),QUnit.test("#getSingleton",function(e){var n=t.getSingleton();e.ok(n instanceof t,"singleton exists"),e.strictEqual(n,t.getSingleton(),"same object returned each time")}),QUnit.test("#add",function(e){var t=this.createFakeOverlay();s.add(/^test$/,function(){return t}),i.emit("route",{path:"test"}),e.strictEqual(t.show.callCount,1,"show registered overlay")}),QUnit.test("#show",function(e){var t=this.createFakeOverlay(),n=a.spy(s,"_show");s.add(/^showTest$/,function(){return t}),i.emit("route",{path:"showTest"}),e.strictEqual(n.callCount,1,"OverlayManager.show called on route change")}),QUnit.test("#add, with $.Deferred factory",function(e){var t=u.Deferred(),n=this.createFakeOverlay();return t.show=a.spy(),s.add(/^foo$/,function(){return t}),i.emit("route",{path:"foo"}),t.resolve(n),t.then(function(){e.notOk(t.show.called,"don't call show on Deferred"),e.strictEqual(n.show.callCount,1,"show registered overlay")})}),QUnit.test("#add, with current path",function(e){var t=this.createFakeOverlay(),n=u.Deferred();return i.getPath=a.stub().returns("baha"),s.add(/^baha$/,function(){return t}),u.docReady(function(){n.resolve()}),n.then(function(){e.strictEqual(t.show.callCount,1,"show registered overlay")})}),QUnit.test("#replaceCurrent",function(e){var t=this.createFakeOverlay(),n=this.createFakeOverlay();s.add(/^test$/,function(){return t}),i.emit("route",{path:"test"}),s.replaceCurrent(n),e.strictEqual(t.hide.callCount,1,"hide overlay"),e.strictEqual(n.show.callCount,1,"show another overlay"),i.emit("route",{path:""}),e.strictEqual(n.hide.callCount,1,"hide another overlay")}),QUnit.test("route with params",function(e){var t=this.createFakeOverlay(),n=a.stub().returns(t);s.add(/^sam\/(\d+)$/,n),i.emit("route",{path:"sam/123"}),e.ok(n.calledWith("123"),"pass params from the route")}),QUnit.test("hide when route changes",function(e){var t=this.createFakeOverlay(),n=a.stub().returns(t);s.add(/^jon$/,n),i.emit("route",{path:"jon"}),i.emit("route",{path:""}),i.emit("route",{path:"jon"}),i.emit("route",{path:"other"}),e.strictEqual(t.hide.callCount,2,"hide overlay"),e.ok(t.hide.getCall(0).notCalledWith(!0),"don't force hide (first)"),e.ok(t.hide.getCall(1).notCalledWith(!0),"don't force hide (second)")}),QUnit.test("go back (change route) if overlay hidden but not by route change",function(e){var t=this.createFakeOverlay(),n=a.stub().returns(t);s.add(/^joakino$/,n),i.emit("route",{path:"joakino"}),t.hide(),e.strictEqual(i.back.callCount,1,"route back")}),QUnit.test("stacked overlays",function(e){var t=this.createFakeOverlay(),n=a.stub().returns(t),o=this.createFakeOverlay(),r=a.stub().returns(o);s.add(/^parent$/,r),s.add(/^child$/,n),i.emit("route",{path:"parent"}),e.strictEqual(o.show.callCount,1,"show parent"),i.emit("route",{path:"child"}),e.strictEqual(o.hide.callCount,1,"hide parent"),e.ok(o.hide.calledWith(!0),"hide parent forcefully (no confirmation)"),e.strictEqual(t.show.callCount,1,"show child"),i.emit("route",{path:"parent"}),e.strictEqual(t.hide.callCount,1,"hide child"),e.strictEqual(o.show.callCount,2,"show parent again"),e.strictEqual(r.callCount,1,"create parent only once")}),QUnit.test("prevent route change",function(e){var t=this.createFakeOverlay({hide:a.stub().returns(!1)}),n=a.stub().returns(t),o={path:"",preventDefault:a.spy()};s.add(/^rob$/,n),i.emit("route",{path:"rob"}),i.emit("route",o),e.ok(o.preventDefault.calledOnce,"prevent route change")}),QUnit.test("reload failed overlay when navigating to it again from another overlay",function(e){var t,n,o=this.createFakeOverlay(),r=this.createFakeOverlay();o.hasLoadError=!0,(n=a.stub()).onCall(0).returns(o),n.onCall(1).returns(r),t=function(e){return"0"===e?n():r},s.add(/^test\/(\d+)$/,t),i.emit("route",{path:"test/0"}),e.strictEqual(s.stack.length,1,"stack is correct size"),e.ok(s.stack[0].overlay.hasLoadError,"first overlay has load error"),i.emit("route",{path:"test/1"}),e.strictEqual(s.stack.length,2,"stack is correct size"),e.notOk(s.stack[0].overlay.hasLoadError,"second overlay loads successfully"),i.emit("route",{path:"test/0"}),e.strictEqual(s.stack.length,1,"stack decreases when going back to already visited overlay"),e.notOk(s.stack[0].overlay.hasLoadError,"Failed attempt is not cached and new overlay is loaded")}),QUnit.test("replace overlay when route event path is equal to current path",function(e){var t,n=this.createFakeOverlay(),o=this.createFakeOverlay();n.hasLoadError=!0,(t=a.stub()).onCall(0).returns(n),t.onCall(1).returns(o),s.add(/^test\/(\d+)$/,t),i.emit("route",{path:"test/0"}),e.strictEqual(s.stack.length,1,"stack is correct size"),e.ok(s.stack[0].overlay.hasLoadError,"overlay has load error"),i.emit("route",{path:"test/0"}),e.strictEqual(s.stack.length,1,"stack is correct size (did not increase upon reload)"),e.notOk(s.stack[0].overlay.hasLoadError,"overlay retry loads successfully")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Page.test.js":function(e,t,n){(function(e){var t,i,s,a,o,r,l,c=n("./tests/node-qunit/utils/dom.js"),u=n("./tests/node-qunit/utils/jQuery.js"),d=n("./tests/node-qunit/utils/mw.js"),h=n("./tests/node-qunit/utils/oo.js"),p=n("sinon"),g='<div class="mw-parser-output">';QUnit.module("MobileFrontend Page",{beforeEach:function(){var m=function(e){return'<div class="ambox">'+e+"</div>"},f=function(e){return'<h2 class="section-heading">'+e+"</h2>"},w=function(e,t){var n=t||"h3";return"<"+n+">"+e+"</"+n+">"},b=function(e,t){return'<div class="mf-section-'+e+'">'+t+"</div>"};s=p.sandbox.create(),c.setUp(s,e),d.setUp(s,e),u.setUp(s,e),h.setUp(s,e),t=n("./src/mobile.startup/Page.js"),i=n("./src/mobile.startup/util.js"),a=new t({el:i.parseHTML(g).html("<p>lead</p>"+m("a0"))}),o=new t({el:i.parseHTML(g).html(b(0,m("a0")+'<p>lead</p><div class="toc-mobile view-border-box"><h2></h2><div></div></div>')+f("1")+b(1,m("a1")+w("1.1")+m("a1.1")))}),r=new t({el:i.parseHTML(g).html("<p>lead</p>"+m("a0")+w("1","h2")+m("a1")+w("1.1")+m("a1.1"))}),l=new t({el:i.parseHTML(g).html(b(0,"<p>lead</p>"+m("a0"))+f("1")+b(1,m("a1")+w("1.1")+m("a1.1")+w("1.1.1","h4")+m("a1.1.1")+w("1.1.2","h4")+m("a1.1.2")+w("1.2")+m("a1.1"))+f("2")+b(6,m("a2"))+f("3")+b(7,m("a3"))+f("Section with nested Ambox")+b(8,m("<p>nested-ambox-parent,</p>"+m("nested-ambox-1,")+m("nested-ambox-2")))+f("Sub-section with nested Ambox")+b(9,m("<p>nested-ambox-parent,</p>"+m("nested-ambox-1,")+m("nested-ambox-2"))+w("subsection heading")+w("Another subsection heading")))})},afterEach:function(){u.tearDown(),s.restore()}}),QUnit.test("#findInSectionLead",function(e){[[0,"a0","lead section"],[1,"a1","h2"],[2,"a1.1","h3"],[3,"","h4","selector does not match",".foo"],[111,"","Non-existent section"]].forEach(function(t,n){var i=t[0],s=t[1],a=t[2],o=t[3]||".ambox";e.strictEqual(r.findChildInSectionLead(i,o).text(),s,"Found correct text in desktop test "+n+" case: "+a)}),[[0,"a0","lead section"],[3,"","h4","selector does not match",".foo"],[111,"","Non-existent section"]].forEach(function(t){e.strictEqual(a.findChildInSectionLead(t[0],t[3]||".ambox").text(),t[1],"Stub: Found correct text in desktop test case:"+t[2])}),[[0,"a0","lead section"],[1,"a1","h2"],[2,"a1.1","h3"],[3,"a1.1.1","h4"],[3,"","h4","selector does not match",".foo"],[7,"a3","h2 later"],[111,"","Non-existent section"]].forEach(function(t){e.strictEqual(l.findChildInSectionLead(t[0],t[3]||".ambox").text(),t[1],"Mobile: Found correct text in test case:"+t[2])}),[[0,"a0","lead section"],[1,"a1","h2"],[2,"a1.1","h3"],[111,"","Non-existent section"]].forEach(function(t){e.strictEqual(o.findChildInSectionLead(t[0],t[3]||".ambox").text(),t[1],"Mobile with table of contents: Found correct text in test case:"+t[2])}),[[8,".ambox","nested-ambox-parent,nested-ambox-1,nested-ambox-2","Nested elements in section"],[9,".ambox","nested-ambox-parent,nested-ambox-1,nested-ambox-2","Nested elements in subsection"]].forEach(function(t){var n=l.findChildInSectionLead(t[0],t[1]);e.strictEqual(n.not(n.children()).text(),t[2],"Mobile: Found correct text in test case:"+t[3])})}),QUnit.test("#isMainPage",function(e){var n=new t({title:"Main Page",isMainPage:!0}),i=new t({title:"Foo"});e.strictEqual(n.isMainPage(),!0,"check main page flag is updated"),e.strictEqual(i.isMainPage(),!1,"check not marked as main page")}),QUnit.test("#getThumbnails",function(e){var n,s,a,o,r,l,c,u,d,h;n=new t({el:i.parseHTML('<div><a href="/wiki/File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),s=new t({el:i.parseHTML("<div></div>")}),a=new t({el:i.parseHTML('<div><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),o=n.getThumbnails(),r=new t({el:i.parseHTML('<div><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box noviewer"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),l=new t({el:i.parseHTML('<div><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" class="metadata" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),h=new t({el:i.parseHTML('<div class="noviewer"><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),c=new t({el:i.parseHTML('<div><a href="/wiki/File:Design_portal_logo.jpg" class="image"><span class="lazy-image-placeholder" style="width: 28px;height: 28px;" data-src="//upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Design_portal_logo.jpg/28px-Design_portal_logo.jpg" data-alt="icon" data-width="28" data-height="28" data-class="noviewer">&nbsp;</span></a></div>')}),d=new t({el:i.parseHTML('<div><a href="/wiki/File:Design_portal_logo.jpg" class="image"><span class="lazy-image-placeholder" style="width: 28px;height: 28px;" data-src="//upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Design_portal_logo.jpg/28px-Design_portal_logo.jpg" data-alt="icon" data-width="28" data-height="28" data-class="wot noviewerz bar">&nbsp;</span></a></div>')}),u=new t({el:i.parseHTML('<div><table class="plainlinks metadata ambox ambox-content ambox-Unreferenced" role="presentation"><tr><td class="mbox-image"><div style="width:52px"><a href="/wiki/File:Question_book-new.svg" class="image"><span class="lazy-image-placeholder" style="width: 50px;height: 39px;" data-src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/50px-Question_book-new.svg.png" data-alt="" data-width="50" data-height="39" data-srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/75px-Question_book-new.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/100px-Question_book-new.svg.png 2x"> </span></a></div></td></tr></table>')}),e.strictEqual(o.length,1,"Found expected number of thumbnails."),e.strictEqual(o[0].getFileName(),"File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg","Found expected filename."),o=s.getThumbnails(),e.strictEqual(o.length,0,"This page has no thumbnails."),o=a.getThumbnails(),e.strictEqual(o.length,1,"Found expected number of thumbnails."),e.strictEqual(o[0].getFileName(),"File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg","Found expected filename."),o=r.getThumbnails(),e.strictEqual(o.length,0,"This page has no thumbnails."),o=l.getThumbnails(),e.strictEqual(o.length,0,"This page has no thumbnails."),o=h.getThumbnails(),e.strictEqual(o.length,0,"Images inside a container with the class are not included. Images inside tables for example."),o=c.getThumbnails(),e.strictEqual(o.length,0,"Consider whether the class is on an image which has not been lazy loaded."),o=u.getThumbnails(),e.strictEqual(o.length,0,"Consider whether the lazy loaded image is inside a .metadata container."),o=d.getThumbnails(),e.strictEqual(o.length,1,"Thumbnail found if there is a typo.")}),QUnit.test("#getNamespaceId",function(e){[["Main Page",0],["San Francisco",0],["San Francisco: Talk:2",0],["San Francisco: The Sequel",0],["Talk:Foo",1],["Project:Bar",4],["User talk:Jon",3],["Special:Nearby",-1]].forEach(function(n){var i=new t({title:n[0]});e.strictEqual(i.getNamespaceId(),n[1],"Check namespace is as expected")})}),QUnit.test("#isTalkPage",function(e){[["Main Page",!1],["San Francisco",!1],["San Francisco: Talk:2",!1],["San Francisco: The Sequel",!1],["Talk:Foo",!0],["Project talk:Bar",!0],["User talk:Jon",!0],["Special:Nearby",!1]].forEach(function(n){var i=new t({title:n[0]});e.strictEqual(i.isTalkPage(),n[1],"Check test is as expected")})}),QUnit.test("#isMissing",function(e){var n,i;n=[new t({title:"Hello",id:0}),new t({title:"Hello",id:5,isMissing:!0}),new t({title:"Hello",isMissing:!0})],i=[new t({title:"Hello",id:4}),new t({title:"Hello",id:4,isMissing:!1}),new t({title:"Hello",isMissing:!1}),new t({title:"Hello",id:0,isMissing:!1})],n.forEach(function(t,n){e.strictEqual(t.isMissing,!0,"page "+n+" is missing")}),i.forEach(function(t,n){e.strictEqual(t.isMissing,!1,"page "+n+" is not missing")})}),QUnit.test("#allowsXSS",function(e){var n=new t({title:'<script>alert("oops, XSS possible!");<\/script>'});e.strictEqual(n.getDisplayTitle(),"&lt;script&gt;alert(&quot;oops, XSS possible!&quot;);&lt;/script&gt;","Check against XSS in Page.js constructor displaytitle (when title set)"),[{thumbnail:!1,title:'<script>alert("oops, XSS possible!");<\/script>',terms:!1,testDesc:"Check against XSS in Page.newFromJSON displaytitle (when title set)"},{thumbnail:!1,pageprops:[],terms:{label:['<script>alert("oops, XSS possible!");<\/script>']},testDesc:"Check against XSS in Page.newFromJSON displaytitle (when Wikibase label set)"}].forEach(function(i){n=t.newFromJSON(i),e.strictEqual(n.getDisplayTitle(),"&lt;script&gt;alert(&quot;oops, XSS possible!&quot;);&lt;/script&gt;",i.testDesc)})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/PageGateway.test.js":function(e,t,n){(function(e){var t,i,s,a,o=n("sinon"),r=n("./tests/node-qunit/utils/dom.js"),l=n("./tests/node-qunit/utils/mw.js"),c=n("./tests/node-qunit/utils/oo.js"),u=n("./tests/node-qunit/utils/jQuery.js"),d=n("./tests/node-qunit/utils/PageInputs.html.js"),h=d.page,p=d.page2,g=n("./tests/node-qunit/utils/PageGateway.responses.js");QUnit.module("MobileFrontend PageGateway",{beforeEach:function(){a=o.sandbox.create(),r.setUp(a,e),u.setUp(a,e),l.setUp(a,e),c.setUp(a,e),t=n("./src/mobile.startup/util.js"),i=n("./src/mobile.startup/PageGateway.js"),this.api=new mw.Api,s=new i(this.api)},afterEach:function(){u.tearDown(),a.restore()}}),QUnit.test("#getSections (has sections)",function(e){var n=new i;return a.stub(n,"getPage").returns(t.Deferred().resolve({sections:[{line:"1"}]})),n.getSections(n,"Title").then(function(t){e.strictEqual(t.length,1,"1 section is returned")})}),QUnit.test("#getSections (missing titles)",function(e){var n=new i;return a.stub(n,"getPage").returns(t.Deferred().reject("missingtitle")),n.getSections(n,"Title").then(function(t){e.strictEqual(t.length,0,"0 sections are returned")})}),QUnit.test("#getSections (other failures)",function(e){var n=new i;a.stub(n,"getPage").returns(t.Deferred().reject()),e.throws(n.getSections(n,"Title"),"an exception is thrown")}),QUnit.test("#getPage (h1s)",function(e){return a.stub(this.api,"get").returns(t.Deferred().resolve(g.getPageHeadings.input)),s.invalidatePage("Test"),a.stub(mw.util,"getUrl").returns("Test:History"),s.getPage("Test").then(function(t){e.propEqual(t,g.getPageHeadings.output,"return lead and sections test 1")})}),QUnit.test("#getPage",function(e){var n=a.stub(this.api,"get").returns(t.Deferred().resolve(g.getPage.input));return a.stub(mw.util,"getUrl").returns("Test:History"),s.invalidatePage("Test"),s.getPage("Test").then(function(t){return e.propEqual(t,g.getPage.output,"return lead and sections test 2"),s.getPage("Test")}).then(function(){e.strictEqual(n.callCount,1,"cache page")})}),QUnit.test("#getPageLanguages (response)",function(e){return a.stub(this.api,"get").returns(t.Deferred().resolve(g.getPageLanguagesResponse.input)),s.getPageLanguages("Test").then(function(t){e.propEqual(t.languages,g.getPageLanguagesResponse.output.languages,"return augmented language links"),e.propEqual(t.variants,g.getPageLanguagesResponse.output.variants,"return augmented language variant links")})}),QUnit.test("#getPageLanguages (call)",function(e){var n=a.stub(this.api,"get").returns(t.Deferred().reject());a.stub($,"ajax").returns(t.Deferred().resolve()),s.getPageLanguages("Title","fr"),e.ok(n.calledWith(g.getPageLanguagesCall.output))}),QUnit.test("#_getAPIResponseFromHTML",function(e){var n=s._getAPIResponseFromHTML(t.parseHTML(h));e.propEqual(g.getAPIResponseFromHTML.input,n)}),QUnit.test("#getSectionsFromHTML malformed (h2 before h1)",function(e){var n=s.getSectionsFromHTML(t.parseHTML(p));e.propEqual(n,[{line:"A1",level:"2",anchor:"1.0",text:'<h3 id="">A2.1</h3>\n\n',subsections:[{line:"A2.1",level:"3",anchor:"",text:"",subsections:[]}]},{line:"A2.2",level:"2",anchor:"",text:"",subsections:[]},{line:"A2",level:"1",anchor:"",text:'<h2 id="">A2.1</h2>\n\n',subsections:[{line:"A2.1",level:"2",anchor:"",text:"",subsections:[]}]}])}),QUnit.test("#getPage (forwards api errors)",function(e){return a.stub(this.api,"get").returns(t.Deferred().reject("missingtitle")),s.getPage("Err").catch(function(t){e.strictEqual(t,"missingtitle")})}),QUnit.test("#getPage (move protected page)",function(e){var n={edit:["*"],move:["sysop"]};return a.stub(this.api,"get").returns(t.Deferred().resolve({mobileview:{id:-1,displaytitle:"Test",revId:42,lastmodifiedby:{name:"bob",gender:"unknown"},protection:{move:["sysop"]},lastmodified:"2013-10-28T18:49:56Z",languagecount:10,sections:[{id:0,text:""}]}})),s.invalidatePage("Test"),s.getPage("Test").then(function(t){e.propEqual(t.protection,n)})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Panel.test.js":function(e,t,n){(function(e){var t,i,s=n("sinon"),a=n("./tests/node-qunit/utils/dom.js"),o=n("./tests/node-qunit/utils/jQuery.js"),r=n("./tests/node-qunit/utils/mw.js"),l=n("./tests/node-qunit/utils/oo.js");QUnit.module("MobileFrontend Panel.js",{beforeEach:function(){i=s.sandbox.create(),a.setUp(i,e),o.setUp(i,e),l.setUp(i,e),r.setUp(i,e),t=n("./src/mobile.startup/Panel.js")},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("show() when not visible",function(e){var n=e.async(),i=new t;i.on("show",function(){e.ok(i.$el.hasClass("visible"),"Visible class is set"),e.ok(i.$el.hasClass("animated"),"Animated class is set"),n()}),i.show()}),QUnit.test("hide() when visible",function(e){var n=e.async(),i=new t;i.on("hide",function(){e.notOk(i.$el.hasClass("visible","Visible class is removed")),n()}),i.show(),i.hide()}),QUnit.test("isVisible() when visible",function(e){var n=e.async(),i=new t;i.on("show",function(){e.ok(i.isVisible(),"Returns true when visible"),n()}),i.show()}),QUnit.test("isVisible() when not visible",function(e){var n=new t;e.notOk(n.isVisible(),"Returns false when not visible")}),QUnit.test("onCancel()",function(e){var n=e.async(),i=new t;i.on("hide",function(){e.notOk(i.$el.hasClass("visible"),"Removes visible class"),n()}),i.show(),i.onCancel({preventDefault:function(){}})}),QUnit.test("toggle()",function(e){var n=e.async(),i=new t;i.on("show",function(){e.ok(i.isVisible(),"Shows panel when not visible"),i.toggle()}),i.on("hide",function(){e.notOk(i.isVisible(),"Hides panel when visible"),n()}),i.toggle()})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/ScrollEndEventEmitter.test.js":function(e,t,n){(function(e){var t,i,s=n("sinon"),a=n("./tests/node-qunit/utils/oo.js");QUnit.module("MobileFrontend ScrollEndEventEmitter.js",{beforeEach:function(){t=s.sandbox.create(),a.setUp(t,e),i=n("./src/mobile.startup/ScrollEndEventEmitter.js")},afterEach:function(){t.restore()}}),QUnit.test("initializes properly",function(e){var t={on:s.spy()},n=new i(t,500),a=new i(t);e.strictEqual(n.enabled,!0,"Emission is enabled by default"),e.strictEqual(n.threshold,500,"Threshold is saved"),e.strictEqual(a.threshold,100,"Without a threshold we get a default"),e.strictEqual(t.on.withArgs("scroll:throttled",n._scrollHandler).calledOnce,!0,"Scrolling handler is bound")}),QUnit.test("emits scroll end event",function(e){var n={on:function(e,t){this.handler=t},off:function(){}},s=new i(n);t.stub(s,"scrollNearEnd").returns(!0),s.setElement({}),s.on(i.EVENT_SCROLL_END,function(){e.ok(!0,"scroll end event emitted")}),n.handler()}),QUnit.test("doesn't emit when disabled",function(e){var n=t.spy(i.prototype,"emit"),s={on:function(e,t){this.handler=t},off:function(){}},a=new i(s);a.setElement({}),a.disable(),s.handler(),e.strictEqual(n.called,!1,"emit should not be called")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Section.test.js":function(e,t,n){(function(e){var t,i,s=n("sinon"),a=n("./tests/node-qunit/utils/dom.js"),o=n("./tests/node-qunit/utils/jQuery.js"),r=n("./tests/node-qunit/utils/oo.js");QUnit.module("MobileFrontend Section.js",{beforeEach:function(){i=s.sandbox.create(),a.setUp(i,e),o.setUp(i,e),r.setUp(i,e),t=n("./src/mobile.startup/Section.js")},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("initialize with options",function(e){var n=new t({level:"1",line:"Line",text:"Text",hasReferences:!0,id:"ID",anchor:"Anchor"});e.strictEqual(n.line,"Line","line is set"),e.strictEqual(n.text,"Text","text is set"),e.strictEqual(n.hasReferences,!0,"hasReferences is set"),e.strictEqual(n.id,"ID","id is set"),e.strictEqual(n.anchor,"Anchor","anchor is set"),e.strictEqual(n.subsections.length,0,"Subsections are empty")}),QUnit.test("initialize with subsections",function(e){var n=new t({subsections:[{level:"",line:"Line",text:"Text",hasReferences:!0,id:"ID",anchor:"Anchor"}]}),i=n.subsections[0];e.strictEqual(n.subsections.length,1,"Subsection is added to array"),e.ok(i instanceof t,"Subsections are instances of Section"),e.strictEqual(i.line,"Line","line is set"),e.strictEqual(i.text,"Text","text is set"),e.strictEqual(i.hasReferences,!0,"hasReferences is set"),e.strictEqual(i.id,"ID","id is set"),e.strictEqual(i.anchor,"Anchor","anchor is set"),e.strictEqual(i.subsections.length,0,"Subsection children are empty")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Toggler.test.js":function(e,t,n){(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,s,a,o=n("sinon"),r=n("./tests/node-qunit/utils/dom.js"),l=n("./tests/node-qunit/utils/jQuery.js"),c=n("./tests/node-qunit/utils/oo.js"),u=n("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend Toggler.js",{beforeEach:function(){i=o.sandbox.create(),r.setUp(i,e),l.setUp(i,e),c.setUp(i,e),u.setUp(i,e),s=n("./src/mobile.startup/Browser.js").getSingleton(),a=n("./src/mobile.startup/Toggler.js"),i.stub(mw.config,"get").withArgs("wgMFCollapseSectionsByDefault").returns(!0),i.stub(s,"isWideScreen").returns(!1),this.page={title:"Toggle test"},this.$container=$("<div>").html('\n\t\t<h2>\n\t\t<span id="First_Section">First Section</span>\n\t\t</h2>\n\t\t<div>\n\t\t\t<p>Text</p>\n\t\t</div>\n\t\t<h2 id="section_1">\n\t\t\t<a href="#foo">Dummy Link</a>\n\t\t</h2>\n\t\t<div></div>\n\t\t<h2>References</h2>\n\t\t<div data-is-reference-section="1">\n\t\t\t<ol class="references">\n\t\t\t\t<li id="cite_note-1">\n\t\t\t\t\t<span class="mw-cite-backlink">\n\t\t\t\t\t\t<a href="#cite_ref-1">↑</a>\n\t\t\t\t\t</span> <span class="reference-text">hello</span>\n\t\t\t\t</li>\n\t\t\t</ol>\n\t\t</div>\n'),this.$section0=this.$container.find("h2").eq(0),this.title=this.page.title,this.headline=this.$section0.find("span").attr("id")},afterEach:function(){mw.storage.remove("expandSections"),mw.storage.remove("expandedSections"),l.tearDown(),i.restore()}}),QUnit.test("Mobile mode - Toggle section",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),n=this.$section0,i=this.$container.find(".collapsible-block").eq(0);t.toggle(n),e.strictEqual(n.hasClass("open-block"),!0,"open-block class present"),t.toggle(n),e.strictEqual(i.hasClass("open-block"),!1,"check content gets closed on a toggle"),e.strictEqual(n.hasClass("open-block"),!1,"check section is closed"),t.toggle(n),e.strictEqual(i.hasClass("open-block"),!0,"check content reopened"),e.strictEqual(n.hasClass("open-block"),!0,"check section has reopened")}),QUnit.test("Mobile mode - Clicking a hash link to reveal an already open section",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page});t.toggle(this.$section0),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is open"),t.reveal("First_Section",this.$container),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is still open")}),QUnit.test("Mobile mode - Reveal element",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page});t.toggle(this.$section0),t.reveal("First_Section"),e.strictEqual(this.$container.find(".collapsible-block").eq(0).hasClass("open-block"),!0,"check content is visible"),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is open")}),QUnit.test("Mobile mode - Clicking hash links",function(e){new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}).toggle(this.$section0),this.$container.find('[href="#First_Section"]').trigger("click"),e.strictEqual(this.$container.find(".collapsible-block").eq(0).hasClass("open-block"),!0,"check content is visible"),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is open")}),QUnit.test("Mobile mode - Tap event toggles section",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),n=this.$container.find(".collapsible-block").eq(1);t.toggle(this.$section0),e.strictEqual(n.hasClass("open-block"),!1,"check content is hidden at start"),this.$container.find("#section_1").trigger("click"),e.strictEqual(n.hasClass("open-block"),!0,"check content is shown on a toggle")}),QUnit.test("Accessibility - Verify aria attributes",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),n=this.$container.find("#section_1"),i=this.$container.find(".collapsible-block").eq(1);t.toggle(this.$section0),e.strictEqual(i.hasClass("open-block"),!1,"check content is hidden at start"),e.strictEqual(i.attr("aria-pressed"),"false","check aria-pressed is false at start"),e.strictEqual(i.attr("aria-expanded"),"false","check aria-expanded is false at start"),n.trigger("click"),e.strictEqual(i.hasClass("open-block"),!0,"check content is visible after toggling"),e.strictEqual(i.attr("aria-pressed"),"true","check aria-pressed is true after toggling"),e.strictEqual(i.attr("aria-expanded"),"true","check aria-expanded is true after toggling"),n.trigger("click"),e.strictEqual(i.hasClass("open-block"),!1,"check content is hidden after toggling"),e.strictEqual(i.attr("aria-pressed"),"false","check aria-pressed is false after toggling"),e.strictEqual(i.attr("aria-expanded"),"false","check aria-expanded is false after toggling")}),QUnit.test("Tablet mode - Open by default",function(e){s.isWideScreen.returns(!0),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),e.strictEqual(this.$container.find(".collapsible-block").eq(1).hasClass("open-block"),!0,"check section is visible at start"),e.strictEqual(this.$container.find(".collapsible-block").eq(2).hasClass("open-block"),!1,"check reference section is hidden at start")}),QUnit.test("Tablet mode - Open by default 2",function(e){mw.config.get.withArgs("wgMFCollapseSectionsByDefault").returns(!1),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),e.strictEqual(this.$container.find(".collapsible-block").eq(1).hasClass("open-block"),!0,"check section is visible at start")}),QUnit.test("Accessibility - Pressing space/ enter toggles a heading",function(e){var t,n=this.$container.find("#section_1"),i=$.Event("keypress");s.isWideScreen.returns(!1),mw.config.get.withArgs("wgMFCollapseSectionsByDefault").returns(!0),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),t=this.$container.find(".collapsible-block").eq(1),e.strictEqual(t.hasClass("open-block"),!1,"check content is hidden at start"),i.which=32,n.trigger(i),e.strictEqual(t.hasClass("open-block"),!0,"check content is shown after pressing space"),i.which=13,n.trigger(i),e.strictEqual(t.hasClass("open-block"),!1,"check content is hidden after pressing enter")}),QUnit.test("Clicking a link within a heading isn't triggering a toggle",function(e){var t=$("#section_1"),n=$(".collapsible-block").eq(1);new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),e.strictEqual(n.hasClass("open-block"),!1,"check content is hidden at start"),t.find("> a").eq(0).trigger("mouseup"),e.strictEqual(n.hasClass("open-block"),!1,"check content is still being hidden after clicking on the link")}),QUnit.test("Toggling a section stores its state.",function(e){var n,s,o=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),r=this.$container.find("h2"),l=a._getExpandedSections(this.page),c=i.spy(mw.storage,"set");e.strictEqual($.isEmptyObject(l[this.title]),!0,"no user setting about an expanded section exists already"),o.toggle(r),n=JSON.parse(c.getCall(0).args[1]),e.strictEqual(t(n[this.title][this.headline]),"number","the just toggled section state has been saved"),o.toggle(r),s=JSON.parse(c.getCall(1).args[1]),e.strictEqual(s[this.title][this.headline],void 0,"the just toggled section state has been removed")}),QUnit.test("Check for and remove obsolete stored sections.",function(e){var n,s,o,r;(o={})[this.title]={},o[this.title][this.headline]=new Date(1990,1,1).getTime(),i.stub(mw.storage,"get",function(){return JSON.stringify(o)}),n=a._getExpandedSections(this.page),e.strictEqual(t(n[this.title][this.headline]),"number","manually created section state has been saved correctly"),s=i.spy(mw.storage,"set"),a._cleanObsoleteStoredSections(this.page),r=JSON.stringify(["expandedSections",'{"Toggle test":{}}']),e.strictEqual(JSON.stringify(s.getCall(0).args),r,"section, whose store time is manually changed to an older date,has been removed from storage correctly")}),QUnit.test("Expanding already expanded section does not toggle it.",function(e){var n,s,o=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),r=this.$container.find("h2"),l=a._getExpandedSections(this.page);e.strictEqual($.isEmptyObject(l[this.title]),!0,"no expanded sections are stored in localStorage yet"),e.strictEqual(r.hasClass("open-block"),!1,"section does not have open-block class"),n=i.spy(mw.storage,"set"),o.toggle(r),e.strictEqual(r.hasClass("open-block"),!0,"revealed section has open-block class"),l=a._getExpandedSections(this.page),s=JSON.parse(n.getCall(0).args[1]),e.strictEqual(t(s[this.title][this.headline]),"number","manually revealed section state has been correctly saved in localStorage"),a._expandStoredSections(o,this.$container,this.page),e.strictEqual(r.hasClass("open-block"),!0,"already revealed section still has open-block class after expanding sections")}),QUnit.test("MobileFrontend toggle.js - Expand stored sections.",function(e){var n,s=this.$container.find("h2").eq(0),o=a._getExpandedSections(this.page);this.$container.find("h2").addClass("section-heading"),e.strictEqual(s.hasClass("open-block"),!1,"Section is collapsed."),e.strictEqual($.isEmptyObject(o[this.title]),!0,"no user setting about an expanded section exists already"),o[this.title][this.headline]=(new Date).getTime(),i.stub(mw.storage,"get",function(){return JSON.stringify(o)}),n=a._getExpandedSections(this.page),e.strictEqual(t(n[this.title][this.headline]),"number","manually created section state has been saved correctly"),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),o=a._getExpandedSections(this.page),e.strictEqual(t(o[this.title][this.headline]),"number","manually created section state is still active after toggle.init()"),e.strictEqual(s.hasClass("open-block"),!0,"Saved section has been auto expanded.")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/View.test.js":function(e,t,n){(function(e){var t,i,s=n("./node_modules/hogan.js/lib/hogan.js"),a=n("./tests/node-qunit/utils/mw.js"),o=n("./tests/node-qunit/utils/jQuery.js"),r=n("./tests/node-qunit/utils/dom.js"),l=n("./src/mobile.startup/mfExtend.js"),c=n("./src/mobile.startup/util.js"),u=n("./tests/node-qunit/utils/oo.js"),d=n("sinon");QUnit.module("MobileFrontend mobile.startup/View",{beforeEach:function(){i=d.sandbox.create(),r.setUp(i,e),o.setUp(i,e),u.setUp(i,e),a.setUp(i,e),t=n("./src/mobile.startup/View.js")},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("View",function(e){var n=new t({el:"body"});e.ok(n.$el instanceof $,"assign jQuery object to $el"),e.strictEqual(n.$el[0].tagName.toUpperCase(),"BODY","assign proper jQuery object to $el")}),QUnit.test("View, jQuery proxy functions",function(e){var n=new t({el:"body"});["append","prepend","appendTo","prependTo","after","before","insertAfter","insertBefore","remove","detach"].forEach(function(t){var s=i.stub(n.$el,t);n[t]("test",1),e.ok(s.calledWith("test",1)),s.restore()})}),QUnit.test("View#preRender",function(e){var n;function i(){t.apply(this,arguments)}l(i,t,{template:s.compile("<p>{{text}}</p>"),preRender:function(){this.options.text="hello"}}),n=new i,e.strictEqual(n.$el.html(),"<p>hello</p>","manipulate template data")}),QUnit.test("View#postRender",function(e){var n=i.spy();function s(){t.apply(this,arguments)}l(s,t,{postRender:function(){n()}}),new s,e.strictEqual(n.callCount,1,"invoke postRender")}),QUnit.test("View#delegateEvents",function(e){var n;function i(n){t.call(this,c.extend({events:{"click p span":function(t){t.preventDefault(),e.ok(!0,"Span was clicked and handled")},"click p":"onParagraphClick",click:"onClick"}},n))}l(i,t,{template:s.compile("<p><span>test</span></p>"),onParagraphClick:function(t){t.preventDefault(),e.ok(!0,"Paragraph was clicked and handled")},onClick:function(t){t.preventDefault(),e.ok(!0,"View was clicked and handled")}}),(n=new i).appendTo("body"),n.$el.find("span").trigger("click"),n.$el.find("p").trigger("click"),n.$el.trigger("click"),n.undelegateEvents(),n.$el.find("span").trigger("click"),n.$el.find("p").trigger("click"),n.$el.trigger("click")}),QUnit.test("View#render (with isTemplateMode)",function(e){var n,i,a,o=$("<div>");function r(){t.apply(this,arguments)}function c(){t.call(this,{className:"bar"})}l(r,t,{template:s.compile('<p class="foo"><span>{{text}}</span></p>'),isTemplateMode:!0}),l(c,t,{template:s.compile('<p class="foo"><span>test</span></p>')}),a=(n=new r).$el.text(),i=new c,n.render(),i.render(),n.$el.appendTo(o),n.render({text:"hello"}),e.ok(n.$el.hasClass("foo")),e.ok(i.$el.hasClass("bar")),e.strictEqual(a,"","first run, no text defined"),e.strictEqual(n.$el.text(),"hello","second run, text has been defined"),e.strictEqual(n.$el.parent(o).length,1,"A re-rendered view thats attached to the DOM remains attached to the DOM")}),QUnit.test("View#render events (with isTemplateMode)",function(e){var n;function i(e){t.call(this,c.extend({events:{"click span":"onClick"}},e))}l(i,t,{onClick:function(){this.$el.empty().text("hello world")},template:s.compile('<p class="foo"><span>test</span></p>'),isTemplateMode:!0}),(n=new i).$el.find("span").trigger("click"),e.strictEqual(n.$el.text(),"hello world","event was called"),e.strictEqual(n.$el.find("span").length,0,"span disappeared"),(n=new i).render(),n.$el.find("span").trigger("click"),e.strictEqual(n.$el.text(),"hello world","event was called"),e.strictEqual(n.$el.find("span").length,0,"span disappeared")}),QUnit.test("View with className option",function(e){[[new t,"view-border-box","className not defined on a normal View without options and isBorderBox is default"],[new t({}),"view-border-box","className not defined on a normal View with empty options and isBorderBox is default"],[new t({className:"banana"}),"banana view-border-box","option is passed to View (along with default isBorderBox property)"],[new t({isBorderBox:!1}),void 0,"Passing isBorderBox option removes default view-border-box class"],[new t({isBorderBox:!0}),"view-border-box","Passing isBorderBox option as true retains default view-border-box class"]].forEach(function(t){e.strictEqual(t[0].$el.attr("class"),t[1],t[2])})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/cache.test.js":function(e,t,n){var i=new(0,n("./src/mobile.startup/cache.js").MemoryCache);QUnit.module("MobileFrontend cache.js"),QUnit.test("cache set() and get()",function(e){i.set("key","value"),e.strictEqual(i.get("key"),"value")})},"./tests/node-qunit/mobile.startup/context.test.js":function(e,t,n){(function(e){var t,i=n("sinon"),s=n("./tests/node-qunit/utils/mw.js"),a=n("./src/mobile.startup/context.js");QUnit.module("MobileFrontend context.js",{beforeEach:function(){t=i.sandbox.create(),s.setUp(t,e)},afterEach:function(){t.restore()}}),QUnit.test("getMode()",function(e){t.stub(mw.config,"get").withArgs("wgMFMode").returns("stable"),e.strictEqual(a.getMode(),"stable","Value comes straight from config")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/extendSearchParams.test.js":function(e,t,n){(function(e){var t,i,s=n("./tests/node-qunit/utils/jQuery.js"),a=n("./tests/node-qunit/utils/mw.js"),o=n("./tests/node-qunit/utils/dom.js"),r=n("sinon");QUnit.module("MobileFrontend extendSearchParams.js",{beforeEach:function(){t=r.sandbox.create(),a.setUp(t,e),o.setUp(t,e),s.setUp(t,e),t.stub(mw.config,"get").withArgs("wgMFSearchAPIParams").returns({foo:"bar"}).withArgs("wgMFDisplayWikibaseDescriptions").returns({search:!0,nearby:!1}).withArgs("wgMFQueryPropModules").returns(["baz"]),i=n("./src/mobile.startup/extendSearchParams.js")},afterEach:function(){s.tearDown(),t.restore()}}),QUnit.test("it throws if the feature is invalid",function(e){var t=new Error('"foo" isn\'t a feature that shows Wikibase descriptions.');e.throws(function(){i("foo",{})},t)}),QUnit.test("it extends the parameters",function(e){var t=i("search",{qux:"quux",prop:["corge"]});e.propEqual(t,{action:"query",formatversion:2,qux:"quux",foo:"bar",prop:["corge","baz","description"]})}),QUnit.test("it doesn't include Wikibase-specific parameters if the feature is disabled",function(e){var t=i("nearby",{qux:"quux"});e.strictEqual(t.prop.indexOf("description"),-1),e.strictEqual(t.wbptterms,void 0)}),QUnit.test("it adds the MobileFrontend configuration to given terms types",function(e){var t=i("search",{wbptterms:"grault"});e.strictEqual(t.wbptterms,"grault",'The given "wbptterms" is added to the default.')}),QUnit.test("it prioritizes MobileFrontend configuration",function(e){var t=i("search",{foo:"quux"});e.propEqual(t,{action:"query",formatversion:2,foo:"bar",prop:["baz","description"]},'The value of "foo" is overridden by the configuration.')}),QUnit.test("it is variadic",function(e){var t=i("search",{baz:"qux"},{quux:"corge"});e.propEqual(t,{action:"query",formatversion:2,foo:"bar",baz:"qux",quux:"corge",prop:["baz","description"]})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/icons.test.js":function(e,t,n){(function(e){var t,i,s,a=n("sinon"),o=n("./tests/node-qunit/utils/dom.js"),r=n("./tests/node-qunit/utils/jQuery.js"),l=n("./tests/node-qunit/utils/mw.js"),c=n("./tests/node-qunit/utils/oo.js");QUnit.module("MobileFrontend icons.js",{beforeEach:function(){t=a.sandbox.create(),o.setUp(t,e),r.setUp(t,e),c.setUp(t,e),l.setUp(t,e),i=n("./src/mobile.startup/icons.js"),s=t.spy(i,"Icon")},afterEach:function(){t.restore(),r.tearDown()}}),QUnit.test("#cancel()",function(e){i.cancel(),e.propEqual(s.getCall(0).args[0],{tagName:"button",name:i.CANCEL_GLYPH,additionalClassNames:"cancel",label:mw.msg("mobile-frontend-overlay-close")},"Options are passed down")}),QUnit.test("#cancel(variant)",function(e){i.cancel("gray"),e.propEqual(s.getCall(0).args[0],{tagName:"button",name:i.CANCEL_GLYPH+"-gray",additionalClassNames:"cancel",label:mw.msg("mobile-frontend-overlay-close")},"Options are passed down")}),QUnit.test("#spinner()",function(e){i.spinner({foo:"will be passed down",additionalClassNames:"will-be-ignored"}),e.propEqual(s.getCall(0).args[0],{foo:"will be passed down",additionalClassNames:"spinner loading",name:"spinner",label:mw.msg("mobile-frontend-loading-message")},"Options are passed down")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/languageOverlay/getDeviceLanguage.test.js":function(e,t,n){var i,s=n("./src/mobile.startup/languageOverlay/getDeviceLanguage.js"),a=n("sinon");QUnit.module("MobileFrontend getDeviceLanguage",{beforeEach:function(){i=a.sandbox.create()},afterEach:function(){i.restore()}}),QUnit.test("returns language code of device in lowercase",function(e){[[{},void 0],[{languages:["en-US"]},"en-us"],[{language:"en-US"},"en-us"],[{userLanguage:"en-US"},"en-us"],[{browserLanguage:"en-US"},"en-us"],[{systemLanguage:"en-US"},"en-us"]].forEach(function(t){var n=s(t[0]);e.strictEqual(n,t[1],"returns correct code")})})},"./tests/node-qunit/mobile.startup/languageOverlay/languageOverlay.test.js":function(e,t,n){(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,s,a,o="object"!==("undefined"==typeof window?"undefined":t(window)),r=n("./src/mobile.startup/moduleLoaderSingleton.js"),l=n("./src/mobile.startup/util.js"),c=n("./tests/node-qunit/utils/jQuery.js"),u=n("./tests/node-qunit/utils/dom.js"),d=n("./tests/node-qunit/utils/oo.js"),h=n("./tests/node-qunit/utils/mw.js"),p=n("sinon");QUnit.module("MobileFrontend languageOverlay.js",{beforeEach:function(){a=p.sandbox.create(),u.setUp(a,e),c.setUp(a,e),d.setUp(a,e),h.setUp(a,e),s=n("./src/mobile.languages.structured/LanguageSearcher.js"),i=n("./src/mobile.startup/languageOverlay/languageOverlay.js"),a.stub(mw,"msg").withArgs("mobile-frontend-language-heading").returns("").withArgs("mobile-frontend-loading-message").returns("⌛").withArgs("mobile-frontend-languages-structured-overlay-all-languages-header").returns("").withArgs("mobile-frontend-languages-structured-overlay-suggested-languages-header").returns(""),a.stub(mw.loader,"using").withArgs("mobile.languages.structured").returns(l.Deferred().resolve()),o&&(e.navigator=e.navigator||void 0,a.stub(e,"navigator",{})),a.stub(r,"require").withArgs("mobile.languages.structured/LanguageSearcher").returns(s)},afterEach:function(){c.tearDown(),a.restore()}}),QUnit.test("#constructor",function(e){var t=l.Deferred().resolve({languages:[],variants:[]}),n={getPageLanguages:function(){return t}},s=i(n);return e.strictEqual(s.$el.find(".overlay-content > .promised-view").text(),"⌛","loading view rendered in .overlay-content"),i.test.loadLanguageSearcher(n).then(function(){e.strictEqual(s.$el.find(".overlay-content > .promised-view").length,0,"promisedView has fulfilled its promise"),e.strictEqual(s.$el.find(".overlay-content > .language-searcher").length,1,"loaded view rendered in .overlay-content")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/lazyImages/lazyImageLoader.test.js":function(e,t,n){(function(e){var t,i=n("./tests/node-qunit/utils/jQuery.js"),s=n("./tests/node-qunit/utils/dom.js"),a=n("./src/mobile.startup/lazyImages/lazyImageLoader.js"),o=n("./tests/node-qunit/utils/mw.js"),r=n("sinon");QUnit.module("MobileFrontend lazyImageLoader.js",{beforeEach:function(){t=r.sandbox.create(),s.setUp(t,e),i.setUp(t,e),o.setUp(t,e)},afterEach:function(){i.tearDown(),t.restore()}},function(){QUnit.test("#queryPlaceholders() empty",function(e){var t=document.createElement("div"),n=a.queryPlaceholders(t);e.propEqual(n,[],"The result is empty.")}),QUnit.test("#queryPlaceholders() nonempty",function(e){var t,n=document.createElement("div"),i=document.createElement("div");i.className=a.test.placeholderClass,n.appendChild(i),t=a.queryPlaceholders(n),e.propEqual(t,[i],"The result is nonempty.")}),QUnit.test("#loadImage() copy attributes",function(e){var t,n={width:"1",height:"2",class:"class",alt:"alt",src:"/src",srcset:"/srcset"},i=document.createElement("div");i.className=a.test.placeholderClass,i.style.width="3px",Object.keys(n).forEach(function(e){i.setAttribute("data-"+e,n[e])}),t=a.loadImage(i),Object.keys(n).forEach(function(i){e.strictEqual(t.image.getAttribute(i),n[i],i+" is set.")}),e.strictEqual(t.image.style.width,"3px","Style from placeholder is set.")}),QUnit.test("#loadImage() loaded",function(e){var t,n=document.createElement("div");return(t=a.loadImage(n)).image.dispatchEvent(new Event("load")),t.promise.then(function(t){e.strictEqual(t,"load","Promise resolves on load.")})}),QUnit.test("#loadImage() load error",function(e){var t,n=document.createElement("div");return(t=a.loadImage(n)).image.dispatchEvent(new Event("error")),t.promise.then(function(t){e.strictEqual(t,"error","Promise resolves even on error.")})}),QUnit.test("#loadImages() empty",function(e){return a.loadImages([]).then(function(){e.ok(!0,"Promise resolves.")})}),QUnit.test("#loadImages() nonempty",function(n){var i,s=document.createElement("div"),o=new Image;return t.stub(e,"Image").returns(o),i=a.loadImages([s]).then(function(){n.ok(!0,"Promise resolves.")}),o.dispatchEvent(new Event("load")),i}),QUnit.test("#loadImages() plural",function(n){var i,s=document.createElement("div"),o=new Image;return t.stub(e,"Image").returns(o),i=a.loadImages([s,s]).then(function(){n.ok(!0,"Promise resolves.")}),o.dispatchEvent(new Event("load")),i}),QUnit.test("#loadImages() one fails to load, one succeeds",function(n){var i,s=document.createElement("div"),o=new Image,r=new Image;return t.stub(e,"Image").onFirstCall().returns(o).onSecondCall().returns(r),i=a.loadImages([s,s]).then(function(){n.ok(!0,"Promise resolves.")}),o.dispatchEvent(new Event("error")),r.dispatchEvent(new Event("load")),i})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/lazyReferencesLoader.test.js":function(e,t,n){(function(e){var t,i,s,a=n("./tests/node-qunit/utils/PageInputs.html.js"),o=n("./tests/node-qunit/utils/jQuery.js"),r=n("./tests/node-qunit/utils/dom.js"),l=n("./tests/node-qunit/utils/mw.js"),c=n("./tests/node-qunit/utils/oo.js"),u=n("sinon"),d=n("./src/mobile.startup/util.js");QUnit.module("MobileFrontend lazyReferencesLoader.js",{beforeEach:function(){i=u.sandbox.create(),r.setUp(i,e),o.setUp(i,e),c.setUp(i,e),l.setUp(i,e),s=n("./src/mobile.startup/Page.js"),t=n("./src/mobile.startup/lazyReferencesLoader.js")},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("#lazyReferencesLoader collapsed",function(e){var n=d.parseHTML("<div>").append(a.skinPage),o={getReferencesLists:function(){},getReferencesList:function(){}},r=new s({title:"Foo"});return i.stub(o,"getReferencesLists").returns(d.Deferred().resolve({})),i.stub(o,"getReferencesList").withArgs(r,"Notes_and_references").returns(d.Deferred().resolve(d.parseHTML("<p>").text("P"))).withArgs(r,"Notes").returns(d.Deferred().resolve(d.parseHTML("<p>").text("A"))).withArgs(r,"Refs").returns(d.Deferred().resolve(d.parseHTML("<p>").text("B"))).withArgs(r,"More_refs").returns(d.Deferred().resolve(d.parseHTML("<p>").html("<p>E</p><p>F</p>").children())),t.loadReferences({on:function(){},off:function(){},emit:function(){}},{expanded:!1,page:r,isReferenceSection:!0,$heading:n.find("#Notes_and_references").parent()},o,r).then(function(){e.strictEqual(n.find(".mf-section-2").text().replace(/[\t\n]/g,""),"TextPNotesARefsBno forgetMore refs1E2F3","Check all the references section is populated correctly.")})}),QUnit.test("#lazyReferencesLoader expanded",function(e){var n,i=d.parseHTML("<div>").append(a.skinPage),o=new s({title:"Foo"});n=t.loadReferences({on:function(){},off:function(){},emit:function(){}},{expanded:!0,page:o,isReferenceSection:!0,$heading:i.find("#Notes_and_references").parent()},{getReferencesLists:function(){},getReferencesList:function(){}},o),e.strictEqual(n,void 0)}),QUnit.test("#getSectionId",function(e){var n=d.parseHTML(["<div>",'<h2><span class="mw-headline" id="heading">H</span></h2>',"<div>",'<h3><span class="mw-headline" id="subheading">Subh</span></h3>','<a class="element"></a>',"</div>","</div>"].join("")),i=d.parseHTML(["<div>",'<h2><span class="mw-headline" id="Notes_and_references">Notes and references</span></h2>',"<div>",'<h3 class="in-block"><span class="mw-headline" id="Notes">Notes</span></h3>','<div class="reflist"><a class="element"></a></div>',"</div>","</div>"].join("")),s=d.parseHTML(['<div id="mw-content-text">','<h2><span class="mw-headline" id="heading">Heading</span></h2>','<div><a class="element"></a></div>',"</div>"].join("")),a=d.parseHTML(['<div id="mw-content-text">','<div><a class="element"></a></div>'].join("")),o=d.parseHTML(['<div id="mw-content-text">','<h2><span class="mw-headline" id="Foo">Foo</span></h2>',"<div>","<p>Foo content.</p>","</div>",'<h2><span class="mw-headline" id="Bar">Bar</span></h2>','<div class="reflist"><a class="element"></a></div>',"</div>","</div>"].join(""));e.strictEqual(t.test.getSectionId(n.find(".element")),"subheading"),e.strictEqual(t.test.getSectionId(i.find(".element")),"Notes","https://phabricator.wikimedia.org/T146394"),e.strictEqual(t.test.getSectionId(s.find(".element")),"heading"),e.strictEqual(t.test.getSectionId(a.find(".element")),null),e.strictEqual(t.test.getSectionId(o.find(".element")),"Bar")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/mfExtend.test.js":function(e,t,n){(function(e){var t,i,s=n("sinon"),a=n("./tests/node-qunit/utils/oo.js");QUnit.module("MobileFrontend mfExtend.test.js",{beforeEach:function(){i=s.sandbox.create(),a.setUp(i,e),t=n("./src/mobile.startup/mfExtend.js")},afterEach:function(){i.restore()}}),QUnit.test("mfExtend() - extending from constructor",function(e){function n(){}function i(){}t(n,i,{}),e.strictEqual(n.prototype instanceof i,!0)}),QUnit.test("mfExtend() - extending from object",function(e){var n,i=new function(){this.protoMethod=function(){return!0}};function s(){}t(s,i),n=new s,e.strictEqual(n.protoMethod(),!0)}),QUnit.test("mfExtend() - extending from constructor with overrides",function(e){var n;function i(){}t(i,function(){this.protoMethod=function(){return!0}},{protoMethod:function(){return!1}}),n=new i,e.strictEqual(n.protoMethod(),!1)})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/moduleLoader.test.js":function(e,t,n){(function(e){var t,i,s=n("./tests/node-qunit/utils/oo.js"),a=n("sinon");QUnit.module("MobileFrontend ModuleLoader",{beforeEach:function(){i=a.sandbox.create(),s.setUp(i,e),t=n("./src/mobile.startup/moduleLoader.js"),this.loader=new t},afterEach:function(){i.restore()}}),QUnit.test("#require",function(e){this.loader.define("foo",1),this.loader.define("bar",5),e.strictEqual(this.loader.require("foo"),1,"Returns appropriate module"),e.strictEqual(this.loader.require("bar"),5,"Returns appropriate module"),e.throws(function(){this.loader.require("undefinedmodule")},"Cannot require an undefined module."),e.throws(function(){this.loader.require("mobile.modules/Foo")},"Cannot require an undefined export on a known module.")}),QUnit.test("#define",function(e){var t=this.loader;t.define("foo",1),t.define("bar",5),e.throws(function(){t.define("bar",50)},"Cannot define two modules with the same name"),e.strictEqual(this.loader.require("bar"),5,"Returns first definition of module.")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/promisedView.test.js":function(e,t,n){(function(e){var t,i,s,a,o=n("./src/mobile.startup/util.js"),r=n("./tests/node-qunit/utils/jQuery.js"),l=n("./tests/node-qunit/utils/dom.js"),c=n("./tests/node-qunit/utils/oo.js"),u=n("./tests/node-qunit/utils/mw.js"),d=n("sinon");QUnit.module("MobileFrontend promisedView.js",{beforeEach:function(){s=d.sandbox.create(),l.setUp(s,e),r.setUp(s,e),c.setUp(s,e),u.setUp(s,e),i=n("./src/mobile.startup/View.js"),t=n("./src/mobile.startup/promisedView.js"),(a=new i({isBorderBox:!1,className:"test"})).append("😃"),s.stub(mw,"msg").withArgs("mobile-frontend-loading-message").returns("⌛")},afterEach:function(){r.tearDown(),s.restore()}}),QUnit.test("#constructor",function(e){var n=o.Deferred(),i=t(n);return e.strictEqual(i.$el.text(),"⌛","the view is waiting to resolve"),e.ok(i.$el.hasClass("promised-view"),"parent element has loading class when loading"),n.resolve(a),n.then(function(){e.strictEqual(i.$el.attr("class"),"test","fully replaces its parent element with happyView's parent element"),e.strictEqual(i.$el.text(),"😃","the view resolved correctly")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/references/ReferencesDrawer.test.js":function(e,t,n){(function(e){var t,i,s,a,o,r,l=n("sinon"),c=n("./tests/node-qunit/utils/oo.js"),u=n("./tests/node-qunit/utils/dom.js"),d=n("./tests/node-qunit/utils/jQuery.js"),h=n("./tests/node-qunit/utils/mw.js"),p=n("./src/mobile.startup/util.js"),g=n("./src/mobile.startup/references/ReferencesGateway.js");QUnit.module("MobileFrontend: ReferencesDrawer",{beforeEach:function(){t=l.sandbox.create(),u.setUp(t,e),d.setUp(t,e),c.setUp(t,e),h.setUp(t,e),r=n("./src/mobile.startup/Page.js"),o=n("./src/mobile.startup/references/ReferencesDrawer.js"),s={getReference:function(){}},i=new r({title:"reference test"}),a=new o({page:i,gateway:s})},afterEach:function(){d.tearDown(),t.restore()}}),QUnit.test("Bad reference not shown",function(e){var n=p.Deferred().reject(g.ERROR_NOT_EXIST).promise(),o=t.spy(a,"hide");return t.stub(s,"getReference").returns(n),a.showReference("#cite_note-bad",i,"1"),n.catch(function(){e.strictEqual(o.callCount,1,"Hide is called.")})}),QUnit.test("Good reference causes render",function(e){var n=p.Deferred().resolve({text:"I am a reference"}).promise(),o=t.spy(a,"render"),r=t.spy(a,"show"),l=e.async();return t.stub(s,"getReference").returns(n),a.showReference("#cite_note-good",i,"1"),n.then(function(){e.strictEqual(r.callCount,1,"Show is called."),e.strictEqual(o.callCount,1,"Render is called."),l()})}),QUnit.test("Reference failure renders error in drawer",function(e){var n=p.Deferred().reject(g.ERROR_OTHER).promise(),o=t.spy(a,"render"),r=t.spy(a,"show"),l=e.async();return t.stub(s,"getReference").returns(n),a.showReference("#cite_note-bad",i,"1"),n.catch(function(){e.strictEqual(r.callCount,1,"Show is called."),e.strictEqual(o.callCount,1,"Render is called."),e.ok(o.calledWith({error:!0,title:"1",text:mw.msg("mobile-frontend-references-citation-error")}),"Render is called with the error parameter."),l()})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/references/ReferencesHtmlScraperGateway.test.js":function(e,t,n){(function(e){var t,i,s,a,o,r=n("sinon"),l=n("./src/mobile.startup/references/ReferencesGateway.js"),c=n("./tests/node-qunit/utils/PageInputs.html.js").referencesPage,u=n("./src/mobile.startup/util.js"),d=n("./tests/node-qunit/utils/oo.js"),h=n("./tests/node-qunit/utils/dom.js"),p=n("./tests/node-qunit/utils/jQuery.js"),g=n("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend ReferencesHtmlScraperGateway.test.js",{beforeEach:function(){s=r.sandbox.create(),h.setUp(s,e),p.setUp(s,e),d.setUp(s,e),g.setUp(s,e),a=n("./src/mobile.startup/Page.js"),o=n("./src/mobile.startup/references/ReferencesHtmlScraperGateway.js"),t=new a({el:u.parseHTML("<div>").html(c),title:"Reftest"}),i=new o(new mw.Api)},afterEach:function(){p.tearDown(),s.restore()}}),QUnit.test("getReference() checking good reference",function(e){return i.getReference("#cite_note-1",t).then(function(t){e.strictEqual(u.parseHTML("<div>").html(t.text).find(".reference-text").text(),"hello")})}),QUnit.test("getReference() checking bad reference",function(e){return i.getReference("#cite_note-bad",t).catch(function(t){e.strictEqual(t,l.ERROR_NOT_EXIST,"When bad id given false returned.")})}),QUnit.test("getReference() checking encoded reference",function(e){return i.getReference("#cite_note-Obama_1995,_2004,_pp._9%E2%80%9310-11",t).then(function(t){e.strictEqual(u.parseHTML("<div>").html(t.text).find(".reference-text").text(),"found","If an encoded ID parameter is given it still resolves correctly.")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/references/ReferencesMobileViewGateway.test.js":function(e,t,n){(function(e){var t,i,s,a,o,r,l,c,u=n("sinon"),d=n("./src/mobile.startup/references/ReferencesGateway.js"),h=n("./src/mobile.startup/util.js"),p=n("./tests/node-qunit/utils/mw.js"),g=n("./tests/node-qunit/utils/oo.js"),m=n("./tests/node-qunit/utils/jQuery.js"),f=n("./tests/node-qunit/utils/dom.js"),w=n("./tests/node-qunit/utils/PageInputs.html.js").lazyLoadedReferencesPage,b=n("./src/mobile.startup/cache.js").MemoryCache;QUnit.module("MobileFrontend ReferencesMobileViewGateway.test.js",{beforeEach:function(){r=u.sandbox.create(),f.setUp(r,e),m.setUp(r,e),g.setUp(r,e),p.setUp(r,e),l=n("./src/mobile.startup/references/ReferencesMobileViewGateway.js"),c=n("./src/mobile.startup/Page.js"),s=new c({el:h.parseHTML(w),title:"Reftest"}),a=new mw.Api,r.stub(a,"get").returns(h.Deferred().resolve({mobileview:{sections:[]}})),o=new l(new mw.Api),r.stub(o,"getReferencesLists").returns(h.Deferred().resolve({1:'<ol class="references"><li id="cite_note-1">real lazy</li><li id="cite_note-2">real lazy 2</li></ol>'}).promise()),i=new l(new mw.Api),r.stub(i,"getReferencesLists").returns(h.Deferred().resolve({}).promise()),t=new l(new mw.Api),r.stub(t,"getReferencesLists").returns(h.Deferred().reject(d.ERROR_OTHER).promise())},afterEach:function(){m.tearDown(),r.restore()}}),QUnit.test("getReferencesLists() Gateway only hits api once despite multiple calls",function(e){var t=new l(a,new b);return t.getReferencesLists(s).then(function(){t.getReferencesLists(s),t.getReferencesLists(s),e.strictEqual(a.get.calledOnce,!0,"The API should only ever be hit once.")})}),QUnit.test("getReference() checking good reference",function(e){return o.getReference("#cite_note-1",s).then(function(t){e.strictEqual(t.text,"real lazy")})}),QUnit.test("getReference() checking good reference (subsequent calls)",function(e){return o.getReference("#cite_note-1",s).then(function(){return o.getReference("#cite_note-2",s).then(function(t){e.strictEqual(t.text,"real lazy 2")})})}),QUnit.test("getReference() checking bad reference",function(e){return o.getReference("#cite_note-bad",s).catch(function(t){e.strictEqual(t,d.ERROR_NOT_EXIST,"When reference not found error message reflects that.")})}),QUnit.test("getReference() checking reference on non-existent page",function(e){return i.getReference("#cite_note-bad",s).catch(function(t){e.strictEqual(t,d.ERROR_NOT_EXIST,"When getReferencesElement returns empty list of elements reference is false.")})}),QUnit.test("getReference() checking reference when gateway rejects",function(e){return t.getReference("#cite_note-bad-2",s).catch(function(t){e.strictEqual(t,d.ERROR_OTHER,"getReference is rejected if API query fails")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/rlModuleLoader.test.js":function(e,t,n){(function(e){var t,i,s=n("sinon"),a=n("./tests/node-qunit/utils/dom.js"),o=n("./tests/node-qunit/utils/jQuery.js"),r=n("./tests/node-qunit/utils/oo.js"),l=n("./tests/node-qunit/utils/mw.js"),c=n("./src/mobile.startup/util.js");function u(e,n,s,a){var o,r=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),o=t.loadModule(n,s,a),e.strictEqual(this.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(this.stub.show.getCall(0).args.length,0,"LoadingOverlay show() called with no args"),e.strictEqual(this.stub.hide.callCount,0,"LoadingOverlay hide not called"),this.deferred.resolve(),o.then(function(t){e.strictEqual(t,r.stub,"Promise resolves to overlay instance"),e.strictEqual(r.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(r.stub.hide.callCount,1,"LoadingOverlay hide() called once"),e.strictEqual(r.stub.hide.getCall(0).args.length,0,"LoadingOverlay hide() called with no args")})}QUnit.module("MobileFrontend rlModuleLoader.js",{beforeEach:function(){i=s.sandbox.create(),a.setUp(i,e),o.setUp(i,e),r.setUp(i,e),l.setUp(i,e),t=n("./src/mobile.startup/rlModuleLoader.js"),i.stub(e.window,"scrollTo"),this.stub={appendTo:i.spy(),show:i.spy(),hide:i.spy()},this.deferred=c.Deferred(),i.stub(mw.loader,"using").withArgs("mobile.mediaViewer").returns(this.deferred)},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("#newLoadingOverlay does not blow up",function(e){e.expect(0),t.newLoadingOverlay()}),QUnit.test("#loadModule when instructed to show/hide overlay and successful",function(e){return u.apply(this,[e,"mobile.mediaViewer",!1,!0])}),QUnit.test("#loadModule when instructed to show/hide overlay (default args) and successful",function(e){return u.apply(this,[e,"mobile.mediaViewer",!1])}),QUnit.test("#loadModule when instructed to show/hide overlay and not successful",function(e){var n,s=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),n=t.loadModule("mobile.mediaViewer",!1,!0),this.deferred.reject(),e.rejects(n,"returned promise rejects"),n.catch(function(){e.strictEqual(s.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(s.stub.appendTo.callCount,1,"LoadingOverlay appendTo() called once"),e.strictEqual(s.stub.hide.callCount,1,"LoadingOverlay hide() called once"),e.strictEqual(s.stub.hide.getCall(0).args.length,0,"LoadingOverlay hide() called with no args")})}),QUnit.test("#loadModule when instructed to show/not hide overlay and successful",function(e){var n,s=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),n=t.loadModule("mobile.mediaViewer",!0,!0),e.strictEqual(this.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(this.stub.show.getCall(0).args.length,0,"LoadingOverlay show() called with no args"),e.strictEqual(this.stub.hide.callCount,0,"LoadingOverlay hide() not called"),this.deferred.resolve(),n.then(function(t){e.strictEqual(t,s.stub,"Promise resolves to overlay instance"),e.strictEqual(s.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(s.stub.hide.callCount,0,"LoadingOverlay hide() not called")})}),QUnit.test("#loadModule when instructed to show/not hide overlay and not successful",function(e){var n,s=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),n=t.loadModule("mobile.mediaViewer",!0,!0),this.deferred.reject(),e.rejects(n,"returned promise rejects"),n.catch(function(){e.strictEqual(s.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(s.stub.hide.callCount,0,"LoadingOverlay hide() not called")})}),QUnit.test("#loadModule when instructed to not show overlay and successful",function(e){var n,s=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),n=t.loadModule("mobile.mediaViewer",!1,!1),e.strictEqual(this.stub.show.callCount,0,"LoadingOverlay show() not called"),e.strictEqual(this.stub.hide.callCount,0,"LoadingOverlay hide() not called"),this.deferred.resolve(),n.then(function(t){e.strictEqual(t,s.stub,"Promise resolves to overlay instance"),e.strictEqual(s.stub.show.callCount,0,"LoadingOverlay show() not called"),e.strictEqual(s.stub.hide.callCount,0,"LoadingOverlay hide() not called")})}),QUnit.test("#loadModule when instructed to not show overlay and not successful",function(e){var n,s=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),n=t.loadModule("mobile.mediaViewer",!1,!1),this.deferred.reject(),e.rejects(n,"returned promise rejects"),n.catch(function(){e.strictEqual(s.stub.show.callCount,0,"LoadingOverlay show() not called"),e.strictEqual(s.stub.hide.callCount,0,"LoadingOverlay hide() not called")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/search/MobileWebSearchLogger.test.js":function(e,t,n){(function(e){var t,i=n("sinon"),s=n("./tests/node-qunit/utils/mw.js"),a=n("./src/mobile.startup/search/MobileWebSearchLogger.js");QUnit.module("MobileFrontend: MobileWebSearchLogger",{beforeEach:function(){t=i.sandbox.create(),s.setUp(t,e),this.logger=new a,this.spy=t.stub(mw,"track")},afterEach:function(){t.restore()}}),QUnit.test("it should log when the search is shown",function(e){this.logger.onSearchShow(),this.logger.onSearchStart(),e.ok(this.spy.calledWith("mf.schemaMobileWebSearch",{action:"session-start",userSessionToken:this.logger.userSessionToken,searchSessionToken:this.logger.searchSessionToken,timeOffsetSinceStart:0}),"Search start is logged correctly.")}),QUnit.test("it should log when the search API request completes",function(e){var t;this.logger.onSearchShow(),this.logger.onSearchStart(),this.logger.onSearchResults({results:["result1","result2"]}),t=mw.track.getCall(1).args[1],e.strictEqual(t.action,"impression-results"),e.strictEqual(t.resultSetType,"prefix"),e.strictEqual(t.numberOfResults,2),e.strictEqual(t.userSessionToken,this.logger.userSessionToken),e.strictEqual(t.searchSessionToken,this.logger.searchSessionToken)}),QUnit.test("it should refresh the user session token when the search is shown again",function(e){this.logger.onSearchShow(),this.logger.onSearchStart(),this.logger.onSearchShow(),this.logger.onSearchStart(),e.notStrictEqual(mw.track.getCall(0).args[1].userSessionToken,mw.track.getCall(1).args[1].userSessionToken)}),QUnit.test("it should log when the user clicks a result",function(e){var t;this.logger.onSearchShow(),this.logger.onSearchStart(),this.logger.onSearchResults({results:[]}),this.logger.onSearchResultClick({resultIndex:0}),t=mw.track.getCall(2).args[1],e.strictEqual(t.action,"click-result"),e.strictEqual(t.clickIndex,1)}),QUnit.test("it should refresh the search session token when the search API request completes again",function(e){var t={results:[]};this.logger.onSearchShow(),this.logger.onSearchStart(),this.logger.onSearchResults(t),this.logger.onSearchStart(),this.logger.onSearchResults(t),e.notStrictEqual(mw.track.getCall(1).args[1].searchSessionToken,mw.track.getCall(3).args[1].searchSessionToken)})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/search/SearchGateway.test.js":function(e,t,n){(function(e){var t,i,s=n("./tests/node-qunit/utils/jQuery.js"),a=n("./tests/node-qunit/utils/dom.js"),o=n("./tests/node-qunit/utils/mw.js"),r=n("./tests/node-qunit/utils/oo.js"),l=n("sinon"),c=n("./src/mobile.startup/util.js");QUnit.module("MobileFrontend: SearchGateway",{beforeEach:function(){i=l.sandbox.create(),a.setUp(i,e),s.setUp(i,e),r.setUp(i,e),o.setUp(i,e),t=n("./src/mobile.startup/search/SearchGateway.js"),i.stub(mw.util,"getUrl").returns("Title"),i.stub(mw.config,"get",function(e){switch(e){case"wgMFDisplayWikibaseDescriptions":return{search:""};case"wgMFSearchGenerator":return{prefix:""}}}),this.gateway=new t(new mw.Api),i.stub(this.gateway.api,"get",function(){return c.Deferred().resolve({warnings:{query:{"*":'Formatting of continuation data will be changing soon. To continue using the current formatting, use the "rawcontinue" parameter. To begin using the new format, pass an empty string for "continue" in the initial query.'}},query:{pages:{2:{index:1,pageid:2,ns:0,title:"Claude Monet",thumbnail:{source:"http://127.0.0.1:8080/images/thumb/5/54/Claude_Monet%2C_Impression%2C_soleil_levant.jpg/80px-Claude_Monet%2C_Impression%2C_soleil_levant.jpg",width:80,height:62}},60:{index:2,pageid:60,ns:0,title:"Barack Obama",thumbnail:{source:"http://127.0.0.1:8080/images/thumb/8/8d/President_Barack_Obama.jpg/64px-President_Barack_Obama.jpg",width:64,height:80}}}}})})},afterEach:function(){t=void 0,s.tearDown(),i.restore()}},function(){QUnit.test("._highlightSearchTerm",function(e){var t=this.gateway;[["Hello World","Hel","<strong>Hel</strong>lo World"],["Hello kitty","el","Hello kitty"],["Hello worl","hel","<strong>Hel</strong>lo worl"],["Belle & Sebastian","Belle & S","<strong>Belle &amp; S</strong>ebastian"],["Belle & the Beast","Belle &amp;","Belle &amp; the Beast"],["with ? in it","with ?","<strong>with ?</strong> in it"],["Title with ? in it","with ?","Title with ? in it"],["AT&T","a","<strong>A</strong>T&amp;T"],["AT&T","at&","<strong>AT&amp;</strong>T"],["<tag","&lt;tag","&lt;tag"],["& this is a weird title","&","<strong>&amp;</strong> this is a weird title"],["& this is a weird title","&a","&amp; this is a weird title"],["&lt;t","<t","&amp;lt;t"],['<script>alert("FAIL")<\/script> should be safe','<script>alert("FAIL"','<strong>&lt;script&gt;alert("FAIL"</strong>)&lt;/script&gt; should be safe']].forEach(function(n,i){e.strictEqual(t._highlightSearchTerm(n[0],n[1]),n[2],"highlightSearchTerm test "+i)})}),QUnit.test("show redirect targets",function(e){return this.gateway.search("barack").then(function(t){e.strictEqual(t.query,"barack"),e.strictEqual(t.results.length,2),e.strictEqual(t.results[0].displayTitle,"Claude Monet"),e.strictEqual(t.results[0].thumbnail.width,80),e.strictEqual(t.results[1].displayTitle,"<strong>Barack</strong> Obama"),e.strictEqual(t.results[1].title,"Barack Obama")})}),QUnit.module("MobileFrontend SearchGateway (Wikidata Descriptions)",{beforeEach:function(){i.stub(mw.Api.prototype,"get").returns(c.Deferred().resolve({query:{pages:{2:{pageid:2,ns:0,title:"Brad Pitt",index:2,description:"American actor"},4:{pageid:4,ns:0,title:"Bradley Cooper",index:3,description:"American actor and film producer"},5:{pageid:5,ns:0,title:"Braddy",index:1}}}}))}}),QUnit.test("Wikidata Description in search results",function(e){return new t(new mw.Api).search("brad").then(function(t){var n=t.results;e.strictEqual(n[0].wikidataDescription,void 0,"Braddy does not have a Wikidata description."),e.strictEqual(n[1].wikidataDescription,"American actor","Yes, Brad Pitt is an actor."),e.strictEqual(n[2].wikidataDescription,"American actor and film producer","Yes, Cooper is an actor.")})})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/talk/overlay.test.js":function(e,t,n){(function(e){var t,i,s,a,o=n("./tests/node-qunit/utils/jQuery.js"),r=n("./src/mobile.startup/util.js"),l=n("./tests/node-qunit/utils/dom.js"),c=n("./tests/node-qunit/utils/mw.js"),u=n("./tests/node-qunit/utils/oo.js"),d=n("sinon");QUnit.module("MobileFrontend mobile.talk.overlays/talkOverlay",{beforeEach:function(){i=d.sandbox.create(),l.setUp(i,e),o.setUp(i,e),u.setUp(i,e),c.setUp(i,e),i.stub(mw,"msg").returns("msg-key"),t=n("./src/mobile.startup/talk/overlay.js"),s=n("./src/mobile.startup/Overlay.js"),a=n("./src/mobile.startup/PageGateway.js")},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("talkOverlay add discussion button",function(e){var n,o=new a({api:{}}),l=r.Deferred().resolve([]),c=i.stub(s,"make");return i.stub(o,"getSections").returns(l),i.stub(mw.loader,"using").returns(l),n=i.stub(mw.user,"isAnon").returns(!0),t("Foo",o),n.restore(),i.stub(mw.user,"isAnon").returns(!1),t("overlay logged in",o),e.propEqual(c.args[1][0].headerButtons[0].href,"#/talk/new","logged in users have the add discussion button"),e.propEqual(c.args[0][0].headerButtons[0],{},"anons do not have the add discussion button"),l})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/time.test.js":function(e,t,n){var i=n("./src/mobile.startup/time.js");QUnit.module("MobileFrontend time.js"),QUnit.test("timeAgo()",function(e){e.propEqual(i.timeAgo(40),{value:40,unit:"seconds"}),e.propEqual(i.timeAgo(149),{value:2,unit:"minutes"}),e.propEqual(i.timeAgo(150),{value:3,unit:"minutes"}),e.propEqual(i.timeAgo(7500),{value:2,unit:"hours"}),e.propEqual(i.timeAgo(9e4),{value:1,unit:"days"}),e.propEqual(i.timeAgo(9e6),{value:3,unit:"months"}),e.propEqual(i.timeAgo(32e6),{value:1,unit:"years"}),e.propEqual(i.timeAgo(102e6),{value:3,unit:"years"})})},"./tests/node-qunit/mobile.startup/util.test.js":function(e,t,n){(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,s,a=n("./tests/node-qunit/utils/dom.js"),o=n("./tests/node-qunit/utils/mw.js"),r=n("./tests/node-qunit/utils/jQuery.js"),l=n("./tests/node-qunit/utils/oo.js"),c=n("sinon");QUnit.module("MobileFrontend util.js",{beforeEach:function(){s=c.sandbox.create(),a.setUp(s,e),o.setUp(s,e),r.setUp(s,e),l.setUp(s,e),i=n("./src/mobile.startup/util.js")},afterEach:function(){r.tearDown(),s.restore()}}),QUnit.test("Promise.all() success",function(e){var t=i.Deferred(),n=i.Deferred();return t.resolve("a"),n.resolve("b"),i.Promise.all([t,n]).then(function(t,n){e.strictEqual(t,"a","All promises resolved (yay)"),e.strictEqual(n,"b","All promises resolved (yay)")})}),QUnit.test("Promise.all() reject",function(e){var t=i.Deferred(),n=i.Deferred();return t.resolve("a"),n.reject("b"),i.Promise.all([t,n]).catch(function(t){e.strictEqual(t,"b","The promise rejects")})}),QUnit.test("escapeSelector()",function(e){e.strictEqual(i.escapeSelector("#selector-starts-with-hash"),"\\#selector-starts-with-hash")}),QUnit.test("grep()",function(e){e.propEqual(i.grep([1,2],function(e){return e>1}),[2])}),QUnit.test("docReady()",function(e){var t=i.docReady();e.strictEqual(t instanceof $,!0)}),QUnit.test("Deferred() - resolve",function(e){var t=new i.Deferred;return t.resolve("response"),t.then(function(t){e.strictEqual(t,"response")})}),QUnit.test("Deferred() - reject",function(e){var t=new i.Deferred;return t.reject("response"),t.catch(function(t){e.strictEqual(t,"response")})}),QUnit.test("getDocument()",function(e){e.strictEqual(i.getDocument().length,1)}),QUnit.test("getWindow()",function(e){e.strictEqual(i.getWindow().length,1)}),QUnit.test("parseHTML()",function(e){var n=i.parseHTML("<p>element content</p>",document);e.strictEqual("object"===t(n),!0),e.strictEqual(n[0].innerHTML,"element content")}),QUnit.test("isNumeric()",function(e){e.strictEqual(i.isNumeric(123),!0),e.strictEqual(i.isNumeric("123"),!0),e.strictEqual(i.isNumeric("The string 123 is true? I don't like it."),!1),e.strictEqual(i.isNumeric(NaN),!1)}),QUnit.test("extend()",function(e){var t={a:"apple"};i.extend(t,{b:"banana"}),e.strictEqual(JSON.stringify(t),'{"a":"apple","b":"banana"}')}),QUnit.test("escapeHash()",function(e){e.strictEqual(i.escapeHash("#escape:...hash"),"#escape\\:\\.\\.\\.hash")}),QUnit.test("isModifiedEvent() - true",function(e){var t=document.createElement("div");t.addEventListener("click",function(t){e.strictEqual(i.isModifiedEvent(t),!0)}),t.dispatchEvent(new window.MouseEvent("click",{ctrlKey:!0}))}),QUnit.test("isModifiedEvent() - false",function(e){var t=document.createElement("div");t.addEventListener("click",function(t){e.strictEqual(i.isModifiedEvent(t),!1)}),t.dispatchEvent(new window.MouseEvent("click"))}),QUnit.test("repeatEvent",function(e){var t=new OO.EventEmitter,n=new OO.EventEmitter;i.repeatEvent(n,t,"test"),t.on("test",function(t){e.strictEqual(t,"test data","proxy responds to source events correctly")}),n.emit("test","test data")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/watchstar/Watchstar.test.js":function(e,t,n){(function(e){var t,i,s,a,o,r,l,c,u,d=n("./tests/node-qunit/utils/dom.js"),h=n("./tests/node-qunit/utils/jQuery.js"),p=n("sinon"),g=n("./tests/node-qunit/utils/mw.js"),m=n("./tests/node-qunit/utils/oo.js"),f=n("./src/mobile.startup/util.js");QUnit.module("MobileFrontend Watchstar.js",{beforeEach:function(){u=p.sandbox.create(),d.setUp(u,e),h.setUp(u,e),g.setUp(u,e),m.setUp(u,e),t=n("./src/mobile.startup/watchstar/Watchstar.js"),i=n("./src/mobile.startup/CtaDrawer.js"),a=n("./src/mobile.startup/Icon.js"),r=mw.user,l=n("./src/mobile.startup/Page.js"),o=new a({name:"watched"}),s=n("./src/mobile.startup/toast.js"),u.stub(mw,"notify",function(){}),c=u.spy(s,"show")},afterEach:function(){h.tearDown(),u.restore()}}),QUnit.test("Anonymous user opens drawer",function(e){var n,s;u.stub(r,"isAnon").returns(!0),n=u.stub(i.prototype,"show"),s=$("<div>"),new t({api:new mw.Api,el:s,page:new l({title:"Title"})}),s.trigger("click"),e.ok(n.called,"We checked if the drawer was visible before displaying it")}),QUnit.test("Logged in user watches article",function(e){var n,i,s,a;return u.stub(r,"isAnon",function(){return!1}),n=new t({api:new mw.Api,isWatched:!1,page:new l({title:"Title"})}),i=n.$el,s=f.Deferred().resolve(),a=u.stub(n.gateway.api,"postWithToken").returns(s),i.trigger("click"),s.then(function(){e.ok(a.calledWith("watch",{action:"watch",titles:["Title"]}),"The watch happened"),e.strictEqual(i.hasClass(o.getGlyphClassName()),!0,"After successful watch has watched class"),e.strictEqual(c.callCount,1,"A toast is shown")})}),QUnit.test("Logged in user unwatches article",function(e){var n,i,s,a;return u.stub(r,"isAnon",function(){return!1}),i=(n=new t({api:new mw.Api,isWatched:!0,page:new l({title:"Title"})})).$el,s=f.Deferred().resolve(),a=u.stub(n.gateway.api,"postWithToken").returns(s),i.trigger("click"),s.then(function(){e.ok(a.calledWith("watch",{action:"watch",unwatch:!0,titles:["Title"]}),"The watch happened"),e.strictEqual(c.callCount,1,"A toast is shown")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/watchstar/WatchstarGateway.test.js":function(e,t,n){(function(e){var t,i=n("./src/mobile.startup/watchstar/WatchstarGateway.js"),s=n("./tests/node-qunit/utils/dom.js"),a=n("./tests/node-qunit/utils/jQuery.js"),o=n("sinon"),r=n("./tests/node-qunit/utils/mw.js"),l=n("./src/mobile.startup/util.js"),c={batchcomplete:!0,query:{pages:[{pageid:123,ns:0,title:"An unwatched page",contentmodel:"wikitext",pagelanguage:"en",pagelanguagehtmlcode:"en",pagelanguagedir:"ltr",touched:"2018-05-01T01:39:12Z",lastrevid:10,length:3,new:!0,watched:!1},{pageid:456,ns:0,title:"A watched page",contentmodel:"wikitext",pagelanguage:"en",pagelanguagehtmlcode:"en",pagelanguagedir:"ltr",touched:"2018-05-01T01:43:31Z",lastrevid:24,length:3,new:!0,watched:!0}]}};QUnit.module("MobileFrontend: WatchstarGateway.js",{beforeEach:function(){t=o.sandbox.create(),s.setUp(t,e),a.setUp(t,e),r.setUp(t,e)},afterEach:function(){a.tearDown(),t.restore()}}),QUnit.test("getStatuses(nonempty)",function(e){var n,s,a;return s={get:function(){}},(a=t.mock(s)).expects("get").withArgs(t.match.has("pageids")).once().returns(l.Deferred().resolve({batchcomplete:!0,query:{pages:[c.query.pages[0]]}})),a.expects("get").withArgs(t.match.has("titles")).once().returns(l.Deferred().resolve({batchcomplete:!0,query:{pages:[c.query.pages[1]]}})),new i(s).getStatuses(["123"],["A watched page"]).then(function(t){n={"An unwatched page":!1,"A watched page":!0},e.propEqual(t,n,"The correct result is returned."),a.verify()})}),QUnit.test("getStatuses(empty)",function(e){var n,s,a;return s={get:function(){}},a=t.mock(s).expects("get").never(),new i(s).getStatuses([],[]).then(function(t){n={},e.propEqual(t,n,"An empty result is returned."),a.verify()})}),QUnit.test("getStatusesByID(nonempty)",function(e){var n,s,a;return s={get:function(){}},a=t.mock(s).expects("get").once().returns(l.Deferred().resolve(c)),new i(s).getStatusesByID(["123",456]).then(function(t){n={"An unwatched page":!1,"A watched page":!0},e.propEqual(t,n,"The correct result is returned."),a.verify()})}),QUnit.test("getStatusesByID(empty)",function(e){var n,s,a;return s={get:function(){}},a=t.mock(s).expects("get").never(),new i(s).getStatusesByID([]).then(function(t){n={},e.propEqual(t,n,"An empty result is returned."),a.verify()})}),QUnit.test("getStatusesByTitle(nonempty)",function(e){var n,s,a;return s={get:function(){}},a=t.mock(s).expects("get").once().returns(l.Deferred().resolve(c)),new i(s).getStatusesByTitle(["An unwatched page","An unwatched page"]).then(function(t){n={"An unwatched page":!1,"A watched page":!0},e.propEqual(t,n,"The correct result is returned."),a.verify()})}),QUnit.test("getStatusesByTitle(empty)",function(e){var n,s,a;return s={get:function(){}},a=t.mock(s).expects("get").never(),new i(s).getStatusesByTitle([]).then(function(t){n={},e.propEqual(t,n,"An empty result is returned."),a.verify()})}),QUnit.test("_unmarshalGetResponse(nonempty)",function(e){var t,n;t=new i(new mw.Api)._unmarshalGetResponse(c),n={"An unwatched page":!1,"A watched page":!0},e.propEqual(t,n,"GET API:Info nonempty responses are unmarshalled correctly.")}),QUnit.test("_unmarshalGetResponse(empty)",function(e){var t,n;t=new i(new mw.Api)._unmarshalGetResponse({}),n={},e.propEqual(t,n,"GET API:Info empty responses are unmarshalled correctly.")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/watchstar/WatchstarPageList.test.js":function(e,t,n){(function(e){var t,i,s,a,o,r=n("./src/mobile.startup/util.js"),l=n("./tests/node-qunit/utils/dom.js"),c=n("./tests/node-qunit/utils/jQuery.js"),u=n("sinon"),d=n("./tests/node-qunit/utils/mw.js"),h=n("./tests/node-qunit/utils/oo.js"),p={query:{pages:[{pageid:30,title:"Title 30",watched:!0},{pageid:50,title:"Title 50",watched:!1}]}};QUnit.module("MobileFrontend mobile.startup/WatchstarPageList",{beforeEach:function(){o=u.sandbox.create(),l.setUp(o,e),c.setUp(o,e),d.setUp(o,e),h.setUp(o,e),s=n("./src/mobile.startup/watchstar/WatchstarPageList.js"),t=mw.user,i=n("./src/mobile.startup/Icon.js"),a=new i({name:"watched"}).getGlyphClassName(),o.stub(t,"isAnon").returns(!1)},afterEach:function(){c.tearDown(),o.restore()}}),QUnit.test("Watchlist status check if no ids",function(e){var t=e.async(),n=new mw.Api,i=o.stub(n,"get").returns(r.Deferred().resolve(p)),a=new s({api:n,pages:[{title:"Title 0"},{title:"Title 1"}]});window.setTimeout(function(){a.getPages([],[]).then(function(){e.ok(i.calledWith({formatversion:2,action:"query",prop:"info",inprop:"watched",titles:["Title 0","Title 1"]}),"A request to API was made to retrieve the statuses"),e.strictEqual(a.$el.find(".watch-this-article").length,2,"2 articles have watch stars"),t()})},0)}),QUnit.test("Checks watchlist status once",function(e){var t=e.async(),n=new mw.Api,i=o.stub(n,"get").returns(r.Deferred().resolve(p)),l=new s({api:n,pages:[{id:30,title:"Title 30"},{id:50,title:"Title 50"}]});window.setTimeout(function(){l.getPages([30,50],[]).then(function(){e.strictEqual(i.callCount,2,"run callback twice (inside postRender and this call) - no caching occurs"),e.ok(i.calledWith({formatversion:2,action:"query",prop:"info",inprop:"watched",pageids:[30,50]}),"A request to API was made to retrieve the statuses"),e.strictEqual(l.$el.find(".watch-this-article").length,2,"2 articles have watch stars"),e.strictEqual(l.$el.find("."+a).length,1,"1 article is marked as watched"),t()})},0)})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.talk.overlays/TalkSectionAddOverlay.test.js":function(e,t,n){(function(e){var t,i,s=n("./src/mobile.startup/util.js"),a=n("./tests/node-qunit/utils/jQuery.js"),o=n("./tests/node-qunit/utils/dom.js"),r=n("./tests/node-qunit/utils/mw.js"),l=n("./tests/node-qunit/utils/oo.js"),c=n("sinon");QUnit.module("MobileFrontend TalkSectionAddOverlay",{beforeEach:function(){i=c.sandbox.create(),o.setUp(i,e),a.setUp(i,e),l.setUp(i,e),r.setUp(i,e),t=n("./src/mobile.talk.overlays/TalkSectionAddOverlay.js")},afterEach:function(){a.tearDown(),i.restore()}}),QUnit.test("save()",function(e){var n=new t({api:{postWithToken:i.stub().returns(s.Deferred().resolve())},title:"Talk:No exist"});return n.$el.find("input").val("Testtitle"),n.$el.find("textarea").val("Testcontent"),e.strictEqual(n.$el.find("input").val(),"Testtitle","Testtitle set"),e.strictEqual(n.$el.find("textarea").val(),"Testcontent","Testcontent set"),n.save().then(function(t){e.strictEqual(t,"ok","The new discussion was saved"),e.strictEqual(n._saveHit,!0,"The save was recognized")})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.talk.overlays/TalkSectionOverlay.test.js":function(e,t,n){(function(e){var t,i,s=n("./src/mobile.startup/util.js"),a=n("./tests/node-qunit/utils/jQuery.js"),o=n("./tests/node-qunit/utils/dom.js"),r=n("./tests/node-qunit/utils/mw.js"),l=n("./tests/node-qunit/utils/oo.js"),c=n("sinon");QUnit.module("MobileFrontend TalkSectionOverlay.js - logged in",{beforeEach:function(){i=c.sandbox.create(),o.setUp(i,e),a.setUp(i,e),l.setUp(i,e),r.setUp(i,e),t=n("./src/mobile.talk.overlays/TalkSectionOverlay.js"),this.toastStub=i.stub(mw,"notify"),i.stub(mw.user,"isAnon").returns(!1),this.renderFromApiSpy=i.stub(t.prototype,"renderFromApi")},afterEach:function(){a.tearDown(),i.restore()}}),QUnit.test("Load section from api only, if needed",function(e){new t({api:{},section:"Testtext"}),e.strictEqual(this.renderFromApiSpy.callCount,0,"Section requested from api, if no section given."),new t({api:{}}),e.strictEqual(this.renderFromApiSpy.callCount,1,"No Api request, if section given")}),QUnit.test("Check comment box for logged in users",function(e){var n=new t({api:{},section:"Test"});e.ok(n.$el.find(".comment").length>0,"There is a visible comment box")}),QUnit.test("Check error class on textarea",function(e){var n;(n=new t({api:{},section:"Test"})).onSaveClick(),e.ok(n.$textarea.hasClass("error"),"Error class added when try to submit empty comment box."),n.onFocusTextarea(),e.strictEqual(n.$textarea.hasClass("error"),!1,"Error class removed after comment box get focus.")}),QUnit.test("Check api request on save",function(e){var n=s.Deferred().resolve(),a=i.stub().returns(n),o=new t({api:{postWithToken:a},title:"Talk:Test",id:1,section:"Test"});return o.$textarea.val("Testcomment"),o.onSaveClick(),n.then(function(){e.ok(a.calledWith("csrf",{action:"edit",title:"Talk:Test",section:1,appendtext:"\n\nTestcomment ~~~~",redirect:!0}),"Save request passes!")})}),QUnit.module("MobileFrontend TalkSectionOverlay.js - anonymous (logged out)",{beforeEach:function(){i=c.sandbox.create(),o.setUp(i,e),a.setUp(i,e),l.setUp(i,e),r.setUp(i,e),t=n("./src/mobile.talk.overlays/TalkSectionOverlay.js"),i.stub(mw.user,"isAnon").returns(!1)},afterEach:function(){a.tearDown(),i.restore()}}),QUnit.test("Check comment box for logged out users",function(e){var n=new t({api:{},section:"Test"});e.ok(n.$el.find(".comment").length>0,"There is a visible comment box")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.talk.overlays/autosign.test.js":function(e,t,n){var i=n("./src/mobile.talk.overlays/autosign.js");QUnit.module("MobileFrontend autosign.js"),QUnit.test("#autosign",function(e){[["foo","foo ~~~~"],["foo ~~~","foo ~~~"],["foo ~~~~~","foo ~~~~~"],["foo ~~~~","foo ~~~~"],["foo ~~~~ yolo","foo ~~~~ yolo"],["~~~~ yolo","~~~~ yolo"]].forEach(function(t){e.strictEqual(i(t[0]),t[1],"Autosigning works as expected")})})},"./tests/node-qunit/mobile.talk.overlays/talkBoard.test.js":function(e,t,n){(function(e){var t,i,s,a=n("./tests/node-qunit/utils/jQuery.js"),o=n("./tests/node-qunit/utils/dom.js"),r=n("./tests/node-qunit/utils/mw.js"),l=n("./tests/node-qunit/utils/oo.js"),c=n("sinon");QUnit.module("MobileFrontend mobile.talk.overlays/talkBoard",{beforeEach:function(){s=c.sandbox.create(),o.setUp(s,e),a.setUp(s,e),l.setUp(s,e),r.setUp(s,e),s.stub(mw,"msg").withArgs("mobile-frontend-talk-explained").returns("things").withArgs("mobile-frontend-talk-explained-empty").returns("empty"),t=n("./src/mobile.talk.overlays/talkBoard.js"),i=n("./src/mobile.startup/Section.js")},afterEach:function(){a.tearDown(),s.restore()}}),QUnit.test("no sections",function(e){var n=t([]);e.strictEqual(n.$el.find(".content-header").text().trim(),"empty"),e.strictEqual(n.$el.find("ul").children().length,0,"no topics")}),QUnit.test("sections",function(e){var n=t([new i({line:"1",id:"2"})]);e.strictEqual(n.$el.find(".content-header").text().trim(),"things"),e.strictEqual(n.$el.find("ul").children().length,1,"1 topic")})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/utils/PageGateway.responses.js":function(e,t){e.exports={getPageHeadings:{input:{mobileview:{id:-1,displaytitle:"Test",revId:42,lastmodifiedby:{name:"bob",gender:"unknown"},protection:[],lastmodified:"2013-10-28T18:49:56Z",languagecount:10,sections:[{id:0,text:""},{level:"1",line:"1",anchor:"1",id:1,text:"<p>Text of 1\n</p>"},{level:"2",line:"<i>1.1</i>",anchor:"1.1",id:2,text:"<p>Text of 1.1\n</p>"},{level:"1",line:"2",anchor:"2",id:3,text:"<p>Text of 2\n</p>"},{level:"2",line:"2.1",anchor:"2.1",id:4,text:"<p>Text of 2.1\n</p>"}]}},output:{historyUrl:"Test:History",lastModifiedUserName:"bob",lastModifiedUserGender:"unknown",lastModifiedTimestamp:1382986196,title:"Test",revId:42,displayTitle:"Test",id:-1,protection:{edit:["*"]},isMainPage:!1,languageCount:10,hasVariants:!1,lead:"",sections:[{level:"1",line:"1",anchor:"1",id:1,text:'<p>Text of 1\n</p><h2 id="1.1"><i>1.1</i></h2>\n<p>Text of 1.1\n</p>\n',subsections:[{level:"2",line:"<i>1.1</i>",anchor:"1.1",id:2,text:"<p>Text of 1.1\n</p>",subsections:[]}]},{level:"1",line:"2",anchor:"2",id:3,text:'<p>Text of 2\n</p><h2 id="2.1">2.1</h2>\n<p>Text of 2.1\n</p>\n',subsections:[{level:"2",line:"2.1",anchor:"2.1",id:4,text:"<p>Text of 2.1\n</p>",subsections:[]}]}]}},getPage:{input:{mobileview:{id:-1,protection:{edit:["sysop"]},lastmodifiedby:{name:"Melissa",gender:"female"},revId:42,displaytitle:"Test",lastmodified:"2013-10-28T18:49:56Z",languagecount:10,sections:[{id:0,text:"lead content"},{level:"2",line:"Aaa section",anchor:"Aaa_section",id:1,text:"aaa content"},{level:"3",line:"Subaaa section",anchor:"Subaaa_section",id:2,text:"subaaa content"},{level:"2",line:"Bbb section",anchor:"Bbb_section",id:3,text:"bbb content"},{level:"2",line:"References",references:"",anchor:"References",id:4,text:"references"}]}},output:{historyUrl:"Test:History",lastModifiedUserName:"Melissa",lastModifiedUserGender:"female",lastModifiedTimestamp:1382986196,protection:{edit:["sysop"]},title:"Test",displayTitle:"Test",id:-1,isMainPage:!1,revId:42,languageCount:10,hasVariants:!1,lead:"lead content",sections:[{level:"2",line:"Aaa section",anchor:"Aaa_section",id:1,text:'aaa content<h3 id="Subaaa_section">Subaaa section</h3>\nsubaaa content\n',subsections:[{level:"3",line:"Subaaa section",anchor:"Subaaa_section",id:2,text:"subaaa content",subsections:[]}]},{level:"2",line:"Bbb section",anchor:"Bbb_section",id:3,text:"bbb content",subsections:[]},{level:"2",line:"References",references:"",anchor:"References",id:4,text:"references",subsections:[]}]}},getPageLanguagesResponse:{input:{query:{pages:[{pageid:94,ns:0,title:"San Francisco",langlinks:[{lang:"es",url:"http://es.wikipedia.org/wiki/San_Francisco_(California)",title:"San Francisco (California)",autonym:"español"},{lang:"pl",url:"http://pl.wikipedia.org/wiki/San_Francisco",title:"San Francisco",autonym:"polski"},{lang:"sr",url:"http://sr.wikipedia.org/wiki/%D0%A1%D0%B0%D0%BD_%D0%A4%D1%80%D0%B0%D0%BD%D1%86%D0%B8%D1%81%D0%BA%D0%BE",title:"Сан Франциско",autonym:"српски / srpski"}]}],general:{variants:[{code:"sr",name:"sr"},{code:"sr-ec",name:"Ћирилица"},{code:"sr-el",name:"Latinica"}],variantarticlepath:"/$2/$1"},languages:[{code:"sr",name:"српски / srpski"},{code:"sr-ec",name:"српски (ћирилица)"},{code:"sr-el",name:"srpski (latinica)‎"},{code:"es",name:"español"},{code:"pl",name:"polski"}]},limits:{langlinks:500}},output:{languages:[{lang:"es",url:"http://es.wikipedia.org/wiki/San_Francisco_(California)",title:"San Francisco (California)",autonym:"español"},{lang:"pl",url:"http://pl.wikipedia.org/wiki/San_Francisco",title:"San Francisco",autonym:"polski"},{lang:"sr",url:"http://sr.wikipedia.org/wiki/%D0%A1%D0%B0%D0%BD_%D0%A4%D1%80%D0%B0%D0%BD%D1%86%D0%B8%D1%81%D0%BA%D0%BE",title:"Сан Франциско",autonym:"српски / srpski"}],variants:[{lang:"sr",autonym:"sr",url:"/sr/Test"},{lang:"sr-ec",autonym:"Ћирилица",url:"/sr-ec/Test"},{lang:"sr-el",autonym:"Latinica",url:"/sr-el/Test"}]}},getPageLanguagesCall:{output:{action:"query",meta:"siteinfo",siprop:"general",prop:"langlinks",llprop:"url|autonym|langname",llinlanguagecode:"fr",lllimit:"max",titles:"Title",formatversion:2}},getAPIResponseFromHTML:{input:[{line:"A1",level:"1",anchor:"1.0",text:""},{line:"A2.1",level:"2",anchor:"",text:""},{line:"A2.2",level:"2",anchor:"",text:""},{line:"A2",level:"1",anchor:"",text:""},{line:"A2.1",level:"2",anchor:"",text:""}]}}},"./tests/node-qunit/utils/PageInputs.html.js":function(e,t){var n,i,s,a,o;n='<div>\n\t<h1><span class="mw-headline" id="1.0">A1</span></h1>\n\t<h2><span class="mw-headline">A2.1</span></h2>\n\t<h2><span class="mw-headline">A2.2</span></h2>\n\t<h1><span class="mw-headline">A2</span></h1>\n\t<h2><span class="mw-headline">A2.1</span><span>[<a href="#">edit</a>]</span></h2>\n\t<h1>Not to be shown in the TOC<span class="placeholder"></span></h1>\n</div>',i='<div>\n<h2><span class="mw-headline" id="1.0">A1</span></h2>\n<h3><span class="mw-headline">A2.1</span></h3>\n<h2><span class="mw-headline">A2.2</span></h2>\n<h1><span class="mw-headline">A2</span></h1>\n<h2><span class="mw-headline">A2.1</span></h2>\n</div>',s='<div id="mw-content-text">\n\t<h2 class="section-heading collapsible-heading open-block">\n\t\t<span class="mw-headline" id="Notes_and_references">Notes and references</span>\n\t</h2>\n\t<div class="mf-section-2 collapsible-block open-block" data-is-reference-section="1">\n\t\t<p>Text</p>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<h3><span class="mw-headline" id="Notes">Notes</span></h3>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<h4 class="in-block"><span class="mw-headline" id="Refs">Refs</span></h4>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<p>no forget</p>\n\t\t<h5 class="in-block"><span class="mw-headline" id="More_refs">More refs</span></h5>\n\t\t<p>1</p>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<p>2</p>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<p>3</p>\n\t</div>\n</div>',a='<div id="mfe-test-references">\n<sup id="cite_ref-1" class="reference">\n\t<a href="#cite_note-1">[1]</a>\n</sup>\n<p>\n\tsup with encoded href attribute\n\t<sup id="cite_ref-Obama_1995,_2004,_pp._9–10_11-0" class="reference">\n\t\t<a href="#cite_note-Obama_1995,_2004,_pp._9%E2%80%9310-11">[11]</a>\n\t</sup>\n</p>\n<ol class="references">\n\t<li id="cite_note-1">\n\t\t<span class="mw-cite-backlink">\n\t\t\t<a href="#cite_ref-1">↑</a>\n\t\t</span> <span class="reference-text">hello</span>\n\t</li>\n\t<li id="cite_note-Obama_1995,_2004,_pp._9–10-11">\n\t\t<span class="mw-cite-backlink">\n\t\t\t<a href="#cite_ref-1">↑</a>\n\t\t</span> <span class="reference-text">found</span>\n\t</li>\n</ol>\n</div>',o='<div>\n<h2><span class="mw-headline" id="1.0">A1</span></h1>\n<div>text</div>\n<h2>references</h2>\n<div>\n\t<a class="mf-lazy-references-placeholder">View citations</a>\n</div>\n</div>',e.exports={lazyLoadedReferencesPage:o,referencesPage:a,skinPage:s,page:n,page2:i}},"./tests/node-qunit/utils/blank.json":function(e){e.exports={}},"./tests/node-qunit/utils/dom.js":function(e,t,n){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s="object"!==("undefined"==typeof window?"undefined":i(window)),a=s&&n("jsdom");e.exports={setUp:function(e,t){s&&(t.window=t.window||void 0,t.document=t.document||void 0,e.stub(t,"window",(new a.JSDOM).window),e.stub(t,"document",window.document),t.Image=t.window.Image,t.Event=t.window.Event)}}},"./tests/node-qunit/utils/jQuery.js":function(e,t,n){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s="object"!==("undefined"==typeof window?"undefined":i(window));e.exports={setUp:function(e,t){s&&(t.$=t.$||void 0,e.stub(t,"$",n("jquery")))},tearDown:function(){s&&delete n.c.jquery}}},"./tests/node-qunit/utils/mw.js":function(e,t,n){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s="object"!==("undefined"==typeof window?"undefined":i(window)),a=n("./tests/node-qunit/utils/blank.json");e.exports={setUp:function(e,t){s&&(t.mw=t.mw||void 0,e.stub(t,"mw",a()))}}},"./tests/node-qunit/utils/oo.js":function(e,t,n){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s="object"!==("undefined"==typeof window?"undefined":i(window));e.exports={setUp:function(e,t){var i;s&&((i=n("oojs")).ui={Element:{static:{getClosestScrollableContainer:function(){}}},Tool:function(){}},t.OO=t.OO||void 0,e.stub(t,"OO",i))}}},0:function(e,t,n){n("./tests/node-qunit/mobile.categories.overlays/CategoryGateway.test.js"),n("./tests/node-qunit/mobile.editor.overlay/EditorGateway.test.js"),n("./tests/node-qunit/mobile.editor.overlay/EditorOverlay.test.js"),n("./tests/node-qunit/mobile.languages.structured/LanguageSearcher.test.js"),n("./tests/node-qunit/mobile.languages.structured/util.test.js"),n("./tests/node-qunit/mobile.mediaViewer/ImageGateway.test.js"),n("./tests/node-qunit/mobile.mediaViewer/ImageOverlay.test.js"),n("./tests/node-qunit/mobile.special.nearby.scripts/Nearby.test.js"),n("./tests/node-qunit/mobile.special.nearby.scripts/NearbyGateway.test.js"),n("./tests/node-qunit/mobile.special.uploads.scripts/PhotoListGateway.test.js"),n("./tests/node-qunit/mobile.special.watchlist.scripts/WatchList.test.js"),n("./tests/node-qunit/mobile.special.watchlist.scripts/WatchListGateway.test.js"),n("./tests/node-qunit/mobile.startup/Browser.test.js"),n("./tests/node-qunit/mobile.startup/Button.test.js"),n("./tests/node-qunit/mobile.startup/cache.test.js"),n("./tests/node-qunit/mobile.startup/context.test.js"),n("./tests/node-qunit/mobile.startup/CtaDrawer.test.js"),n("./tests/node-qunit/mobile.startup/Drawer.test.js"),n("./tests/node-qunit/mobile.startup/extendSearchParams.test.js"),n("./tests/node-qunit/mobile.startup/icons.test.js"),n("./tests/node-qunit/mobile.startup/languageOverlay/getDeviceLanguage.test.js"),n("./tests/node-qunit/mobile.startup/languageOverlay/languageOverlay.test.js"),n("./tests/node-qunit/mobile.startup/lazyImages/lazyImageLoader.test.js"),n("./tests/node-qunit/mobile.startup/lazyReferencesLoader.test.js"),n("./tests/node-qunit/mobile.startup/mfExtend.test.js"),n("./tests/node-qunit/mobile.startup/moduleLoader.test.js"),n("./tests/node-qunit/mobile.startup/Overlay.test.js"),n("./tests/node-qunit/mobile.startup/OverlayManager.test.js"),n("./tests/node-qunit/mobile.startup/Page.test.js"),n("./tests/node-qunit/mobile.startup/PageGateway.test.js"),n("./tests/node-qunit/mobile.startup/Panel.test.js"),n("./tests/node-qunit/mobile.startup/promisedView.test.js"),n("./tests/node-qunit/mobile.startup/references/ReferencesDrawer.test.js"),n("./tests/node-qunit/mobile.startup/references/ReferencesHtmlScraperGateway.test.js"),n("./tests/node-qunit/mobile.startup/references/ReferencesMobileViewGateway.test.js"),n("./tests/node-qunit/mobile.startup/rlModuleLoader.test.js"),n("./tests/node-qunit/mobile.startup/ScrollEndEventEmitter.test.js"),n("./tests/node-qunit/mobile.startup/search/MobileWebSearchLogger.test.js"),n("./tests/node-qunit/mobile.startup/search/SearchGateway.test.js"),n("./tests/node-qunit/mobile.startup/Section.test.js"),n("./tests/node-qunit/mobile.startup/talk/overlay.test.js"),n("./tests/node-qunit/mobile.startup/time.test.js"),n("./tests/node-qunit/mobile.startup/Toggler.test.js"),n("./tests/node-qunit/mobile.startup/util.test.js"),n("./tests/node-qunit/mobile.startup/View.test.js"),n("./tests/node-qunit/mobile.startup/watchstar/Watchstar.test.js"),n("./tests/node-qunit/mobile.startup/watchstar/WatchstarGateway.test.js"),n("./tests/node-qunit/mobile.startup/watchstar/WatchstarPageList.test.js"),n("./tests/node-qunit/mobile.talk.overlays/autosign.test.js"),n("./tests/node-qunit/mobile.talk.overlays/talkBoard.test.js"),n("./tests/node-qunit/mobile.talk.overlays/TalkSectionAddOverlay.test.js"),e.exports=n("./tests/node-qunit/mobile.talk.overlays/TalkSectionOverlay.test.js")},jquery:function(e,t){!function(){e.exports=this.jquery}()},jsdom:function(e,t){!function(){e.exports=this.jsdom}()},oojs:function(e,t){!function(){e.exports=this.oojs}()},sinon:function(e,t){!function(){e.exports=this.sinon}()}},[[0,0]]]);
//# sourceMappingURL=tests.mobilefrontend.js.map.json